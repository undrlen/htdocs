<?php
 class RSSFeed implements iRSSFeed {private $url,   $xml,   $items;public function __construct($v572d4e421e5e6b9bc11d815e8a027112) {$this->url = $v572d4e421e5e6b9bc11d815e8a027112;}public function loadContent($vdbd153490a1c3720a970a611afc4371c = false) {$v568d8e07bbe5575518d5005e559743c3 = umiRemoteFileGetter::get($this->url, false, false, false, true);$v2d58007eca07c72d45b5b6732976dff1 = explode("\r\n\r\n", $v568d8e07bbe5575518d5005e559743c3);$v4340fd73e75df7a9d9e45902a59ba3a4 = $v2d58007eca07c72d45b5b6732976dff1[0];unset($v2d58007eca07c72d45b5b6732976dff1[0]);$v568d8e07bbe5575518d5005e559743c3 = implode("\r\n\r\n", $v2d58007eca07c72d45b5b6732976dff1);if (mb_strpos(mb_strtolower($v4340fd73e75df7a9d9e45902a59ba3a4), 'content-encoding: gzip')) {$v568d8e07bbe5575518d5005e559743c3 = gzinflate(mb_substr($v568d8e07bbe5575518d5005e559743c3, 10));}if (!$v568d8e07bbe5575518d5005e559743c3) {throw new publicAdminException(getLabel('label-feed-can-not-load-content', false, $this->url));}set_error_handler([&$this, 'error_handler']);if ($vdbd153490a1c3720a970a611afc4371c) {$v568d8e07bbe5575518d5005e559743c3 = iconv(mb_strtoupper($vdbd153490a1c3720a970a611afc4371c), 'UTF-8//IGNORE', $v568d8e07bbe5575518d5005e559743c3);$v568d8e07bbe5575518d5005e559743c3 = preg_replace("/(encoding=\"{$vdbd153490a1c3720a970a611afc4371c}\")/i", 'encoding="UTF-8"', $v568d8e07bbe5575518d5005e559743c3);}elseif (function_exists('mb_detect_encoding')) {if (mb_detect_encoding($v568d8e07bbe5575518d5005e559743c3, 'UTF-8, ISO-8859-1, GBK, CP1251') != 'UTF-8') {$v568d8e07bbe5575518d5005e559743c3 = iconv('CP1251', 'UTF-8//IGNORE', $v568d8e07bbe5575518d5005e559743c3);$v568d8e07bbe5575518d5005e559743c3 = preg_replace('/(encoding="windows-1251")/i', 'encoding="UTF-8"', $v568d8e07bbe5575518d5005e559743c3);}}restore_error_handler();$this->xml = secure_load_simple_xml($v568d8e07bbe5575518d5005e559743c3);if (!$this->xml) {throw new publicAdminException(getLabel('label-feed-can-not-load-content', false, $this->url));}}public function error_handler($v70106d0d821513f45702b7d25664ab7c, $v809b1abe3f111fd3bb1a54c62706129f) {if (mb_strpos($v809b1abe3f111fd3bb1a54c62706129f, 'Detected an illegal character in input string')) {throw new publicAdminException(getLabel('label-feed-incorrect-charset', false, $this->url));}}public function loadRSS() {if (mb_strtolower($this->xml->getName()) != 'rss') {throw new publicAdminException(getLabel('label-feed-incorrect-type', false, $this->url));}foreach ($this->xml->channel->item as $v6b992fa9cd5bc92bc5a1efc4738a707e) {$v447b7147e84be512208dcc0995d67ebc = new RSSItem();$v447b7147e84be512208dcc0995d67ebc->setTitle($v6b992fa9cd5bc92bc5a1efc4738a707e->title);$v447b7147e84be512208dcc0995d67ebc->setContent($v6b992fa9cd5bc92bc5a1efc4738a707e->description);if ($v6b992fa9cd5bc92bc5a1efc4738a707e->pubDate) {$v447b7147e84be512208dcc0995d67ebc->setDate($v6b992fa9cd5bc92bc5a1efc4738a707e->pubDate);}else {$v447b7147e84be512208dcc0995d67ebc->setDate(date('Y-m-d H:i'));}$v447b7147e84be512208dcc0995d67ebc->setUrl($v6b992fa9cd5bc92bc5a1efc4738a707e->link);$this->items[] = $v447b7147e84be512208dcc0995d67ebc;}}public function loadAtom() {if (mb_strtolower($this->xml->getName()) != 'feed') {throw new publicAdminException(getLabel('label-feed-incorrect-type', false, $this->url));}foreach ($this->xml as $ve4d23e841d8e8804190027bce3180fa5 => $v6b992fa9cd5bc92bc5a1efc4738a707e) {if ($ve4d23e841d8e8804190027bce3180fa5 != 'entry') {continue;}if ($v6b992fa9cd5bc92bc5a1efc4738a707e->content) {$v9a0364b9e99bb480dd25e1f0284c8555 = $v6b992fa9cd5bc92bc5a1efc4738a707e->content;}else {$v9a0364b9e99bb480dd25e1f0284c8555 = $v6b992fa9cd5bc92bc5a1efc4738a707e->summary;}$v447b7147e84be512208dcc0995d67ebc = new RSSItem();$v447b7147e84be512208dcc0995d67ebc->setTitle($v6b992fa9cd5bc92bc5a1efc4738a707e->title);$v447b7147e84be512208dcc0995d67ebc->setContent($v9a0364b9e99bb480dd25e1f0284c8555);$v447b7147e84be512208dcc0995d67ebc->setDate($v6b992fa9cd5bc92bc5a1efc4738a707e->published);$v447b7147e84be512208dcc0995d67ebc->setUrl($v6b992fa9cd5bc92bc5a1efc4738a707e->link['href']);$this->items[] = $v447b7147e84be512208dcc0995d67ebc;}}public function returnItems() {return $this->items;}}