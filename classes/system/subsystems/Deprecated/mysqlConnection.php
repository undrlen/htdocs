<?php
 class mysqlConnection implements IConnection {private $host = null;private $username = null;private $password = null;private $dbname = null;private $port = false;private $persistent = false;private $critical = true;private $conn = null;private $isOpen = false;private $queriesCount = 0;private $logger = null;public function __construct(   $v67b3dba8bc6778101892eb77249db32e,   $vd56b699830e77ba53855679cb1d252da,   $v5f4dcc3b5aa765d61d8327deb882cf99,   $v4cd4a49f25984e26fe708c1fbd896653,   $v901555fb06e346cb065ceb9808dcfc25 = false,   $v23c6323bfb57bb630b8a2ecf703d6bb0 = false,   $v7e85bcb66fb9a809d5ab4f62a8b8bea8 = true  ) {$this->host = $v67b3dba8bc6778101892eb77249db32e;$this->username = $vd56b699830e77ba53855679cb1d252da;$this->password = $v5f4dcc3b5aa765d61d8327deb882cf99;$this->dbname = $v4cd4a49f25984e26fe708c1fbd896653;$this->port = $v901555fb06e346cb065ceb9808dcfc25;$this->persistent = $v23c6323bfb57bb630b8a2ecf703d6bb0;$this->critical = $v7e85bcb66fb9a809d5ab4f62a8b8bea8;}public function open() {if ($this->isOpen) {return true;}try {$vcf1e8c14e54505f60aa10ceb8d5d8ab3 = $this->host . ($this->port ? ':' . $this->port : '');if ($this->persistent) {$this->conn = mysql_pconnect($vcf1e8c14e54505f60aa10ceb8d5d8ab3, $this->username, $this->password);}else {$this->conn = mysql_connect($vcf1e8c14e54505f60aa10ceb8d5d8ab3, $this->username, $this->password, true);}if ($this->errorOccured()) {throw new Exception();}if (!mysql_select_db($this->dbname, $this->conn)) {throw new Exception();}$this->mysqlQuery("SET NAMES utf8", $this->conn);$this->mysqlQuery("SET CHARSET utf8", $this->conn);$this->mysqlQuery("SET CHARACTER SET utf8", $this->conn);$this->mysqlQuery("SET character_set_client = 'utf8'", $this->conn);$this->mysqlQuery("SET SESSION collation_connection = 'utf8_general_ci'", $this->conn);$this->mysqlQuery("SET SQL_BIG_SELECTS=1", $this->conn);$this->queriesCount += 6;}catch (Exception $ve1671797c52e15f763380b45e841ec32) {if ($this->critical) {try {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();}catch (coreException $ve1671797c52e15f763380b45e841ec32) {$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current('HTTPOutputBuffer');}$v7f2db423a49b305459147332fb01cf87->status(500);$v7f2db423a49b305459147332fb01cf87->push(file_get_contents(CURRENT_WORKING_DIR . "/errors/mysql_failed.html"));$v7f2db423a49b305459147332fb01cf87->end();}else {return false;}}$this->isOpen = true;return true;}public function getQueriesCount() {return (int) $this->queriesCount;}public function close() {if ($this->isOpen) {mysql_close($this->conn);$this->isOpen = false;}}public function query($vbe571b25caf2bbed46f6e47182670bf7) {if (!$this->isOpen) {if (!$this->open()) {return false;}}$vbe571b25caf2bbed46f6e47182670bf7 = trim($vbe571b25caf2bbed46f6e47182670bf7, " \t\n");if (defined('SQL_QUERY_DEBUG') && SQL_QUERY_DEBUG) {echo $vbe571b25caf2bbed46f6e47182670bf7 . "\r\n";}$result = $this->mysqlQuery($vbe571b25caf2bbed46f6e47182670bf7, $this->conn);++$this->queriesCount;if ($this->errorOccurred()) {throw new databaseException($this->errorDescription($vbe571b25caf2bbed46f6e47182670bf7), mysql_errno());}return $result;}public function startTransaction($v06d4cd63bde972fc66a0aed41d2f5c51 = '') {$v06d4cd63bde972fc66a0aed41d2f5c51 = (!is_string($v06d4cd63bde972fc66a0aed41d2f5c51)) ? '' : $this->escape($v06d4cd63bde972fc66a0aed41d2f5c51);$v1dccadfed7bcbb036c56a4afb97e906f = sprintf('START TRANSACTION /* %s */', $v06d4cd63bde972fc66a0aed41d2f5c51);$this->query($v1dccadfed7bcbb036c56a4afb97e906f);return $this;}public function commitTransaction() {$this->query('COMMIT');return $this;}public function rollbackTransaction() {$this->query('ROLLBACK');return $this;}public function queryResult($vbe571b25caf2bbed46f6e47182670bf7) {$result = $this->query($vbe571b25caf2bbed46f6e47182670bf7);return $result ? new mysqlQueryResult($result) : null;}public function errorOccured() {return $this->errorOccurred();}public function errorOccurred() {return mysql_error($this->conn) !== '';}public function errorDescription($vc4477f6813fbe8d695d230ed95c5e388 = null) {$v7343c51166ec07160acdf47370768d7a = mysql_error($this->conn);if ($vc4477f6813fbe8d695d230ed95c5e388) {$v7343c51166ec07160acdf47370768d7a .= " in query: " . $vc4477f6813fbe8d695d230ed95c5e388;}return $v7343c51166ec07160acdf47370768d7a;}public function isOpen() {return $this->isOpen;}public function escape($va43c1b0aa53a0c908810c06ab1ff3967) {if ($this->isOpen) {return mysql_real_escape_string($va43c1b0aa53a0c908810c06ab1ff3967);}else {return addslashes($va43c1b0aa53a0c908810c06ab1ff3967);}}public function getConnectionInfo() {return [    'host' => $this->host,    'port' => $this->port,    'user' => $this->username,    'password' => $this->password,    'dbname' => $this->dbname,    'link' => $this->conn   ];}public function setLogger(iMysqlLogger $vd58fdb62952eba87b6128598a7874e1b) {$this->logger = $vd58fdb62952eba87b6128598a7874e1b;}public function insertId() {return mysql_insert_id($this->conn);}public function errorNumber() {return mysql_errno($this->conn);}public function getServerInfo() {return mysql_get_server_info($this->conn);}public function errorMessage() {return mysql_error($this->conn);}public function affectedRows() {return mysql_affected_rows($this->conn);}public function isDuplicateKey(databaseException $v42552b1f133f9f8eb406d4f306ea9fd1) {return $v42552b1f133f9f8eb406d4f306ea9fd1->getCode() === self::DUPLICATE_KEY_ERROR_CODE;}private function getLogger() {return $this->logger;}private function mysqlQuery($v1b1cc7f086b3f074da452bc3129981eb, $v96ab4e163f4ee03aaa4d1051aa51d204) {$v6db435f352d7ea4a67807a3feb447bf7 = $this->getLogger();if ($v6db435f352d7ea4a67807a3feb447bf7 === null) {return mysql_query($v1b1cc7f086b3f074da452bc3129981eb, $v96ab4e163f4ee03aaa4d1051aa51d204);}if ($v6db435f352d7ea4a67807a3feb447bf7 instanceof iMysqlLogger) {$v6db435f352d7ea4a67807a3feb447bf7->runTimer();$v26d59e24afcb9c11f03ffe8392b68734 = mysql_query($v1b1cc7f086b3f074da452bc3129981eb, $v96ab4e163f4ee03aaa4d1051aa51d204);$vdad566b38c7c4c71d805927e9fff2732 = $v6db435f352d7ea4a67807a3feb447bf7->getTimer();$v78e731027d8fd50ed642340b7c9a63b3 = $v6db435f352d7ea4a67807a3feb447bf7->getMessage($v1b1cc7f086b3f074da452bc3129981eb, $vdad566b38c7c4c71d805927e9fff2732);$v6db435f352d7ea4a67807a3feb447bf7->log($v78e731027d8fd50ed642340b7c9a63b3);return $v26d59e24afcb9c11f03ffe8392b68734;}}public function clearCache() {return null;}}