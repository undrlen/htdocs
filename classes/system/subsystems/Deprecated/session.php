<?php
 use UmiCms\Service;class session implements iSession, iSessionValidation {private static $instance;const SECONDS_IN_ONE_MINUTE = 60;const SESSION_COOKIE_LIFE_TIME = 1209600;public static function getInstance($vea2b2676c28c0db26d39331a336c6b92 = true) {if (!self::isStarted() && $vea2b2676c28c0db26d39331a336c6b92) {@session_start();self::bufferCookieHeaders();self::deleteCookieHeaders();}if (self::$instance === null) {self::$instance = new self();}return self::$instance;}public function regenerateId() {if (self::isStarted()) {$result = session_regenerate_id();self::bufferCookieHeaders();self::deleteCookieHeaders();return $result;}return null;}public function get($v3c6e0b8a9c15224a8228b9a98ca1531d) {return self::isStarted() ? getArrayKey($_SESSION, $v3c6e0b8a9c15224a8228b9a98ca1531d) : false;}public function isExist($v3c6e0b8a9c15224a8228b9a98ca1531d) {return self::isStarted() ? array_key_exists($v3c6e0b8a9c15224a8228b9a98ca1531d, $_SESSION) : false;}public function set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804) {return self::isStarted() ? $_SESSION[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804 : false;}public function del($v3c6e0b8a9c15224a8228b9a98ca1531d) {if (!self::isStarted()) {return false;}if (is_array($v3c6e0b8a9c15224a8228b9a98ca1531d)) {foreach ($v3c6e0b8a9c15224a8228b9a98ca1531d as $v24fb4587807bc3ca815b416bf57d1399) {unset($_SESSION[$v24fb4587807bc3ca815b416bf57d1399]);}}else {unset($_SESSION[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}return true;}public function getAndClose($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v2063c1608d6e0baf80249c42e2be5804 = $this->get($v3c6e0b8a9c15224a8228b9a98ca1531d);$this->commit();return $v2063c1608d6e0baf80249c42e2be5804;}public function issetAndClose($v3c6e0b8a9c15224a8228b9a98ca1531d) {$v2063c1608d6e0baf80249c42e2be5804 = $this->isExist($v3c6e0b8a9c15224a8228b9a98ca1531d);$this->commit();return $v2063c1608d6e0baf80249c42e2be5804;}public function setAndClose($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804) {$this->set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804);$this->commit();}public function delAndClose($v3c6e0b8a9c15224a8228b9a98ca1531d) {$this->del($v3c6e0b8a9c15224a8228b9a98ca1531d);$this->commit();}public function getArrayCopy() {return self::isStarted() ? $_SESSION : [];}public function clear() {if (self::isStarted()) {$_SESSION = [];session_unset();}}public static function commit() {if (self::isStarted()) {session_commit();}}public static function destroy() {if (self::isStarted()) {session_destroy();}}public static function setId($vb80bb7740288fda1f201890375a60c8f) {if (self::isStarted()) {return session_id($vb80bb7740288fda1f201890375a60c8f);}return null;}public static function getId() {if (self::isStarted()) {return session_id();}return null;}public function getIdAndClose() {$vb80bb7740288fda1f201890375a60c8f = $this->getId();$this->commit();return $vb80bb7740288fda1f201890375a60c8f;}public static function setName($vb068931cc450442b63f5b3d276ea4297) {if (self::isStarted()) {return session_name($vb068931cc450442b63f5b3d276ea4297);}return null;}public static function getName() {if (self::isStarted()) {return session_name();}return null;}public function __get($v3c6e0b8a9c15224a8228b9a98ca1531d) {return $this->get($v3c6e0b8a9c15224a8228b9a98ca1531d);}public function __isset($v3c6e0b8a9c15224a8228b9a98ca1531d) {return $this->isExist($v3c6e0b8a9c15224a8228b9a98ca1531d);}public function __set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804) {return $this->set($v3c6e0b8a9c15224a8228b9a98ca1531d, $v2063c1608d6e0baf80249c42e2be5804);}public function __unset($v3c6e0b8a9c15224a8228b9a98ca1531d) {$this->del($v3c6e0b8a9c15224a8228b9a98ca1531d);}public function startActiveTime() {$this->set(self::START_TIME_KEY, time());return $this;}public function endActiveTime() {$v908d776230f35e017ee02392bc9a4d35 = time() - ($this->getMaxActiveTime() + 1) * self::SECONDS_IN_ONE_MINUTE;$this->set(self::START_TIME_KEY, $v908d776230f35e017ee02392bc9a4d35);return $this;}public function isActiveTimeExpired() {$v449f7acc06c24b890c69b290d7b036a9 = (int) $this->get(self::START_TIME_KEY);if ($v449f7acc06c24b890c69b290d7b036a9 === 0) {return false;}$v89cce9b6a30f9c15ca6e7b2162a6d55d = $this->getMaxActiveTime() * self::SECONDS_IN_ONE_MINUTE;if ($v449f7acc06c24b890c69b290d7b036a9 + $v89cce9b6a30f9c15ca6e7b2162a6d55d < time()) {return true;}return false;}public function getActiveTime() {$v449f7acc06c24b890c69b290d7b036a9 = (int) $this->get(self::START_TIME_KEY);$v89cce9b6a30f9c15ca6e7b2162a6d55d = $this->getMaxActiveTime() * self::SECONDS_IN_ONE_MINUTE;if ($v449f7acc06c24b890c69b290d7b036a9 === 0) {return $v89cce9b6a30f9c15ca6e7b2162a6d55d;}return $v449f7acc06c24b890c69b290d7b036a9 + $v89cce9b6a30f9c15ca6e7b2162a6d55d - time();}public function getMaxActiveTime() {return defined('SESSION_LIFETIME') ? SESSION_LIFETIME : 0;}private static function isStarted() {return session_status() === PHP_SESSION_ACTIVE;}private function __construct() {$this->setCookieParams();}private function __clone() {}private function setCookieParams() {$v68e2d712d4a04f581c3fb8c92ad6495d = self::SESSION_COOKIE_LIFE_TIME;$v1c0b76fce779f78f51be339c49445c49 = false;$vafc9c748a3a3e65854c3db72a324ea1b = true;$v767eb00e7715d288dabd8726bb764a83 = null;$vd6fe1d0be6347b8ef2427fa629c04485 = '/';session_set_cookie_params($v68e2d712d4a04f581c3fb8c92ad6495d, $vd6fe1d0be6347b8ef2427fa629c04485, $v767eb00e7715d288dabd8726bb764a83, $v1c0b76fce779f78f51be339c49445c49, $vafc9c748a3a3e65854c3db72a324ea1b);}private static function bufferCookieHeaders() {$v3952212ff477ba2f5b443a38a081fecb = Service::CookieJar();foreach (headers_list() as $v099fb995346f31c749f6e40db0f395e3) {$v9091da5a67b801050d20f0aae1dcbd2f = is_int(strpos($v099fb995346f31c749f6e40db0f395e3, 'Set-Cookie'));if (!$v9091da5a67b801050d20f0aae1dcbd2f) {continue;}try {$v3952212ff477ba2f5b443a38a081fecb->setFromHeader($v099fb995346f31c749f6e40db0f395e3);}catch (wrongParamException $ve1671797c52e15f763380b45e841ec32) {continue;}}}private static function deleteCookieHeaders() {@header_remove('Set-Cookie');}public static function recreateInstance($v08a3fc7e7897fe3ca69d19f76f86e93c = false) {if ((bool) $v08a3fc7e7897fe3ca69d19f76f86e93c) {self::destroy();}else {self::commit();}return self::getInstance();}public function setValid($vce74825b5a01c99b06af231de0bd667d = true) {$vdace572bc9325111a60cdfe28240da40 = $this->getMaxActiveTime();if ($vce74825b5a01c99b06af231de0bd667d) {$this->set(self::START_TIME_KEY, time());}else {$this->set(self::START_TIME_KEY, time() - ($vdace572bc9325111a60cdfe28240da40 + 1) * self::SECONDS_IN_ONE_MINUTE);}}public function isValid() {$vdace572bc9325111a60cdfe28240da40 = $this->getMaxActiveTime();if (!$this->get(self::START_TIME_KEY)) {return $vdace572bc9325111a60cdfe28240da40 * self::SECONDS_IN_ONE_MINUTE;}elseif ($this->get(self::START_TIME_KEY) + $vdace572bc9325111a60cdfe28240da40 * self::SECONDS_IN_ONE_MINUTE < time()) {return false;}else {return $this->get(self::START_TIME_KEY) + $vdace572bc9325111a60cdfe28240da40 * self::SECONDS_IN_ONE_MINUTE - time();}}}