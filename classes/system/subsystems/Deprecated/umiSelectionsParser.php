<?php
 use UmiCms\Service;class umiSelectionsParser implements iUmiSelectionsParser {private function __construct() {}public static function runSelection(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {static $permissions;if (!$permissions) {$permissions = permissionsCollection::getInstance();}if ($vef5714e0519bfaa645cdff7d28843b70->result !== false) {return $vef5714e0519bfaa645cdff7d28843b70->result;}$v59f8ce5cb01404063bd7eb308df3b7dc = self::parseSelection($vef5714e0519bfaa645cdff7d28843b70);if (!$v59f8ce5cb01404063bd7eb308df3b7dc['result']) {return false;}$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($v59f8ce5cb01404063bd7eb308df3b7dc['result']);$v9b207167e5381c47682c6b4f58a623fb = [];$v7a54cd2f0618606fbd42bff68ef9d6f8 = $vef5714e0519bfaa645cdff7d28843b70->needSimplePageFields;if ($v7a54cd2f0618606fbd42bff68ef9d6f8) {$vbf2f59279ef067377a20d7eb519fe570 = [];$result->setFetchType(IQueryResult::FETCH_ASSOC);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {if (umiCount($vf1965a857bc285d26fe22023aa5ab50d) === 4 && $permissions->isAllowedObject($permissions->getUserId(), $vf1965a857bc285d26fe22023aa5ab50d['id'])) {$v9b207167e5381c47682c6b4f58a623fb[] = $vf1965a857bc285d26fe22023aa5ab50d;$vbf2f59279ef067377a20d7eb519fe570[] = $vf1965a857bc285d26fe22023aa5ab50d['id'];}}$vbbb2a2e5d6e9995b3239d4793c79f9b3 = umiLinksHelper::getInstance();$vbbb2a2e5d6e9995b3239d4793c79f9b3->loadLinkPartForPages($vbf2f59279ef067377a20d7eb519fe570);}else {$result->setFetchType(IQueryResult::FETCH_ROW);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {list($v7057e8409c7c531a1a6e9ac3df4ed549) = $vf1965a857bc285d26fe22023aa5ab50d;if (isset($vf1965a857bc285d26fe22023aa5ab50d[1])) {$permissions->pushElementPermissions($v7057e8409c7c531a1a6e9ac3df4ed549, $vf1965a857bc285d26fe22023aa5ab50d[1]);}$v7057e8409c7c531a1a6e9ac3df4ed549 = intval($v7057e8409c7c531a1a6e9ac3df4ed549);if (in_array($v7057e8409c7c531a1a6e9ac3df4ed549, $v9b207167e5381c47682c6b4f58a623fb) == false) {$v9b207167e5381c47682c6b4f58a623fb[] = $v7057e8409c7c531a1a6e9ac3df4ed549;}}}if ($vef5714e0519bfaa645cdff7d28843b70->excludeNestedPages) {$v9b207167e5381c47682c6b4f58a623fb = self::excludeNestedPages($v9b207167e5381c47682c6b4f58a623fb, $v7a54cd2f0618606fbd42bff68ef9d6f8);}$vef5714e0519bfaa645cdff7d28843b70->result = $v9b207167e5381c47682c6b4f58a623fb;if (defined("DISABLE_CALC_FOUND_ROWS")) {if (DISABLE_CALC_FOUND_ROWS) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT FOUND_ROWS()";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a, true);$result->setFetchType(IQueryResult::FETCH_ROW);$ve2942a04780e223b215eb8b663cf5353 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$ve2942a04780e223b215eb8b663cf5353 = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}$vef5714e0519bfaa645cdff7d28843b70->count = $ve2942a04780e223b215eb8b663cf5353;}}if ($vef5714e0519bfaa645cdff7d28843b70->optimize_root_search_query) {$vef5714e0519bfaa645cdff7d28843b70->count = false;}return $vef5714e0519bfaa645cdff7d28843b70->result;}public static function runSelectionCounts(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->count !== false) {return $vef5714e0519bfaa645cdff7d28843b70->count;}$v59f8ce5cb01404063bd7eb308df3b7dc = self::parseSelection($vef5714e0519bfaa645cdff7d28843b70);if (!$v59f8ce5cb01404063bd7eb308df3b7dc['count']) {return false;}$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($v59f8ce5cb01404063bd7eb308df3b7dc['count'], true);$result->setFetchType(IQueryResult::FETCH_ROW);if ($result->length() == 0) {return false;}$ve2942a04780e223b215eb8b663cf5353 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$ve2942a04780e223b215eb8b663cf5353 = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}return $vef5714e0519bfaa645cdff7d28843b70->count = (int) $ve2942a04780e223b215eb8b663cf5353;}public static function parseSelection(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if (!defined('MAX_SELECTION_TABLE_JOINS')) {define('MAX_SELECTION_TABLE_JOINS', 10);}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = false;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = $vef5714e0519bfaa645cdff7d28843b70->getForceCond();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored = $vef5714e0519bfaa645cdff7d28843b70->getIsDomainIgnored();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored = $vef5714e0519bfaa645cdff7d28843b70->getIsLangIgnored();$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_mark_used_fields = [];$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part = [];$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables = "";$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = "";$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "";$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "";$vef5714e0519bfaa645cdff7d28843b70->sql_table_references = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common = "";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = "";$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = "";$vef5714e0519bfaa645cdff7d28843b70->sql_limit = "";self::makeLimitPart($vef5714e0519bfaa645cdff7d28843b70);self::makeHierarchyPart($vef5714e0519bfaa645cdff7d28843b70);self::makeElementTypePart($vef5714e0519bfaa645cdff7d28843b70);self::makeOwnerPart($vef5714e0519bfaa645cdff7d28843b70);self::makeObjectsPart($vef5714e0519bfaa645cdff7d28843b70);self::makeElementsPart($vef5714e0519bfaa645cdff7d28843b70);self::makePermsParts($vef5714e0519bfaa645cdff7d28843b70);self::makePropPart($vef5714e0519bfaa645cdff7d28843b70);self::makeObjectTypePart($vef5714e0519bfaa645cdff7d28843b70);self::makeOrderPart($vef5714e0519bfaa645cdff7d28843b70);self::makeNamesPart($vef5714e0519bfaa645cdff7d28843b70);self::makePropsAndNames($vef5714e0519bfaa645cdff7d28843b70);self::makeHierarchySpecificConds($vef5714e0519bfaa645cdff7d28843b70);if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins >= 59) {return ["result" => false, "count" => false];}self::makeDistinctKeywords($vef5714e0519bfaa645cdff7d28843b70);self::makeStraitJoinKeyword($vef5714e0519bfaa645cdff7d28843b70);self::makeSelectExpr($vef5714e0519bfaa645cdff7d28843b70);self::makeTables($vef5714e0519bfaa645cdff7d28843b70);self::makeWhereConditions($vef5714e0519bfaa645cdff7d28843b70);$v1126b3d9572018ac34b2e234c00dc2c3 = "";$v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($vef5714e0519bfaa645cdff7d28843b70->usedContentTables);if ($v7dabf5c198b0bab2eaa42bb03a113e55 > 1) {for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55 - 1;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v43b5c9175984c071f30b873fdce0a000 = $vef5714e0519bfaa645cdff7d28843b70->usedContentTables[$v865c0c0b4ab0e063e5caa3387c1a8741];$vd0cab90d8d20d57e2f2b9be52f7dd25d = $vef5714e0519bfaa645cdff7d28843b70->usedContentTables[$v865c0c0b4ab0e063e5caa3387c1a8741 + 1];$v1126b3d9572018ac34b2e234c00dc2c3 .= " AND {$v43b5c9175984c071f30b873fdce0a000}.obj_id = {$vd0cab90d8d20d57e2f2b9be52f7dd25d}.obj_id";}}$v16efe07aeec5bc36c29c1116370aaf55 = "";if (defined("DISABLE_CALC_FOUND_ROWS")) {if (DISABLE_CALC_FOUND_ROWS) {$v16efe07aeec5bc36c29c1116370aaf55 = "SQL_CALC_FOUND_ROWS";}}if ($vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = "";$vef5714e0519bfaa645cdff7d28843b70->sql_group_by = " GROUP BY h.id";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_group_by = "";}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
				SELECT {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join} {$v16efe07aeec5bc36c29c1116370aaf55}  {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr}
				FROM
					{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
				WHERE
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
					{$v1126b3d9572018ac34b2e234c00dc2c3}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_group_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_order_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_limit}
SQL;   $vc89ab23398f486d0df6dc8ad44ae1d4c = <<<SQL
				SELECT {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join} 
					COUNT({$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count}{$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr})
				FROM
					{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
				WHERE
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
					{$v1126b3d9572018ac34b2e234c00dc2c3}
SQL;   if ($vef5714e0519bfaa645cdff7d28843b70->optimize_root_search_query    && umiCount($vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds())    && !umiCount(array_positive_values($vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds()))   ) {$vca7adb9881c5ed53066501aa82aae638 = implode(", ", $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds());if ($vef5714e0519bfaa645cdff7d28843b70->sql_table_references) {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references = "," . $vef5714e0519bfaa645cdff7d28843b70->sql_table_references;}if ($vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required) {$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = " AND " . $vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT DISTINCT h.id
	FROM cms3_hierarchy hp
		{$vef5714e0519bfaa645cdff7d28843b70->sql_table_references}
		WHERE h.type_id IN ({$vca7adb9881c5ed53066501aa82aae638})
			AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$vca7adb9881c5ed53066501aa82aae638}))) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond} {$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond}
			AND h.is_deleted = '0'
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required}
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common}
			{$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_order_by}
				{$vef5714e0519bfaa645cdff7d28843b70->sql_limit}
SQL;    $vc89ab23398f486d0df6dc8ad44ae1d4c = <<<SQL
SELECT COUNT(DISTINCT h.id) FROM cms3_hierarchy h, cms3_hierarchy hp WHERE h.type_id IN ({$vca7adb9881c5ed53066501aa82aae638}) AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$vca7adb9881c5ed53066501aa82aae638}))) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond} {$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond} AND h.is_deleted = '0'
SQL;   }return [    'result' => $vac5c74b64b4b8352ef2f181affb5ac2a,    'count' => $vc89ab23398f486d0df6dc8ad44ae1d4c   ];}public static function makePropPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70, $v32c897053b603014098bf4e482b04c57 = false) {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();if ($v23182694bce9f52758fbab174a0b3607 = $vef5714e0519bfaa645cdff7d28843b70->getSearchStrings()) {$v80071f37861c360a27b7327e132c911a = "cms3_object_content";$v6a7f245843454cf4f28ad7c5e2572aa2 = $vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds();$v6a7f245843454cf4f28ad7c5e2572aa2 = array_extract_values($v6a7f245843454cf4f28ad7c5e2572aa2);if (umiCount($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6301cee35ea764a1e241978f93f01069 = umiHierarchy::getInstance()->getDominantTypeId(array_pop($v6a7f245843454cf4f28ad7c5e2572aa2));$v80071f37861c360a27b7327e132c911a = umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}else {$vd14a8022b085f9ef19d479cbdd581127 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();if (is_array($vd14a8022b085f9ef19d479cbdd581127) && umiCount($vd14a8022b085f9ef19d479cbdd581127)) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = array_pop($vd14a8022b085f9ef19d479cbdd581127);if ($vacf567c9c3d6cf7c6e2cc0ce108e0631 == 21 && umiCount($vd14a8022b085f9ef19d479cbdd581127)) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = array_pop($vd14a8022b085f9ef19d479cbdd581127);}if (umiBranch::checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631)) {$v80071f37861c360a27b7327e132c911a .= "_" . $vacf567c9c3d6cf7c6e2cc0ce108e0631;}}}$v056301054c43f8bbea2090debfec16b1 = "ct";$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;$ve1043d63313a1b59f16fe608277bc9a7 = self::getFileFields();if (umiCount($ve1043d63313a1b59f16fe608277bc9a7) > 0) {$vd60fb1b18e68fb7029b3ef48c9a18834 = " AND ct.field_id NOT IN (" . implode(", ", $ve1043d63313a1b59f16fe608277bc9a7) . ")";}else {$vd60fb1b18e68fb7029b3ef48c9a18834 = "";}$v4ab5dfe1c68b36d1aa7d5f8d9cde73bc = [];foreach ($v23182694bce9f52758fbab174a0b3607 as $v597a51f04d341eba4ca965899acc10b3) {$v597a51f04d341eba4ca965899acc10b3 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v597a51f04d341eba4ca965899acc10b3);$v4439237446062bd0268640161c6a6bc3 =      (is_numeric($v597a51f04d341eba4ca965899acc10b3)) ? " OR ct.float_val = '{$v597a51f04d341eba4ca965899acc10b3}' OR ct.int_val = '{$v597a51f04d341eba4ca965899acc10b3}'" : "";$v4ab5dfe1c68b36d1aa7d5f8d9cde73bc[] =      "o.name LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' OR ct.varchar_val LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' OR ct.text_val LIKE '%{$v597a51f04d341eba4ca965899acc10b3}%' {$v4439237446062bd0268640161c6a6bc3}" .      $vd60fb1b18e68fb7029b3ef48c9a18834;}$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] =     "ct.obj_id = o.id AND (" . implode(" OR ", $v4ab5dfe1c68b36d1aa7d5f8d9cde73bc) . ")";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;}if ($vc25b09274ac632224f348e21022a7106 = $vef5714e0519bfaa645cdff7d28843b70->getPropertyConds()) {$v47ec37bbecbabe9f73c2d0056e5cb796 = [];foreach ($vc25b09274ac632224f348e21022a7106 as $v7f8b41bdd7c22fc431a0314de4595025) {if ($v7f8b41bdd7c22fc431a0314de4595025['type'] !== false) {$v47ec37bbecbabe9f73c2d0056e5cb796[] = $v7f8b41bdd7c22fc431a0314de4595025;}}unset($vc25b09274ac632224f348e21022a7106);if ($v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($v47ec37bbecbabe9f73c2d0056e5cb796)) {$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v5cba202deaa7e9f47bd0317cf014c64b = $v47ec37bbecbabe9f73c2d0056e5cb796[$v865c0c0b4ab0e063e5caa3387c1a8741];$vf642bf0e4102797f994548b9f4ee9e4a = (isset($v5cba202deaa7e9f47bd0317cf014c64b['filter_type']) ? $v5cba202deaa7e9f47bd0317cf014c64b['filter_type'] : '');$v01aaeba75d696598feafcb0226fdb7e9 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['value']) ? $v5cba202deaa7e9f47bd0317cf014c64b['value'] : null);$v0f728ec6147eaec54f5f45e37bce8ddd = (isset($v5cba202deaa7e9f47bd0317cf014c64b['field_id']) ? $v5cba202deaa7e9f47bd0317cf014c64b['field_id'] : 0);$v1abd88b57ac7e290b6c91d26b0909006 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['type']) ? $v5cba202deaa7e9f47bd0317cf014c64b['type'] : '');if ($v1abd88b57ac7e290b6c91d26b0909006 == 'optioned') {if (!is_array($v01aaeba75d696598feafcb0226fdb7e9)) {continue;}$v14f802e1fba977727845e8872c1743a7 = array_keys($v01aaeba75d696598feafcb0226fdb7e9);if (umiCount($v14f802e1fba977727845e8872c1743a7) == 0) {continue;}list($v1abd88b57ac7e290b6c91d26b0909006) = $v14f802e1fba977727845e8872c1743a7;if (in_array($v1abd88b57ac7e290b6c91d26b0909006, ['int', 'float', 'varchar', 'tree', 'rel']) == false) {continue;}$v1abd88b57ac7e290b6c91d26b0909006 .= "_val";}if (!$vef5714e0519bfaa645cdff7d28843b70->getConditionModeOr() || $vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded == 0) {$v056301054c43f8bbea2090debfec16b1 = "c" . (++$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded);$v80071f37861c360a27b7327e132c911a = self::chooseContentTableName($vef5714e0519bfaa645cdff7d28843b70, $v47ec37bbecbabe9f73c2d0056e5cb796[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']);$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;}if (!$v32c897053b603014098bf4e482b04c57) {$v64df937f321ebd648bc77b99cf76cb38 = $v056301054c43f8bbea2090debfec16b1 . ".obj_id = o.id AND " . $v056301054c43f8bbea2090debfec16b1 . ".field_id = '" . $v0f728ec6147eaec54f5f45e37bce8ddd . "'";}else {$v64df937f321ebd648bc77b99cf76cb38 = $v056301054c43f8bbea2090debfec16b1 . ".field_id = '" . $v0f728ec6147eaec54f5f45e37bce8ddd . "'";}if ($v1abd88b57ac7e290b6c91d26b0909006 != 'optioned') {$v4cdef984848c418ea8a3c646e5852e32 = $v056301054c43f8bbea2090debfec16b1 . "." . $v1abd88b57ac7e290b6c91d26b0909006;}switch ($vf642bf0e4102797f994548b9f4ee9e4a) {case 'equal':        if ($v01aaeba75d696598feafcb0226fdb7e9) {if (!is_array($v01aaeba75d696598feafcb0226fdb7e9)) {$v01aaeba75d696598feafcb0226fdb7e9 = [$v01aaeba75d696598feafcb0226fdb7e9];}$v3a0317e07571e01889f5f6982960cc2a = "'" . (implode("', '", array_map([$v4717d53ebfdfea8477f780ec66151dcb, 'escape'], $v01aaeba75d696598feafcb0226fdb7e9))) . "'";$vf92fcd26dc4ba92f75934707ad0917d9 = "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND (" . $v4cdef984848c418ea8a3c646e5852e32 . " IN (" . $v3a0317e07571e01889f5f6982960cc2a . ")))";}else {$v01aaeba75d696598feafcb0226fdb7e9 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "({$v64df937f321ebd648bc77b99cf76cb38} AND ({$v4cdef984848c418ea8a3c646e5852e32} = '{$v01aaeba75d696598feafcb0226fdb7e9}' OR {$v4cdef984848c418ea8a3c646e5852e32} IS NULL))";}break;case 'not_equal':        if (!is_array($v01aaeba75d696598feafcb0226fdb7e9)) {$v01aaeba75d696598feafcb0226fdb7e9 = [$v01aaeba75d696598feafcb0226fdb7e9];}$v3a0317e07571e01889f5f6982960cc2a = "'" . (implode("', '", array_map([$v4717d53ebfdfea8477f780ec66151dcb, 'escape'], $v01aaeba75d696598feafcb0226fdb7e9))) . "'";$vf92fcd26dc4ba92f75934707ad0917d9 =         "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND ((" . $v4cdef984848c418ea8a3c646e5852e32 . " IS NULL) OR (" . $v4cdef984848c418ea8a3c646e5852e32 . " NOT IN (" .         $v3a0317e07571e01889f5f6982960cc2a .         "))))";break;case 'like':        $vb6c8416e95a754076b10d65d1afd3fa9 = true;if (substr($v01aaeba75d696598feafcb0226fdb7e9, 0, 1) === '%' || substr($v01aaeba75d696598feafcb0226fdb7e9, -1) === '%') {$vb6c8416e95a754076b10d65d1afd3fa9 = false;}$vf578b860df8544c8f826f66977b6e908 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 =         "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND " . $v4cdef984848c418ea8a3c646e5852e32 . " LIKE '" . ($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "") .         $vf578b860df8544c8f826f66977b6e908 .         ($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "") . "')";break;case 'between':        $v17fdfd1db155ff501f9553066c50cdab = (isset($v5cba202deaa7e9f47bd0317cf014c64b['min']) ? floatval($v5cba202deaa7e9f47bd0317cf014c64b['min']) : 0);$v3a86ffe4f7adcc1fe1457ada5ec034b0 = (isset($v5cba202deaa7e9f47bd0317cf014c64b['max']) ? floatval($v5cba202deaa7e9f47bd0317cf014c64b['max']) : 0);$vf92fcd26dc4ba92f75934707ad0917d9 =         "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND " . $v4cdef984848c418ea8a3c646e5852e32 . " BETWEEN '" . $v17fdfd1db155ff501f9553066c50cdab . "' AND '" . $v3a86ffe4f7adcc1fe1457ada5ec034b0 .         "')";break;case 'more':        $v6ec037ff2ad4d8e71e8a10efa0ba90ba = floatval($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND " . $v4cdef984848c418ea8a3c646e5852e32 . " >= '" . $v6ec037ff2ad4d8e71e8a10efa0ba90ba . "')";break;case 'less':        $v6ec037ff2ad4d8e71e8a10efa0ba90ba = floatval($v01aaeba75d696598feafcb0226fdb7e9);$vf92fcd26dc4ba92f75934707ad0917d9 = "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND " . $v4cdef984848c418ea8a3c646e5852e32 . " <= '" . $v6ec037ff2ad4d8e71e8a10efa0ba90ba . "')";break;case 'null':        $v414ee59f59563c9833253cffbd604713 = rand();$vf92fcd26dc4ba92f75934707ad0917d9 = <<<SQL
($v64df937f321ebd648bc77b99cf76cb38 AND $v4cdef984848c418ea8a3c646e5852e32 IS NULL 
OR NOT EXISTS (SELECT 1 
     FROM $v80071f37861c360a27b7327e132c911a c$v414ee59f59563c9833253cffbd604713
     WHERE c$v414ee59f59563c9833253cffbd604713.obj_id = o.id AND c$v414ee59f59563c9833253cffbd604713.field_id = '$v0f728ec6147eaec54f5f45e37bce8ddd'))
SQL;        break;case 'notnull':        $vf92fcd26dc4ba92f75934707ad0917d9 = "(" . $v64df937f321ebd648bc77b99cf76cb38 . " AND " . $v4cdef984848c418ea8a3c646e5852e32 . " IS NOT NULL)";break;default:        $vf92fcd26dc4ba92f75934707ad0917d9 = "";break;}if (strlen($vf92fcd26dc4ba92f75934707ad0917d9)) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = $vf92fcd26dc4ba92f75934707ad0917d9;}}if (umiCount($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part)) {$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins += $v865c0c0b4ab0e063e5caa3387c1a8741;}}}}private static function makeDistinctKeywords(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = '';$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = '';if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content ||    ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy && $vef5714e0519bfaa645cdff7d28843b70->sql_part__perms)) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct = ' DISTINCT';$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_distinct_count = 'DISTINCT ';}}private static function makeStraitJoinKeyword(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if (MAX_SELECTION_TABLE_JOINS > 0 && $vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins > MAX_SELECTION_TABLE_JOINS) {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "STRAIGHT_JOIN";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_kwd_straight_join = "";}}private static function makeSelectExpr(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables) {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "h.id, MAX(c3p.level)";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "h.id";}if ($vef5714e0519bfaa645cdff7d28843b70->needSimplePageFields) {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "h.id, h.alt_name, h.rel, o.name";}$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr = "h.id";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_select_expr = "o.id";$vef5714e0519bfaa645cdff7d28843b70->sql_select_count_expr = "o.id";}}private static function makeTables(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v3e4e493f22840daa9ac1724a72ab3e69 = '';if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content) {$v3e4e493f22840daa9ac1724a72ab3e69 = $vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables;}if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables || $vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired ||     $vef5714e0519bfaa645cdff7d28843b70->needSimplePageFields) {$ve73bcc9cfc2941d6e1afe96205af0d0e = "cms3_objects o,";}else {$ve73bcc9cfc2941d6e1afe96205af0d0e = "";}$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= <<<SQL
					{$ve73bcc9cfc2941d6e1afe96205af0d0e}
					cms3_hierarchy h
					{$v3e4e493f22840daa9ac1724a72ab3e69}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables}
SQL;   }else {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= <<<SQL
					cms3_objects o
					{$v3e4e493f22840daa9ac1724a72ab3e69}
SQL;   }}private static function makeWhereConditions(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_part__owner) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = " AND " . $vef5714e0519bfaa645cdff7d28843b70->sql_part__owner;}$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_common = <<<SQL
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements}
SQL;   if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy     && !$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables     && !$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired    ) {$v0e2dd3565df1bb7b04bb23eee21bef0b = "";}else {$v0e2dd3565df1bb7b04bb23eee21bef0b = "h.obj_id = o.id AND ";}if ($vef5714e0519bfaa645cdff7d28843b70->needSimplePageFields) {$v0e2dd3565df1bb7b04bb23eee21bef0b = "h.obj_id = o.id AND ";}$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = <<<SQL
					{$v0e2dd3565df1bb7b04bb23eee21bef0b}
					h.is_deleted = '0'
SQL;    $vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = <<<SQL
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond}
					{$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond}
SQL;   }else {$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_required = "1";$vef5714e0519bfaa645cdff7d28843b70->sql_where_condition_additional = "";}}private static function makeLimitPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_limit = "";$v4db7515c8b18fa48e815e443f5783196 = $vef5714e0519bfaa645cdff7d28843b70->getLimitConds();if ($v4db7515c8b18fa48e815e443f5783196 !== false) {if (is_array($v4db7515c8b18fa48e815e443f5783196) && umiCount($v4db7515c8b18fa48e815e443f5783196) > 1 && is_numeric($v4db7515c8b18fa48e815e443f5783196[0]) &&     is_numeric($v4db7515c8b18fa48e815e443f5783196[1])) {$vee00b4dd5a72dccc8a3bf821a0854ef9 = intval($v4db7515c8b18fa48e815e443f5783196[0]);$vac588e91956d2ecbac36ea0c4f3dceec = intval($v4db7515c8b18fa48e815e443f5783196[1]);$vf4a0ecf68633a2a8d8bbc8a44a5c8829 = $vac588e91956d2ecbac36ea0c4f3dceec * $vee00b4dd5a72dccc8a3bf821a0854ef9;$vef5714e0519bfaa645cdff7d28843b70->sql_limit = " LIMIT " . $vf4a0ecf68633a2a8d8bbc8a44a5c8829 . ", " . $vee00b4dd5a72dccc8a3bf821a0854ef9;}}return $vef5714e0519bfaa645cdff7d28843b70->sql_limit;}private static function makeHierarchyPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {static $v0fea6a13c52b4d4725368f24b045ca84 = [];$v09e7a2bb896092bc4abe376dc931f83e = $vef5714e0519bfaa645cdff7d28843b70->getHierarchyConds();$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();if (!empty($v09e7a2bb896092bc4abe376dc931f83e)) {$v32ba5dc8b093c913a929cf77b2fe5679 = 0;$v71f3d1a6a90fada957aea649a871d420 = 0;$v6b31ca7a6d10b4f4bdf4bcf1d2e27244 = [];foreach ($v09e7a2bb896092bc4abe376dc931f83e as $v50e7514e30aa173cb1278b26505e79bb) {list($vbfa030fe63bacd523dd70a76cfaed98a, $v12a055bf01a31369fe81ac35d85c7bc1) = $v50e7514e30aa173cb1278b26505e79bb;if ($vbfa030fe63bacd523dd70a76cfaed98a == 0) {$v32ba5dc8b093c913a929cf77b2fe5679++;--$v12a055bf01a31369fe81ac35d85c7bc1;}if (isset($v0fea6a13c52b4d4725368f24b045ca84[$vbfa030fe63bacd523dd70a76cfaed98a])) {$vc9e9a848920877e76685b2e4e76de38d = $v0fea6a13c52b4d4725368f24b045ca84[$vbfa030fe63bacd523dd70a76cfaed98a];}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT level FROM cms3_hierarchy_relations WHERE child_id = {$vbfa030fe63bacd523dd70a76cfaed98a}";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$vc9e9a848920877e76685b2e4e76de38d = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$vc9e9a848920877e76685b2e4e76de38d = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}$v0fea6a13c52b4d4725368f24b045ca84[$vbfa030fe63bacd523dd70a76cfaed98a] = $vc9e9a848920877e76685b2e4e76de38d;}$v131eec2e3a1c0cebac938273907d5290 = ($vbfa030fe63bacd523dd70a76cfaed98a > 0) ? "hr.rel_id = '{$vbfa030fe63bacd523dd70a76cfaed98a}'" : "hr.rel_id IS NULL";if ($v71f3d1a6a90fada957aea649a871d420 == 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_table_references .= "cms3_hierarchy_relations hr, ";$v71f3d1a6a90fada957aea649a871d420++;}$vb81e229503292fbbcb3ff39f8fb2ce76 = $v12a055bf01a31369fe81ac35d85c7bc1 + $vc9e9a848920877e76685b2e4e76de38d + 1;$v6b31ca7a6d10b4f4bdf4bcf1d2e27244[] = <<<SQL
({$v131eec2e3a1c0cebac938273907d5290} AND hr.level <= '{$vb81e229503292fbbcb3ff39f8fb2ce76}') AND hr.child_id = h.id
SQL;    }if (umiCount($v6b31ca7a6d10b4f4bdf4bcf1d2e27244) > 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__hierarchy .= " AND ((" . implode(") OR (", $v6b31ca7a6d10b4f4bdf4bcf1d2e27244) . ")) ";}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored = ($v32ba5dc8b093c913a929cf77b2fe5679) ? false : true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored = ($v32ba5dc8b093c913a929cf77b2fe5679) ? false : true;$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;if (umiCount($v09e7a2bb896092bc4abe376dc931f83e) == 1) {if ($v09e7a2bb896092bc4abe376dc931f83e[0] != 0) {$vef5714e0519bfaa645cdff7d28843b70->sql_cond_auto_domain = true;}}else {$vef5714e0519bfaa645cdff7d28843b70->sql_cond_auto_domain = true;}}}private static function makeElementTypePart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vf39b5a31bc0c51db0171da81d3523763 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();if ($vf39b5a31bc0c51db0171da81d3523763 && umiCount($vf39b5a31bc0c51db0171da81d3523763)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__element_type = " AND h.type_id IN ('" . implode("', '", $vf39b5a31bc0c51db0171da81d3523763) . "')";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;}}private static function makeOwnerPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vf14994e23e2f95ddcfe1f7db4b8c2837 = $vef5714e0519bfaa645cdff7d28843b70->getOwnerConds();if (is_array($vf14994e23e2f95ddcfe1f7db4b8c2837) && umiCount($vf14994e23e2f95ddcfe1f7db4b8c2837)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = " o.owner_id IN ('" . implode("', '", $vf14994e23e2f95ddcfe1f7db4b8c2837) . "')";$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}private static function makeObjectsPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vcf7ed7a30bdebabccdfa6099ba7df387 = $vef5714e0519bfaa645cdff7d28843b70->getObjectsConds();if (is_array($vcf7ed7a30bdebabccdfa6099ba7df387) && umiCount($vcf7ed7a30bdebabccdfa6099ba7df387)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__objects = " AND o.id IN ('" . implode("', '", $vcf7ed7a30bdebabccdfa6099ba7df387) . "')";}}private static function makeElementsPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v08ad7524bd80c27d5ec900b7d03a0820 = $vef5714e0519bfaa645cdff7d28843b70->getElementsConds();if (is_array($v08ad7524bd80c27d5ec900b7d03a0820) && umiCount($v08ad7524bd80c27d5ec900b7d03a0820)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__elements = " AND h.id IN ('" . implode("', '", $v08ad7524bd80c27d5ec900b7d03a0820) . "')";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;}}private static function makePermsParts(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($v077e247dd24fb5f2092caa5b6ecd4404 = $vef5714e0519bfaa645cdff7d28843b70->getPermissionsConds()) {$v1876714ec08549d69462e2d7617c83c8 = Service::SystemUsersPermissions();$v92ad7554e2e0d208f33729db6d54b59b = $v1876714ec08549d69462e2d7617c83c8->getGuestUserId();$v077e247dd24fb5f2092caa5b6ecd4404[] = $v92ad7554e2e0d208f33729db6d54b59b;if ($v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($v077e247dd24fb5f2092caa5b6ecd4404)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms_tables = ",cms3_permissions c3p";$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy = true;$v61b9295e93e2ba331ea1e6f1b79f459d = $vef5714e0519bfaa645cdff7d28843b70->getRequiredPermissionsLevel();for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= ($v865c0c0b4ab0e063e5caa3387c1a8741 === 0 ? " AND (" : "");$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= "(c3p.owner_id = '" . $v077e247dd24fb5f2092caa5b6ecd4404[$v865c0c0b4ab0e063e5caa3387c1a8741] .       "' AND c3p.rel_id = h.id AND c3p.level & '{$v61b9295e93e2ba331ea1e6f1b79f459d}')";$vef5714e0519bfaa645cdff7d28843b70->sql_part__perms .= ($v865c0c0b4ab0e063e5caa3387c1a8741 === ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1) ? ")" : " OR ");}}}}private static function makeObjectTypePart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vcc186db1b3286c09fd5b1f61c6b78b8c = $vef5714e0519bfaa645cdff7d28843b70->getObjectTypeConds();if ($vcc186db1b3286c09fd5b1f61c6b78b8c && umiCount($vcc186db1b3286c09fd5b1f61c6b78b8c)) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__object_type = " AND o.type_id IN ('" . implode("', '", $vcc186db1b3286c09fd5b1f61c6b78b8c) . "')";$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}private static function makeOrderPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vc7f62b660bf9e56e6df63ef3d2540a77 = $vef5714e0519bfaa645cdff7d28843b70->getOrderConds();if ($vc7f62b660bf9e56e6df63ef3d2540a77) {$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = " ORDER BY ";$v7dabf5c198b0bab2eaa42bb03a113e55 = umiCount($vc7f62b660bf9e56e6df63ef3d2540a77);for ($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {if ($v11537f7c46ecc6ae45e5497ea0aec6bf = $vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['native_field']) {switch ($v11537f7c46ecc6ae45e5497ea0aec6bf) {case "name": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.name " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");$vef5714e0519bfaa645cdff7d28843b70->sql_need_object_table = true;$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;break;}case "object_id": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.id " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;break;}case "rand": {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "RAND()";break;}case "ord": {if ($vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired && !$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "o.ord " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");}else {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "h.ord " . (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");}break;}}if ($v865c0c0b4ab0e063e5caa3387c1a8741 !== ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= ", ";}}else {$vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_content = true;$v056301054c43f8bbea2090debfec16b1 = "c" . (++$vef5714e0519bfaa645cdff7d28843b70->sql_cond__content_tables_loaded);$v80071f37861c360a27b7327e132c911a = self::chooseContentTableName($vef5714e0519bfaa645cdff7d28843b70, $vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']);$vef5714e0519bfaa645cdff7d28843b70->sql_part__content_tables .= ", {$v80071f37861c360a27b7327e132c911a} {$v056301054c43f8bbea2090debfec16b1}";$vef5714e0519bfaa645cdff7d28843b70->usedContentTables[] = $v056301054c43f8bbea2090debfec16b1;$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order'][] =       "{$v056301054c43f8bbea2090debfec16b1}.obj_id = o.id AND {$v056301054c43f8bbea2090debfec16b1}.field_id = '{$vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['field_id']}'";$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= "{$v056301054c43f8bbea2090debfec16b1}.{$vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['type']} " .       (($vc7f62b660bf9e56e6df63ef3d2540a77[$v865c0c0b4ab0e063e5caa3387c1a8741]['asc']) ? "ASC" : "DESC");if ($v865c0c0b4ab0e063e5caa3387c1a8741 == ($v7dabf5c198b0bab2eaa42bb03a113e55 - 1)) {}else {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by .= ", ";}}}if ($vef5714e0519bfaa645cdff7d28843b70->sql_order_by == " ORDER BY ") {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = "";}$vef5714e0519bfaa645cdff7d28843b70->sql_cond__total_joins += $v865c0c0b4ab0e063e5caa3387c1a8741;}elseif ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy == true) {$vef5714e0519bfaa645cdff7d28843b70->sql_order_by = " ORDER BY h.ord";}}private static function makeNamesPart(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$v932238d827b73f9a5329f0ee492a6175 = [];$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();if (($v44c20123a4be1d9cc98c2f1c2470598d = $vef5714e0519bfaa645cdff7d28843b70->getNameConds()) && umiCount($v44c20123a4be1d9cc98c2f1c2470598d)) {foreach ($v44c20123a4be1d9cc98c2f1c2470598d as $ve0f38ebd960676b35b7fda2446bff541) {$v056301054c43f8bbea2090debfec16b1 = $ve0f38ebd960676b35b7fda2446bff541['value'];$vb6c8416e95a754076b10d65d1afd3fa9 = true;if (substr($v056301054c43f8bbea2090debfec16b1, 0, 1) === '%' || substr($v056301054c43f8bbea2090debfec16b1, -1) === '%') {$vb6c8416e95a754076b10d65d1afd3fa9 = false;}$v056301054c43f8bbea2090debfec16b1 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v056301054c43f8bbea2090debfec16b1);if ($ve0f38ebd960676b35b7fda2446bff541['type'] == 'exact') {$v932238d827b73f9a5329f0ee492a6175[] = "o.name = '" . $v056301054c43f8bbea2090debfec16b1 . "'";}else {$v932238d827b73f9a5329f0ee492a6175[] =       "o.name LIKE '" . ($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "") . $v056301054c43f8bbea2090debfec16b1 . ($vb6c8416e95a754076b10d65d1afd3fa9 ? "%" : "") . "'";}$vef5714e0519bfaa645cdff7d28843b70->objectTableIsRequired = true;}}if (umiCount($v932238d827b73f9a5329f0ee492a6175)) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = "(" . implode(' OR ', $v932238d827b73f9a5329f0ee492a6175) . ")";}}private static function makePropsAndNames(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names = "";if ($vef5714e0519bfaa645cdff7d28843b70->sql_part__owner) {$vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'][] = $vef5714e0519bfaa645cdff7d28843b70->sql_part__owner;$vef5714e0519bfaa645cdff7d28843b70->sql_part__owner = "";}if (isset($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where'])) {$v91119290c889cd919565d8b3e0e39560 = ($vef5714e0519bfaa645cdff7d28843b70->getConditionModeOr() ? ' OR ' : ' AND ');$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names =     " AND (" . implode($v91119290c889cd919565d8b3e0e39560, $vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['where']) . ")";}if (isset($vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order'])) {$vef5714e0519bfaa645cdff7d28843b70->sql_part__props_and_names .= " AND (" .     implode(" AND ", $vef5714e0519bfaa645cdff7d28843b70->sql_arr_for_and_or_part['order']) .     ")";}}private static function makeHierarchySpecificConds(umiSelection $vef5714e0519bfaa645cdff7d28843b70) {if ($vef5714e0519bfaa645cdff7d28843b70->sql_cond__need_hierarchy == true) {{if (!$vef5714e0519bfaa645cdff7d28843b70->sql_cond__lang_ignored) {if (($vf585b7f018bb4ced15a03683a733e50b = $vef5714e0519bfaa645cdff7d28843b70->getLangId()) == false) {$vf585b7f018bb4ced15a03683a733e50b = (int) cmsController::getInstance()->getCurrentLang()->getId();}$vef5714e0519bfaa645cdff7d28843b70->sql_part__lang_cond = " AND h.lang_id = '" . $vf585b7f018bb4ced15a03683a733e50b . "' ";}}if (!$vef5714e0519bfaa645cdff7d28843b70->sql_cond__domain_ignored) {if (($v72ee76c5c29383b7c9f9225c1fa4d10b = $vef5714e0519bfaa645cdff7d28843b70->getDomainId()) == false) {$v72ee76c5c29383b7c9f9225c1fa4d10b = cmsController::getInstance()->getCurrentDomain()->getId();}$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = " AND h.domain_id = '" . (int) $v72ee76c5c29383b7c9f9225c1fa4d10b . "' ";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_part__domain_cond = "";}if ($vca47c8f843acba03d8a1ba7138319e58 = $vef5714e0519bfaa645cdff7d28843b70->getActiveConds()) {$v4264c638e0098acb172519b0436db099 = (isset($vca47c8f843acba03d8a1ba7138319e58[0]) && (bool) $vca47c8f843acba03d8a1ba7138319e58[0]) ? 1 : 0;$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond = " AND h.is_active = '" . $v4264c638e0098acb172519b0436db099 . "' ";}else {$vef5714e0519bfaa645cdff7d28843b70->sql_part__unactive_cond =      (cmsController::getInstance()->getCurrentMode() != "admin") ? " AND h.is_active = '1' " : "";}}}protected static function chooseContentTableName(umiSelection $vef5714e0519bfaa645cdff7d28843b70, $v945100186b119048837b9859c2c46410) {$v6942e8fa62b3cc9d93881a58210e2fd7 = $vef5714e0519bfaa645cdff7d28843b70->getElementTypeConds();$v0e8133eb006c0f85ed9444ae07a60842 = $vef5714e0519bfaa645cdff7d28843b70->getObjectTypeConds();if (!is_array($v6942e8fa62b3cc9d93881a58210e2fd7)) {$v6942e8fa62b3cc9d93881a58210e2fd7 = [];}else {$v6942e8fa62b3cc9d93881a58210e2fd7 = array_extract_values($v6942e8fa62b3cc9d93881a58210e2fd7);}if (!is_array($v0e8133eb006c0f85ed9444ae07a60842)) {$v0e8133eb006c0f85ed9444ae07a60842 = [];}else {$v0e8133eb006c0f85ed9444ae07a60842 = array_extract_values($v0e8133eb006c0f85ed9444ae07a60842);}if (umiCount($v6942e8fa62b3cc9d93881a58210e2fd7) == 1) {reset($v6942e8fa62b3cc9d93881a58210e2fd7);$vacf567c9c3d6cf7c6e2cc0ce108e0631 = current($v6942e8fa62b3cc9d93881a58210e2fd7);$v4aa3988e15afb9618423a0c2961a469f = umiBranch::checkIfBranchedByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631);return $v4aa3988e15afb9618423a0c2961a469f ? "cms3_object_content_{$vacf567c9c3d6cf7c6e2cc0ce108e0631}" : "cms3_object_content";}if (umiCount($v6942e8fa62b3cc9d93881a58210e2fd7) > 1) {$v6301cee35ea764a1e241978f93f01069 = self::getObjectTypeByFieldId($v945100186b119048837b9859c2c46410);return umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}if (umiCount($v6942e8fa62b3cc9d93881a58210e2fd7) == 0) {if (umiCount($v0e8133eb006c0f85ed9444ae07a60842) == 1) {reset($v0e8133eb006c0f85ed9444ae07a60842);$v6301cee35ea764a1e241978f93f01069 = current($v0e8133eb006c0f85ed9444ae07a60842);}else {$v6301cee35ea764a1e241978f93f01069 = self::getObjectTypeByFieldId($v945100186b119048837b9859c2c46410);}return umiBranch::getBranchedTableByTypeId($v6301cee35ea764a1e241978f93f01069);}return "cms3_object_content";}public static function getObjectTypeByFieldId($v945100186b119048837b9859c2c46410) {return umiObjectTypesCollection::getInstance()->getTypeIdByFieldId($v945100186b119048837b9859c2c46410);}protected static function excludeNestedPages($v47c80780ab608cc046f2a6e6f071feb6, $vfb64fd45e0c5550363e8a5eccf0fe169 = true) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$result = [];foreach ($v47c80780ab608cc046f2a6e6f071feb6 as $v7552cd149af7495ee7d8225974e50f80) {if (!$vfb64fd45e0c5550363e8a5eccf0fe169) {$v7552cd149af7495ee7d8225974e50f80 = $v7552cd149af7495ee7d8225974e50f80['id'];}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {if (in_array($v8e2dcfd7e7e24b1ca76c1193f645902b->getRel(), $v47c80780ab608cc046f2a6e6f071feb6)) {continue;}else {$result[] = $v7552cd149af7495ee7d8225974e50f80;}}}return $result;}protected static function getFileFields() {static $v0fea6a13c52b4d4725368f24b045ca84 = false;if ($v0fea6a13c52b4d4725368f24b045ca84) {return $v0fea6a13c52b4d4725368f24b045ca84;}$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT of.id
	FROM cms3_object_fields of, cms3_object_field_types oft
		WHERE of.field_type_id = oft.id
		AND oft.data_type IN ('file', 'img_file', 'swf_file')
SQL;   $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v9b207167e5381c47682c6b4f58a623fb = [];foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$v9b207167e5381c47682c6b4f58a623fb[] = array_shift($vf1965a857bc285d26fe22023aa5ab50d);}return $v0fea6a13c52b4d4725368f24b045ca84 = $v9b207167e5381c47682c6b4f58a623fb;}}?>
