<?php
 namespace UmiCms\System\Module\Permissions;use UmiCms\Classes\System\Entities\Directory\iFactory as DirectoryFactory;use UmiCms\Classes\System\Entities\File\iFactory as FileFactory;class Loader implements iLoader {private $resourcesDir;private $directoryFactory;private $fileFactory;private $permissions;public function __construct(   \iCmsController $v8b1dc169bf460ee884fceef66c6607d6,   DirectoryFactory $vb7a82c37d8c13db7202ec4890aa47a7d,   FileFactory $ve9d2ea3c13cc8f3b974ffbe8695cba02  ) {$this->resourcesDir = $v8b1dc169bf460ee884fceef66c6607d6->getResourcesDirectory();$this->directoryFactory = $vb7a82c37d8c13db7202ec4890aa47a7d;$this->fileFactory = $ve9d2ea3c13cc8f3b974ffbe8695cba02;}public function load($v22884db148f0ffb0d830ba431102b0b5) {$this->permissions[$v22884db148f0ffb0d830ba431102b0b5] = [];$this->loadSystemPermissions($v22884db148f0ffb0d830ba431102b0b5);$this->loadCustomPermissions($v22884db148f0ffb0d830ba431102b0b5);$this->loadTemplatePermissions($v22884db148f0ffb0d830ba431102b0b5);$this->loadExtensionPermissions($v22884db148f0ffb0d830ba431102b0b5);return $this->permissions[$v22884db148f0ffb0d830ba431102b0b5];}private function loadSystemPermissions($v22884db148f0ffb0d830ba431102b0b5) {$v8c7dd922ad47494fc02c388e12c00eac = $this->getFile(SYS_MODULES_PATH . $v22884db148f0ffb0d830ba431102b0b5 . '/permissions.php');$this->loadFilePermissions($v22884db148f0ffb0d830ba431102b0b5, $v8c7dd922ad47494fc02c388e12c00eac);}private function loadFilePermissions($v22884db148f0ffb0d830ba431102b0b5, \iUmiFile $v8c7dd922ad47494fc02c388e12c00eac) {if (!$v8c7dd922ad47494fc02c388e12c00eac->isExists()) {return;}$permissions = [];require $v8c7dd922ad47494fc02c388e12c00eac->getFilePath();if (is_array($permissions)) {$this->permissions[$v22884db148f0ffb0d830ba431102b0b5] = array_merge_recursive(     $this->permissions[$v22884db148f0ffb0d830ba431102b0b5],     $permissions    );}}private function loadCustomPermissions($v22884db148f0ffb0d830ba431102b0b5) {$v8c7dd922ad47494fc02c388e12c00eac = $this->getFile(SYS_MODULES_PATH . $v22884db148f0ffb0d830ba431102b0b5 . '/permissions.custom.php');$this->loadFilePermissions($v22884db148f0ffb0d830ba431102b0b5, $v8c7dd922ad47494fc02c388e12c00eac);}private function loadTemplatePermissions($v22884db148f0ffb0d830ba431102b0b5) {if (!$this->resourcesDir) {return;}$v8c7dd922ad47494fc02c388e12c00eac = $this->getFile($this->resourcesDir . '/classes/modules/' . $v22884db148f0ffb0d830ba431102b0b5 . '/permissions.php');$this->loadFilePermissions($v22884db148f0ffb0d830ba431102b0b5, $v8c7dd922ad47494fc02c388e12c00eac);}private function loadExtensionPermissions($v22884db148f0ffb0d830ba431102b0b5) {$v736007832d2167baaae763fd3a3f3cf1 = $this->getDirectory(SYS_MODULES_PATH . $v22884db148f0ffb0d830ba431102b0b5);foreach ($v736007832d2167baaae763fd3a3f3cf1->getList('ext/permissions.*.php') as $vd6fe1d0be6347b8ef2427fa629c04485) {$v8c7dd922ad47494fc02c388e12c00eac = $this->fileFactory->create($vd6fe1d0be6347b8ef2427fa629c04485);$this->loadFilePermissions($v22884db148f0ffb0d830ba431102b0b5, $v8c7dd922ad47494fc02c388e12c00eac);}}private function getFile($vd6fe1d0be6347b8ef2427fa629c04485) {return $this->fileFactory->create($vd6fe1d0be6347b8ef2427fa629c04485);}private function getDirectory($vd6fe1d0be6347b8ef2427fa629c04485) {return $this->directoryFactory->create($vd6fe1d0be6347b8ef2427fa629c04485);}}