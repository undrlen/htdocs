<?php
 use UmiCms\Service;class umiPropertiesHelper {private static $instance;private $properties = [];private $umiTypesHelper;public static function getInstance() {if (self::$instance === null) {self::$instance = new umiPropertiesHelper();}return self::$instance;}public function getProperty($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab, $vbd354405a20aa635025421c9edb5d41d = false) {$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$v972bf3f05d14ffbdb817bef60638ff00 = (string) $v972bf3f05d14ffbdb817bef60638ff00;$v5f694956811487225d15e973ca38fbab = (int) $v5f694956811487225d15e973ca38fbab;$v0800fc577294c34e0b28ad2839435945 = $this->getKeyHash($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00);if (isset($this->properties[$v0800fc577294c34e0b28ad2839435945]) && !$vbd354405a20aa635025421c9edb5d41d) {return $this->properties[$v0800fc577294c34e0b28ad2839435945];}$v945100186b119048837b9859c2c46410 = $this->getFieldIdByName($v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab);if ($v945100186b119048837b9859c2c46410 === null && (bool) $vbd354405a20aa635025421c9edb5d41d) {$v945100186b119048837b9859c2c46410 = $this->getFieldIdByName($v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab, (bool) $vbd354405a20aa635025421c9edb5d41d);}if ($v945100186b119048837b9859c2c46410 === null) {return $this->properties[$v0800fc577294c34e0b28ad2839435945] = null;}try {$v1a8db4c996d8ed8289da5f957879ab94 = Service::ObjectPropertyFactory()     ->create($v16b2b26000987faccb260b9d39df1269, $v945100186b119048837b9859c2c46410);}catch (Exception $v42552b1f133f9f8eb406d4f306ea9fd1) {$v1a8db4c996d8ed8289da5f957879ab94 = null;}return $this->properties[$v0800fc577294c34e0b28ad2839435945] = $v1a8db4c996d8ed8289da5f957879ab94;}public function getPropertyValue($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab, $vbd354405a20aa635025421c9edb5d41d = false, $v21ffce5b8a6cc8cc6a41448dd69623c9 = null) {$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$v972bf3f05d14ffbdb817bef60638ff00 = (string) $v972bf3f05d14ffbdb817bef60638ff00;$v5f694956811487225d15e973ca38fbab = (int) $v5f694956811487225d15e973ca38fbab;$v0800fc577294c34e0b28ad2839435945 = md5($v16b2b26000987faccb260b9d39df1269 . $v972bf3f05d14ffbdb817bef60638ff00 . $v5f694956811487225d15e973ca38fbab);if (isset($this->properties[$v0800fc577294c34e0b28ad2839435945]) && !$vbd354405a20aa635025421c9edb5d41d) {return ($this->properties[$v0800fc577294c34e0b28ad2839435945] instanceof iUmiObjectProperty)     ? $this->properties[$v0800fc577294c34e0b28ad2839435945]->getValue()     : null;}$v1a8db4c996d8ed8289da5f957879ab94 = $this->getProperty($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab, $vbd354405a20aa635025421c9edb5d41d);return ($v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty) ? $v1a8db4c996d8ed8289da5f957879ab94->getValue($v21ffce5b8a6cc8cc6a41448dd69623c9) : null;}public function saveProperties() {$v74693d2fc58b46bd06410f278e39aa71 = $this->properties;if (umiCount($v74693d2fc58b46bd06410f278e39aa71) == 0) {return true;}foreach ($v74693d2fc58b46bd06410f278e39aa71 as $v1a8db4c996d8ed8289da5f957879ab94) {if ($v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty && $v1a8db4c996d8ed8289da5f957879ab94->getIsUpdated()) {$v9ce05738f98a62ccf86dd433f5a9d1a1 = $v1a8db4c996d8ed8289da5f957879ab94->getObject();if ($v9ce05738f98a62ccf86dd433f5a9d1a1 instanceof iUmiObject) {$v9ce05738f98a62ccf86dd433f5a9d1a1->setIsUpdated();$v9ce05738f98a62ccf86dd433f5a9d1a1->loadFields();}$v1a8db4c996d8ed8289da5f957879ab94->commit();}}return true;}public function commitProperty(iUmiObjectProperty $v1a8db4c996d8ed8289da5f957879ab94) {if (!$v1a8db4c996d8ed8289da5f957879ab94->getIsUpdated()) {return false;}$v9ce05738f98a62ccf86dd433f5a9d1a1 = $v1a8db4c996d8ed8289da5f957879ab94->getObject();if ($v9ce05738f98a62ccf86dd433f5a9d1a1 instanceof iUmiObject) {$v9ce05738f98a62ccf86dd433f5a9d1a1->setIsUpdated();$v9ce05738f98a62ccf86dd433f5a9d1a1->loadFields();}$v1a8db4c996d8ed8289da5f957879ab94->commit();return true;}public function clearCache() {$this->properties = [];}public function __destruct() {$this->saveProperties();}public function resetPropertyCache($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00) {$v16b2b26000987faccb260b9d39df1269 = (int) $v16b2b26000987faccb260b9d39df1269;$v972bf3f05d14ffbdb817bef60638ff00 = (string) $v972bf3f05d14ffbdb817bef60638ff00;$v0800fc577294c34e0b28ad2839435945 = $this->getKeyHash($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00);if (isset($this->properties[$v0800fc577294c34e0b28ad2839435945])) {$this->properties[$v0800fc577294c34e0b28ad2839435945] = null;}}private function getKeyHash($v16b2b26000987faccb260b9d39df1269, $v972bf3f05d14ffbdb817bef60638ff00) {return md5($v16b2b26000987faccb260b9d39df1269 . $v972bf3f05d14ffbdb817bef60638ff00);}private function __construct() {$this->umiTypesHelper = umiTypesHelper::getInstance();}private function getFieldIdByName($v972bf3f05d14ffbdb817bef60638ff00, $v5f694956811487225d15e973ca38fbab, $vbd354405a20aa635025421c9edb5d41d = false) {$vd05b6ed7d2345020440df396d6da7f73 = $this->umiTypesHelper->getFieldsByObjectTypeIds($v5f694956811487225d15e973ca38fbab, (bool) $vbd354405a20aa635025421c9edb5d41d);if (isset($vd05b6ed7d2345020440df396d6da7f73[$v5f694956811487225d15e973ca38fbab][$v972bf3f05d14ffbdb817bef60638ff00])) {return (int) $vd05b6ed7d2345020440df396d6da7f73[$v5f694956811487225d15e973ca38fbab][$v972bf3f05d14ffbdb817bef60638ff00];}return null;}}