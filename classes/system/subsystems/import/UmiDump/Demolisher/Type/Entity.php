<?php
 namespace UmiCms\System\Import\UmiDump\Demolisher\Type;use UmiCms\System\Orm\Entity\iExchange;use UmiCms\System\Import\UmiDump\Demolisher;use UmiCms\System\Import\UmiDump\Entity\Helper\SourceIdBinder\iFactory as SourceIdBinderFactory;class Entity extends Demolisher {private $entitySourceIdBinderFactory;private $serviceContainer;private $cmsController;public function __construct(   SourceIdBinderFactory $v0c7638bba668a9e2dc122d86ac59f397,   \iServiceContainer $v06d419f75cbecf6df5a44ea9471105ba,   \iCmsController $v8b1dc169bf460ee884fceef66c6607d6  ) {$this->entitySourceIdBinderFactory = $v0c7638bba668a9e2dc122d86ac59f397;$this->serviceContainer = $v06d419f75cbecf6df5a44ea9471105ba;$this->cmsController = $v8b1dc169bf460ee884fceef66c6607d6;}protected function execute() {$v06d419f75cbecf6df5a44ea9471105ba = $this->getServiceContainer();$v52195dae0174459c5f066fa0df053c26 = $this->getSourceId();$v2e9e616cfa6fcac80260c4715876c85e = $this->getEntitySourceIdBinderFactory()    ->create($v52195dae0174459c5f066fa0df053c26);foreach ($this->getEntityExtIdTree() as $v0f096338b64a1d1b348b86df38313c01 => $v0b24dbdab53b0e996781639ef458b7c7) {$vaaabf0d39951f3e6c3e8a7911df524c2 = $v06d419f75cbecf6df5a44ea9471105ba->get($v0f096338b64a1d1b348b86df38313c01);if ($vaaabf0d39951f3e6c3e8a7911df524c2 instanceof iExchange) {$vaaabf0d39951f3e6c3e8a7911df524c2->demolishByExternalIdList($v0b24dbdab53b0e996781639ef458b7c7, $v2e9e616cfa6fcac80260c4715876c85e);continue;}$vaab9e1de16f38176f86d7a92ba337a8d = $vaaabf0d39951f3e6c3e8a7911df524c2->getMap()->get('EXCHANGE_RELATION_TABLE_NAME');foreach ($v0b24dbdab53b0e996781639ef458b7c7 as $veef97cff20193915dbc12f72ab225db1) {$vb1b26d9d245655a2cf8422f066203b2a = $v2e9e616cfa6fcac80260c4715876c85e->getInternalId($veef97cff20193915dbc12f72ab225db1, $vaab9e1de16f38176f86d7a92ba337a8d);if ($vb1b26d9d245655a2cf8422f066203b2a === null || $v2e9e616cfa6fcac80260c4715876c85e->isRelatedToAnotherSource($veef97cff20193915dbc12f72ab225db1, $vaab9e1de16f38176f86d7a92ba337a8d)) {$this->pushLog(sprintf('Entity "%s" of "%s" was ignored', $veef97cff20193915dbc12f72ab225db1, $v0f096338b64a1d1b348b86df38313c01));continue;}$vaaabf0d39951f3e6c3e8a7911df524c2->delete(['id' => $vb1b26d9d245655a2cf8422f066203b2a]);$this->pushLog(sprintf('Entity "%s" of "%s" was deleted', $vb1b26d9d245655a2cf8422f066203b2a, $v0f096338b64a1d1b348b86df38313c01));}}}private function getEntityExtIdTree() {$result = [];$v8b1dc169bf460ee884fceef66c6607d6 = $this->getCmsController();foreach ($this->parse('/umidump/entities/entity') as $vf5e638cc78dd325906c1298a0c21fb6b) {$vb80bb7740288fda1f201890375a60c8f = $vf5e638cc78dd325906c1298a0c21fb6b->getAttribute('id');$vaaabf0d39951f3e6c3e8a7911df524c2 = $vf5e638cc78dd325906c1298a0c21fb6b->getAttribute('service');if (!$vb80bb7740288fda1f201890375a60c8f || !$vaaabf0d39951f3e6c3e8a7911df524c2) {continue;}$result[$vaaabf0d39951f3e6c3e8a7911df524c2][] = $vb80bb7740288fda1f201890375a60c8f;$v22884db148f0ffb0d830ba431102b0b5 = (string) $vf5e638cc78dd325906c1298a0c21fb6b->getAttribute('module');if (empty($v22884db148f0ffb0d830ba431102b0b5)) {continue;}$v8b1dc169bf460ee884fceef66c6607d6->getModule($v22884db148f0ffb0d830ba431102b0b5);}return $result;}private function getEntitySourceIdBinderFactory() {return $this->entitySourceIdBinderFactory;}private function getServiceContainer() {return $this->serviceContainer;}private function getCmsController() {return $this->cmsController;}}