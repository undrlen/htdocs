<?php
 use \iUmiImportRelations as iBaseSourceIdBinder;use UmiCms\System\Import\UmiDump\Helper\Entity\iSourceIdBinder;class entityImportRelations implements iSourceIdBinder {private $baseSourceIdBinder;private $connection;private $sourceId;const OBJECT_IMPORT_TABLE = 'cms3_import_objects';const TYPE_IMPORT_TABLE = 'cms3_import_types';public function __construct(iBaseSourceIdBinder $vb0b42c0e629ba26f8188e2883dbf5af7,\IConnection $v4717d53ebfdfea8477f780ec66151dcb) {$this->setBaseSourceIdBinder($vb0b42c0e629ba26f8188e2883dbf5af7)    ->setConnection($v4717d53ebfdfea8477f780ec66151dcb);}public function setSourceId($vb80bb7740288fda1f201890375a60c8f) {if (!is_numeric($vb80bb7740288fda1f201890375a60c8f)) {throw new InvalidArgumentException('Source id is not numeric');}$this->sourceId = (int) $vb80bb7740288fda1f201890375a60c8f;return $this;}public function setSourceIdByName($vb068931cc450442b63f5b3d276ea4297) {$vb80bb7740288fda1f201890375a60c8f = $this->getBaseSourceIdBinder()    ->getSourceId($vb068931cc450442b63f5b3d276ea4297);return $this->setSourceId($vb80bb7740288fda1f201890375a60c8f);}public function getSourceId() {return $this->sourceId;}public function defineRelation($v32a9d3c9a4b1449499e182e90d04fcc9, $v1c043be0eed6949c174fcf4359f7c601, $vaab9e1de16f38176f86d7a92ba337a8d) {$vb0b42c0e629ba26f8188e2883dbf5af7 = $this->getBaseSourceIdBinder();$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();switch ($vaab9e1de16f38176f86d7a92ba337a8d) {case self::OBJECT_IMPORT_TABLE : {$vb0b42c0e629ba26f8188e2883dbf5af7->setObjectIdRelation($v52195dae0174459c5f066fa0df053c26, $v32a9d3c9a4b1449499e182e90d04fcc9, $v1c043be0eed6949c174fcf4359f7c601);return $this;}case self::TYPE_IMPORT_TABLE : {$vb0b42c0e629ba26f8188e2883dbf5af7->setTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v32a9d3c9a4b1449499e182e90d04fcc9, $v1c043be0eed6949c174fcf4359f7c601);return $this;}}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v32a9d3c9a4b1449499e182e90d04fcc9 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v32a9d3c9a4b1449499e182e90d04fcc9);$v1c043be0eed6949c174fcf4359f7c601 = (int) $v1c043be0eed6949c174fcf4359f7c601;$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `{$vaab9e1de16f38176f86d7a92ba337a8d}`
	(`external_id`, `internal_id`, `source_id`) VALUES
	('$v32a9d3c9a4b1449499e182e90d04fcc9', $v1c043be0eed6949c174fcf4359f7c601, $v52195dae0174459c5f066fa0df053c26)
SQL;   $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);return $this;}public function defineRelationList(array $v8f860260e98c7b73cb53d4d3eba7f7f8, $vaab9e1de16f38176f86d7a92ba337a8d) {foreach ($v8f860260e98c7b73cb53d4d3eba7f7f8 as $v32a9d3c9a4b1449499e182e90d04fcc9 => $v1c043be0eed6949c174fcf4359f7c601) {$this->defineRelation($v32a9d3c9a4b1449499e182e90d04fcc9, $v1c043be0eed6949c174fcf4359f7c601, $vaab9e1de16f38176f86d7a92ba337a8d);}return $this;}public function getInternalId($v32a9d3c9a4b1449499e182e90d04fcc9, $vaab9e1de16f38176f86d7a92ba337a8d) {$vb0b42c0e629ba26f8188e2883dbf5af7 = $this->getBaseSourceIdBinder();$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();switch ($vaab9e1de16f38176f86d7a92ba337a8d) {case self::OBJECT_IMPORT_TABLE : {return $vb0b42c0e629ba26f8188e2883dbf5af7->getNewObjectIdRelation($v52195dae0174459c5f066fa0df053c26, $v32a9d3c9a4b1449499e182e90d04fcc9);}case self::TYPE_IMPORT_TABLE : {return $vb0b42c0e629ba26f8188e2883dbf5af7->getNewTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v32a9d3c9a4b1449499e182e90d04fcc9);}}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v32a9d3c9a4b1449499e182e90d04fcc9 = $v4717d53ebfdfea8477f780ec66151dcb->escape($v32a9d3c9a4b1449499e182e90d04fcc9);$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `internal_id`
FROM `{$vaab9e1de16f38176f86d7a92ba337a8d}`
WHERE
	`external_id` = '$v32a9d3c9a4b1449499e182e90d04fcc9' AND `source_id` = $v52195dae0174459c5f066fa0df053c26
LIMIT 0,1
SQL;   $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v1c043be0eed6949c174fcf4359f7c601 = null;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v1c043be0eed6949c174fcf4359f7c601 = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}return $v1c043be0eed6949c174fcf4359f7c601;}public function getExternalId($v1c043be0eed6949c174fcf4359f7c601, $vaab9e1de16f38176f86d7a92ba337a8d) {$vb0b42c0e629ba26f8188e2883dbf5af7 = $this->getBaseSourceIdBinder();$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();switch ($vaab9e1de16f38176f86d7a92ba337a8d) {case self::OBJECT_IMPORT_TABLE : {return $vb0b42c0e629ba26f8188e2883dbf5af7->getOldObjectIdRelation($v52195dae0174459c5f066fa0df053c26, $v1c043be0eed6949c174fcf4359f7c601);}case self::TYPE_IMPORT_TABLE : {return $vb0b42c0e629ba26f8188e2883dbf5af7->getOldTypeIdRelation($v52195dae0174459c5f066fa0df053c26, $v1c043be0eed6949c174fcf4359f7c601);}}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v1c043be0eed6949c174fcf4359f7c601 = (int) $v1c043be0eed6949c174fcf4359f7c601;$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `external_id`
FROM `{$vaab9e1de16f38176f86d7a92ba337a8d}`
WHERE `internal_id` = $v1c043be0eed6949c174fcf4359f7c601 AND `source_id` = $v52195dae0174459c5f066fa0df053c26
LIMIT 0,1
SQL;   $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v32a9d3c9a4b1449499e182e90d04fcc9 = null;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v32a9d3c9a4b1449499e182e90d04fcc9 = (string) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}return $v32a9d3c9a4b1449499e182e90d04fcc9;}public function getExternalIdList(array $v689f9b0d90e82b15fbd75db891fc65b5, $vaab9e1de16f38176f86d7a92ba337a8d) {$v689f9b0d90e82b15fbd75db891fc65b5 = array_filter($v689f9b0d90e82b15fbd75db891fc65b5, function($v32a9d3c9a4b1449499e182e90d04fcc9) {return is_numeric($v32a9d3c9a4b1449499e182e90d04fcc9);});if (isEmptyArray($v689f9b0d90e82b15fbd75db891fc65b5)) {return [];}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$v689f9b0d90e82b15fbd75db891fc65b5 = array_map('intval', $v689f9b0d90e82b15fbd75db891fc65b5);$v9ecb406b1bbb49e4c3dea52dc787d708 = count($v689f9b0d90e82b15fbd75db891fc65b5);$v689f9b0d90e82b15fbd75db891fc65b5 = implode(', ', $v689f9b0d90e82b15fbd75db891fc65b5);$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `internal_id`, `external_id`
FROM `{$vaab9e1de16f38176f86d7a92ba337a8d}`
WHERE `internal_id` IN ($v689f9b0d90e82b15fbd75db891fc65b5) AND `source_id` = $v52195dae0174459c5f066fa0df053c26
LIMIT 0, $v9ecb406b1bbb49e4c3dea52dc787d708
SQL;   $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a)    ->setFetchArray();$ve7143c35e910d05210552bcc5b236bc8 = [];foreach ($result as list($v1c043be0eed6949c174fcf4359f7c601, $v32a9d3c9a4b1449499e182e90d04fcc9)) {$ve7143c35e910d05210552bcc5b236bc8[(int) $v1c043be0eed6949c174fcf4359f7c601] = (string) $v32a9d3c9a4b1449499e182e90d04fcc9;}return $ve7143c35e910d05210552bcc5b236bc8;}public function getInternalIdList(array $ve7143c35e910d05210552bcc5b236bc8, $vaab9e1de16f38176f86d7a92ba337a8d) {$ve7143c35e910d05210552bcc5b236bc8 = array_filter($ve7143c35e910d05210552bcc5b236bc8, function($v32a9d3c9a4b1449499e182e90d04fcc9) {return (is_numeric($v32a9d3c9a4b1449499e182e90d04fcc9) || is_string($v32a9d3c9a4b1449499e182e90d04fcc9));});if (isEmptyArray($ve7143c35e910d05210552bcc5b236bc8)) {return [];}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$ve7143c35e910d05210552bcc5b236bc8 = array_map([$v4717d53ebfdfea8477f780ec66151dcb, 'escape'], $ve7143c35e910d05210552bcc5b236bc8);$v436e747b14bd62ab16757e04b407e1fb = count($ve7143c35e910d05210552bcc5b236bc8);$ve7143c35e910d05210552bcc5b236bc8 = implode('", "', $ve7143c35e910d05210552bcc5b236bc8);$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `external_id`, `internal_id`
FROM `{$vaab9e1de16f38176f86d7a92ba337a8d}`
WHERE `external_id` IN ("$ve7143c35e910d05210552bcc5b236bc8") AND `source_id` = $v52195dae0174459c5f066fa0df053c26
LIMIT 0, $v436e747b14bd62ab16757e04b407e1fb
SQL;   $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a)    ->setFetchArray();$v689f9b0d90e82b15fbd75db891fc65b5 = [];foreach ($result as list($v32a9d3c9a4b1449499e182e90d04fcc9, $v1c043be0eed6949c174fcf4359f7c601)) {$v689f9b0d90e82b15fbd75db891fc65b5[(string) $v32a9d3c9a4b1449499e182e90d04fcc9] = (int) $v1c043be0eed6949c174fcf4359f7c601;}return $v689f9b0d90e82b15fbd75db891fc65b5;}public function isRelatedToAnotherSource($v1c043be0eed6949c174fcf4359f7c601, $vaab9e1de16f38176f86d7a92ba337a8d) {$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v1c043be0eed6949c174fcf4359f7c601 = (int) $v1c043be0eed6949c174fcf4359f7c601;$vaab9e1de16f38176f86d7a92ba337a8d = $v4717d53ebfdfea8477f780ec66151dcb->escape($vaab9e1de16f38176f86d7a92ba337a8d);$v52195dae0174459c5f066fa0df053c26 = (int) $this->getSourceId();if (!$vaab9e1de16f38176f86d7a92ba337a8d) {throw new InvalidArgumentException('Empty table');}$v8bc4403642c02217dc1341694acb244d = <<<SQL
SELECT `external_id` FROM `{$vaab9e1de16f38176f86d7a92ba337a8d}` 
	WHERE `source_id` != $v52195dae0174459c5f066fa0df053c26 AND `internal_id` = $v1c043be0eed6949c174fcf4359f7c601 LIMIT 0,1
SQL;   $result = ConnectionPool::getInstance()    ->getConnection()    ->queryResult($v8bc4403642c02217dc1341694acb244d);return $result->length() > 0;}private function setBaseSourceIdBinder(iBaseSourceIdBinder $vb0b42c0e629ba26f8188e2883dbf5af7) {$this->baseSourceIdBinder = $vb0b42c0e629ba26f8188e2883dbf5af7;return $this;}private function getBaseSourceIdBinder() {return $this->baseSourceIdBinder;}private function setConnection(\IConnection $v4717d53ebfdfea8477f780ec66151dcb) {$this->connection = $v4717d53ebfdfea8477f780ec66151dcb;return $this;}private function getConnection() {return $this->connection;}}