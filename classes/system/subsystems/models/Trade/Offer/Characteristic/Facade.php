<?php
 namespace UmiCms\System\Trade\Offer\Characteristic;use \iUmiField as iField;use \iUmiObject as iObject;use \iUmiObjectType as iType;use UmiCms\System\Trade\iOffer;use \iUmiFieldsCollection as iFieldFacade;use UmiCms\System\Trade\Offer\iCharacteristic;use UmiCms\System\Trade\Offer\iCollection as iOfferCollection;use UmiCms\System\Trade\Offer\Data\Object\iFacade as iObjectFacade;use UmiCms\System\Trade\Offer\Data\Object\Type\iFacade as iTypeFacade;class Facade implements iFacade {private $mapper;private $factory;private $collection;private $objectFacade;private $typeFacade;private $fieldFacade;public function __construct(   iMapper $v4b9f83e1257a95912768124924dfb143,   iFactory $v9549dd6065d019211460c59a86dd6536,   iCollection $vdb6d9b451b818ccc9a449383f2f0c450,   iObjectFacade $v51bee6c1b54168126341d69a43ba7429,   iTypeFacade $v585be0ab2e7b8c75397b0d047a05925d,   iFieldFacade $v969e0d0aa5b99693e1ae32cdad5fae68  ) {$this->mapper = $v4b9f83e1257a95912768124924dfb143;$this->factory = $v9549dd6065d019211460c59a86dd6536;$this->collection = $vdb6d9b451b818ccc9a449383f2f0c450;$this->objectFacade = $v51bee6c1b54168126341d69a43ba7429;$this->typeFacade = $v585be0ab2e7b8c75397b0d047a05925d;$this->fieldFacade = $v969e0d0aa5b99693e1ae32cdad5fae68;}public function getCollectionByType($vb80bb7740288fda1f201890375a60c8f) {$v87bb51cac5cc8eef09d03a7e239fb88a = $this->createCharacteristicListByType($vb80bb7740288fda1f201890375a60c8f);return $this->mapCollection($v87bb51cac5cc8eef09d03a7e239fb88a);}public function getCollectionByOffer(iOffer $vd60db28d94d538bbb249dcc7f2273ab1) {$v87bb51cac5cc8eef09d03a7e239fb88a = $this->createCharacteristicListByOffer($vd60db28d94d538bbb249dcc7f2273ab1);return $this->mapCollection($v87bb51cac5cc8eef09d03a7e239fb88a);}public function getCollectionByOfferCollection(iOfferCollection $v88e7cfe492fabe5dee74e274b6284bc5) {$v5002604882bd0eee21913983f62b2f86 = $v88e7cfe492fabe5dee74e274b6284bc5->extractDataObjectId();$this->getObjectFacade()->getList($v5002604882bd0eee21913983f62b2f86);\umiObjectProperty::loadPropsData($v5002604882bd0eee21913983f62b2f86);$v87bb51cac5cc8eef09d03a7e239fb88a = [];foreach ($v88e7cfe492fabe5dee74e274b6284bc5 as $vd60db28d94d538bbb249dcc7f2273ab1) {foreach ($this->createCharacteristicListByOffer($vd60db28d94d538bbb249dcc7f2273ab1) as $va2de09ab89f499d81b112f5ac9af3e2c) {$v87bb51cac5cc8eef09d03a7e239fb88a[] = $va2de09ab89f499d81b112f5ac9af3e2c;}}return $this->mapCollection($v87bb51cac5cc8eef09d03a7e239fb88a);}public function createByOfferAndField(iOffer $vd60db28d94d538bbb249dcc7f2273ab1, iField $v06e3d36fa30cea095545139854ad1fb9) {$va2de09ab89f499d81b112f5ac9af3e2c = $this->getFactory()    ->create($v06e3d36fa30cea095545139854ad1fb9);if ($vd60db28d94d538bbb249dcc7f2273ab1->hasDataObjectId()) {$v7beebf4251f2ace3d8e03527fe1bf86e = $this->getObject($vd60db28d94d538bbb249dcc7f2273ab1->getDataObjectId());}else {$v7beebf4251f2ace3d8e03527fe1bf86e = $this->createObject($vd60db28d94d538bbb249dcc7f2273ab1);}return $va2de09ab89f499d81b112f5ac9af3e2c->setDataObject($v7beebf4251f2ace3d8e03527fe1bf86e);}public function createByOfferAndFieldName(iOffer $vd60db28d94d538bbb249dcc7f2273ab1, $vb068931cc450442b63f5b3d276ea4297) {$vb80bb7740288fda1f201890375a60c8f = $this->getTypeFacade()    ->get($vd60db28d94d538bbb249dcc7f2273ab1->getTypeId())    ->getFieldId($vb068931cc450442b63f5b3d276ea4297);$v06e3d36fa30cea095545139854ad1fb9 = $this->getFieldFacade()    ->getById($vb80bb7740288fda1f201890375a60c8f);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iField) {throw new \ExpectFieldException(sprintf('Incorrect field name "%s" given.', $v06e3d36fa30cea095545139854ad1fb9));}return $this->createByOfferAndField($vd60db28d94d538bbb249dcc7f2273ab1, $v06e3d36fa30cea095545139854ad1fb9);}public function mapCollection(array $v87bb51cac5cc8eef09d03a7e239fb88a) {$vdb6d9b451b818ccc9a449383f2f0c450 = clone $this->getCollection();return $vdb6d9b451b818ccc9a449383f2f0c450->pushList($v87bb51cac5cc8eef09d03a7e239fb88a);}private function createCharacteristicListByType($vb80bb7740288fda1f201890375a60c8f) {$v599dcce2998a6b40b1e38e8c6006cb0a = $this->getType($vb80bb7740288fda1f201890375a60c8f);$v69fe4aec8073954bf273e3113edd24cf = $this->getFieldList($v599dcce2998a6b40b1e38e8c6006cb0a);return $this->getFactory()    ->createList($v69fe4aec8073954bf273e3113edd24cf);}private function createCharacteristicListByOffer(iOffer $vd60db28d94d538bbb249dcc7f2273ab1) {if (!$vd60db28d94d538bbb249dcc7f2273ab1->hasDataObjectId()) {return [];}$v87bb51cac5cc8eef09d03a7e239fb88a = $this->createCharacteristicListByType($vd60db28d94d538bbb249dcc7f2273ab1->getTypeId());foreach ($v87bb51cac5cc8eef09d03a7e239fb88a as $va2de09ab89f499d81b112f5ac9af3e2c) {$v7beebf4251f2ace3d8e03527fe1bf86e = $this->getObject($vd60db28d94d538bbb249dcc7f2273ab1->getDataObjectId());$va2de09ab89f499d81b112f5ac9af3e2c->setDataObject($v7beebf4251f2ace3d8e03527fe1bf86e);}return $v87bb51cac5cc8eef09d03a7e239fb88a;}private function getType($vb80bb7740288fda1f201890375a60c8f) {$v599dcce2998a6b40b1e38e8c6006cb0a = $this->getTypeFacade()    ->get($vb80bb7740288fda1f201890375a60c8f);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof iType) {throw new \expectObjectTypeException('Incorrect offer type id given');}return $v599dcce2998a6b40b1e38e8c6006cb0a;}private function getObject($vb80bb7740288fda1f201890375a60c8f) {$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObjectFacade()    ->get($vb80bb7740288fda1f201890375a60c8f);if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof iObject) {throw new \expectObjectException('Incorrect offer data object id given');}return $va8cfde6331bd59eb2ac96f8911c4b666;}private function createObject(iOffer $vd60db28d94d538bbb249dcc7f2273ab1) {$va8cfde6331bd59eb2ac96f8911c4b666 = $this->getObjectFacade()    ->createByOffer($vd60db28d94d538bbb249dcc7f2273ab1);$vd60db28d94d538bbb249dcc7f2273ab1->setDataObjectId($va8cfde6331bd59eb2ac96f8911c4b666->getId());return $va8cfde6331bd59eb2ac96f8911c4b666;}private function getFieldList(iType $v599dcce2998a6b40b1e38e8c6006cb0a) {$v69fe4aec8073954bf273e3113edd24cf = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldListFromGroup(self::GROUP_NAME);$this->getFieldFacade()    ->filterListByNameBlackList($v69fe4aec8073954bf273e3113edd24cf, [self::OFFER_LIST_FIELD_NAME])    ->filterListByTypeWhiteList($v69fe4aec8073954bf273e3113edd24cf, self::FIELD_TYPE_WHITE_LIST);return $v69fe4aec8073954bf273e3113edd24cf;}public function getMapper() {return $this->mapper;}private function getFactory() {return $this->factory;}private function getCollection() {return $this->collection;}private function getObjectFacade() {return $this->objectFacade;}private function getTypeFacade() {return $this->typeFacade;}private function getFieldFacade() {return $this->fieldFacade;}}