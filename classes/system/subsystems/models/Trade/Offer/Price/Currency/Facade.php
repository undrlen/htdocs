<?php
 namespace UmiCms\System\Trade\Offer\Price\Currency;use UmiCms\System\Trade\Offer\Price\iCurrency;use UmiCms\System\Trade\Offer\Price\Currency\Favorite\iFacade as iFavoriteCurrencyFacade;class Facade implements iFacade {private $repository;private $collection;private $configuration;private $calculator;private $favoriteCurrencyFacade;public function __construct(   iRepository $vb3f2035551f6e48c67489ace9f588f94,   iCollection $vdb6d9b451b818ccc9a449383f2f0c450,   \iConfiguration $vccd1066343c95877b75b79d47c36bebe,   iCalculator $v4880766485de7821db13940395a913c8,   iFavoriteCurrencyFacade $vad42882b458af28232394d1801c5339c  ) {$this->repository = $vb3f2035551f6e48c67489ace9f588f94;$this->collection = $vdb6d9b451b818ccc9a449383f2f0c450;$this->configuration = $vccd1066343c95877b75b79d47c36bebe;$this->calculator = $v4880766485de7821db13940395a913c8;$this->favoriteCurrencyFacade = $vad42882b458af28232394d1801c5339c;}public function getList() {return $this->getCollection()    ->getAll();}public function getDefault() {$vd7ba92827bb4469e316728c16201e1b9 = (string) $this->getConfiguration()    ->get('system', 'default-currency');if (!$vd7ba92827bb4469e316728c16201e1b9) {throw new \coreException('Default currency is not defined (system.default-currency)');}return $this->getByCode($vd7ba92827bb4469e316728c16201e1b9);}public function setDefault(iCurrency $v1af0389838508d7016a9841eb6273962) {$vccd1066343c95877b75b79d47c36bebe = $this->getConfiguration();$vccd1066343c95877b75b79d47c36bebe->set('system', 'default-currency', $v1af0389838508d7016a9841eb6273962->getCode());$vccd1066343c95877b75b79d47c36bebe->save();return $this;}public function isDefault(iCurrency $v1af0389838508d7016a9841eb6273962) {return $this->getDefault()->getId() === $v1af0389838508d7016a9841eb6273962->getId();}public function getCurrent() {$vb80bb7740288fda1f201890375a60c8f = $this->getUserCurrencyId();$v1af0389838508d7016a9841eb6273962 = $this->getRepository()    ->get($vb80bb7740288fda1f201890375a60c8f);if ($v1af0389838508d7016a9841eb6273962 instanceof iCurrency) {return $v1af0389838508d7016a9841eb6273962;}return $this->getDefault();}public function setCurrent(iCurrency $v1af0389838508d7016a9841eb6273962) {return $this->setUserCurrencyId($v1af0389838508d7016a9841eb6273962->getId());}public function isCurrent(iCurrency $v1af0389838508d7016a9841eb6273962) {return $this->getCurrent()->getId() === $v1af0389838508d7016a9841eb6273962->getId();}public function getByCode($vc13367945d5d4c91047b3b50234aa7ab) {return $this->getCollection()    ->getBy(iCurrency::CODE, $vc13367945d5d4c91047b3b50234aa7ab);}public function get($vb80bb7740288fda1f201890375a60c8f) {return $this->getCollection()    ->getBy(iCurrency::ID, $vb80bb7740288fda1f201890375a60c8f);}public function save(iCurrency $v1af0389838508d7016a9841eb6273962) {$this->getRepository()    ->save($v1af0389838508d7016a9841eb6273962);return $this;}public function calculate($v78a5eb43deef9a7b5b9ce157b9d52ac4, iCurrency $vd98a07f84921b24ee30f86fd8cd85c3c = null, iCurrency $v01b6e20344b68835c5ed1ddedf20d531 = null) {$vd98a07f84921b24ee30f86fd8cd85c3c = $vd98a07f84921b24ee30f86fd8cd85c3c ?: $this->getDefault();$v01b6e20344b68835c5ed1ddedf20d531 = $v01b6e20344b68835c5ed1ddedf20d531 ?: $this->getCurrent();return $this->getCalculator()    ->calculate($v78a5eb43deef9a7b5b9ce157b9d52ac4, $vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531);}public function reload() {$vdb6d9b451b818ccc9a449383f2f0c450 = $this->getCollection();foreach ($vdb6d9b451b818ccc9a449383f2f0c450->getAll() as $v1af0389838508d7016a9841eb6273962) {$vdb6d9b451b818ccc9a449383f2f0c450->unload($v1af0389838508d7016a9841eb6273962->getId());}return $this->fillCollection($vdb6d9b451b818ccc9a449383f2f0c450);}private function getUserCurrencyId() {return $this->getFavoriteCurrencyFacade()->getId();}private function setUserCurrencyId($vb80bb7740288fda1f201890375a60c8f) {$this->getFavoriteCurrencyFacade()->setId($vb80bb7740288fda1f201890375a60c8f);return $this;}private function getRepository() {return $this->repository;}private function getCollection() {$vdb6d9b451b818ccc9a449383f2f0c450 = $this->collection;$vd4800b2094077e3751d7ea14924de3bb = $vdb6d9b451b818ccc9a449383f2f0c450->getAll();if (empty($vd4800b2094077e3751d7ea14924de3bb)) {$this->fillCollection($vdb6d9b451b818ccc9a449383f2f0c450);}return $this->collection;}private function fillCollection(iCollection $vdb6d9b451b818ccc9a449383f2f0c450) {$vd4800b2094077e3751d7ea14924de3bb = $this->getRepository()    ->getAll();$vdb6d9b451b818ccc9a449383f2f0c450->loadList($vd4800b2094077e3751d7ea14924de3bb);return $this;}private function getConfiguration() {return $this->configuration;}private function getCalculator() {return $this->calculator;}private function getFavoriteCurrencyFacade() {return $this->favoriteCurrencyFacade;}}