<?php
 namespace UmiCms\System\Trade\Offer\Price\Type;use UmiCms\System\Orm\iEntity;use UmiCms\System\Trade\Offer\Price\iType;use UmiCms\System\Orm\Entity\Facade as AbstractFacade;class Facade extends AbstractFacade implements iFacade {public function getByName($vb068931cc450442b63f5b3d276ea4297) {$ve6e5fc8c1fac6501272dcef911033278 = $this->getListBy(iMapper::NAME, $vb068931cc450442b63f5b3d276ea4297);return array_shift($ve6e5fc8c1fac6501272dcef911033278);}public function create(array $v6dd047148d685270458ecc44ee128a4d = []) {if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::NAME])) {throw new \ErrorException('Price type name expected');}if (!isset($v6dd047148d685270458ecc44ee128a4d[iMapper::TITLE])) {throw new \ErrorException('Price type title expected');}if ($this->getDefault() instanceof iType) {unset($v6dd047148d685270458ecc44ee128a4d[iMapper::IS_DEFAULT]);}return parent::create($v6dd047148d685270458ecc44ee128a4d);}public function save(iEntity $vf5e638cc78dd325906c1298a0c21fb6b) {if (!$this->isValidEntity($vf5e638cc78dd325906c1298a0c21fb6b)) {throw new \ErrorException('Incorrect entity given');}$vceb9d9b685e907a75121813f4867fda2 = $this->getDefault();if ($vceb9d9b685e907a75121813f4867fda2 instanceof iType && $vf5e638cc78dd325906c1298a0c21fb6b->isDefault() && $vceb9d9b685e907a75121813f4867fda2->getId() !== $vf5e638cc78dd325906c1298a0c21fb6b->getId()) {$vf5e638cc78dd325906c1298a0c21fb6b->setDefault(false);}return parent::save($vf5e638cc78dd325906c1298a0c21fb6b);}public function copy(iEntity $v36cd38f49b9afa08222c0dc9ebfe35eb) {$v6dd047148d685270458ecc44ee128a4d = $this->extractAttributeList($v36cd38f49b9afa08222c0dc9ebfe35eb);unset($v6dd047148d685270458ecc44ee128a4d[iMapper::ID]);if ($v36cd38f49b9afa08222c0dc9ebfe35eb->isDefault()) {unset($v6dd047148d685270458ecc44ee128a4d[iMapper::IS_DEFAULT]);}$vc1817d3248c7e7289e60f693f5679098 = sprintf('name_%d', rand());$v6dd047148d685270458ecc44ee128a4d[iMapper::NAME] = $vc1817d3248c7e7289e60f693f5679098;return $this->create($v6dd047148d685270458ecc44ee128a4d);}public function delete($vb80bb7740288fda1f201890375a60c8f) {$v6fd8ccca00cb036a3909204ffc7bc5f9 = $this->getDefault();if ($v6fd8ccca00cb036a3909204ffc7bc5f9 instanceof iType && $v6fd8ccca00cb036a3909204ffc7bc5f9->getId() == $vb80bb7740288fda1f201890375a60c8f) {return $this;}return parent::delete($vb80bb7740288fda1f201890375a60c8f);}public function deleteList(array $v5a2576254d428ddc22a03fac145c8749) {$v6fd8ccca00cb036a3909204ffc7bc5f9 = $this->getDefault();if ($v6fd8ccca00cb036a3909204ffc7bc5f9 instanceof iType) {$v5a2576254d428ddc22a03fac145c8749 = array_filter($v5a2576254d428ddc22a03fac145c8749, function($vb80bb7740288fda1f201890375a60c8f) use ($v6fd8ccca00cb036a3909204ffc7bc5f9) {return $vb80bb7740288fda1f201890375a60c8f != $v6fd8ccca00cb036a3909204ffc7bc5f9->getId();});}return parent::deleteList($v5a2576254d428ddc22a03fac145c8749);}public function getDefault() {$ve6e5fc8c1fac6501272dcef911033278 = $this->getListBy(iMapper::IS_DEFAULT, true);return array_shift($ve6e5fc8c1fac6501272dcef911033278);}public function setDefault(iType $v599dcce2998a6b40b1e38e8c6006cb0a) {$ve6e5fc8c1fac6501272dcef911033278 = $this->getListBy(iMapper::IS_DEFAULT, true);$vb3f2035551f6e48c67489ace9f588f94 = $this->getRepository();foreach ($ve6e5fc8c1fac6501272dcef911033278 as $v6fd8ccca00cb036a3909204ffc7bc5f9) {$v6fd8ccca00cb036a3909204ffc7bc5f9->setDefault(false);$vb3f2035551f6e48c67489ace9f588f94->save($v6fd8ccca00cb036a3909204ffc7bc5f9);}$v599dcce2998a6b40b1e38e8c6006cb0a->setDefault();return $vb3f2035551f6e48c67489ace9f588f94->save($v599dcce2998a6b40b1e38e8c6006cb0a);}protected function isValidEntity($vf5e638cc78dd325906c1298a0c21fb6b) {return $vf5e638cc78dd325906c1298a0c21fb6b instanceof iType;}}