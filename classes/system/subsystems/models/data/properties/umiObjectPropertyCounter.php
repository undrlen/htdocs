<?php
 class umiObjectPropertyCounter extends umiObjectProperty {protected $oldValue;protected function loadValue() {$v945100186b119048837b9859c2c46410 = $this->field_id;$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v80071f37861c360a27b7327e132c911a = $this->getTableName();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT cnt FROM $v80071f37861c360a27b7327e132c911a WHERE obj_id = '{$this->object_id}' AND field_id = '{$v945100186b119048837b9859c2c46410}' LIMIT 1";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v2817f701d5e1a1181e657251363295fd = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v2817f701d5e1a1181e657251363295fd = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}$this->oldValue = $v2817f701d5e1a1181e657251363295fd;return [$v2817f701d5e1a1181e657251363295fd];}protected function saveValue() {$v2063c1608d6e0baf80249c42e2be5804 = umiCount($this->value) ? (int) $this->value[0] : 0;$v945f3fc449518a73b9f5f32868db466c = $v2063c1608d6e0baf80249c42e2be5804 - $this->oldValue;$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v80071f37861c360a27b7327e132c911a = $this->getTableName();if ((abs($v945f3fc449518a73b9f5f32868db466c) == 1) && $v2063c1608d6e0baf80249c42e2be5804 !== 0 && $this->oldValue) {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
UPDATE $v80071f37861c360a27b7327e132c911a SET cnt = cnt + ({$v945f3fc449518a73b9f5f32868db466c})
WHERE obj_id = '{$this->object_id}' AND field_id = '{$this->field_id}'
SQL;    try {$v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);}catch (databaseException $ve1671797c52e15f763380b45e841ec32) {throw $ve1671797c52e15f763380b45e841ec32;}}else {$this->deleteCurrentRows();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO $v80071f37861c360a27b7327e132c911a (obj_id, field_id, cnt)
VALUES('{$this->object_id}', '{$this->field_id}', '{$v2063c1608d6e0baf80249c42e2be5804}')
SQL;    $v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);}}protected function isNeedToSave(array $v7f7cfde5ec586119b48911a2c75851e5) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = $this->value;if (isset($v0382b9fd9ef50b6a335f35e0aaaebf99[0])) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = (int) $v0382b9fd9ef50b6a335f35e0aaaebf99[0];}else {$v0382b9fd9ef50b6a335f35e0aaaebf99 = 0;}if (isset($v7f7cfde5ec586119b48911a2c75851e5[0])) {$v7f7cfde5ec586119b48911a2c75851e5 = (int) $v7f7cfde5ec586119b48911a2c75851e5[0];}else {$v7f7cfde5ec586119b48911a2c75851e5 = 0;}return $v0382b9fd9ef50b6a335f35e0aaaebf99 !== $v7f7cfde5ec586119b48911a2c75851e5;}}