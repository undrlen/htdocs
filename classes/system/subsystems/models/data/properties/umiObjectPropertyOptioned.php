<?php
 class umiObjectPropertyOptioned extends umiObjectProperty {protected function loadValue() {$vf09cc7ee3a9a93273f4b80601cafb00c = [];$v8d777f385d3dfec8815d20f7496026dc = $this->getPropData();$v80071f37861c360a27b7327e132c911a = $this->getTableName();if (!$v8d777f385d3dfec8815d20f7496026dc) {$v8d777f385d3dfec8815d20f7496026dc = [];$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT int_val, varchar_val, text_val, rel_val, tree_val, float_val
FROM {$v80071f37861c360a27b7327e132c911a}
WHERE obj_id = '{$this->object_id}' AND field_id = '{$this->field_id}'
SQL;    $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ASSOC);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {foreach ($vf1965a857bc285d26fe22023aa5ab50d as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v8d777f385d3dfec8815d20f7496026dc[$v865c0c0b4ab0e063e5caa3387c1a8741][] = $v9e3669d19b675bd57058fd4664205d2a;}}}$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;while ($v2063c1608d6e0baf80249c42e2be5804 = $this->parsePropData($v8d777f385d3dfec8815d20f7496026dc, $v865c0c0b4ab0e063e5caa3387c1a8741)) {foreach ($v2063c1608d6e0baf80249c42e2be5804 as $ve358efa489f58062f10dd7316b65649e => $v9e3669d19b675bd57058fd4664205d2a) {$v2063c1608d6e0baf80249c42e2be5804[$ve358efa489f58062f10dd7316b65649e] = ($ve358efa489f58062f10dd7316b65649e == 'float') ? $this->filterFloat($v9e3669d19b675bd57058fd4664205d2a) : $v9e3669d19b675bd57058fd4664205d2a;}$vf09cc7ee3a9a93273f4b80601cafb00c[] = $v2063c1608d6e0baf80249c42e2be5804;$v865c0c0b4ab0e063e5caa3387c1a8741++;}return $vf09cc7ee3a9a93273f4b80601cafb00c;}public function setValue($v2063c1608d6e0baf80249c42e2be5804) {if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = array_distinct($v2063c1608d6e0baf80249c42e2be5804);}parent::setValue($v2063c1608d6e0baf80249c42e2be5804);}protected function saveValue() {$this->deleteCurrentRows();$v80071f37861c360a27b7327e132c911a = $this->getTableName();$v1b1cc7f086b3f074da452bc3129981eb = <<<SQL
INSERT INTO `$v80071f37861c360a27b7327e132c911a` (`obj_id`, `field_id`, `int_val`, `varchar_val`, `text_val`, `rel_val`, `tree_val`, `float_val`) VALUES
SQL;   $v16b2b26000987faccb260b9d39df1269 = (int) $this->getObjectId();$v945100186b119048837b9859c2c46410 = (int) $this->getFieldId();foreach ($this->value as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v8d777f385d3dfec8815d20f7496026dc) {$v371634fb16ef3b36985bf6399b678417 = '';$v2817f701d5e1a1181e657251363295fd = 0;$v481f44389b52d587646c4a792551b4dc = (int) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'int');if ($v481f44389b52d587646c4a792551b4dc) {$v371634fb16ef3b36985bf6399b678417 .= "'{$v481f44389b52d587646c4a792551b4dc}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL, ';}$v32f5f5d74be991e6f2147a3dce8f7c4a = (string) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'varchar');if ($v32f5f5d74be991e6f2147a3dce8f7c4a) {$v32f5f5d74be991e6f2147a3dce8f7c4a = self::filterInputString($v32f5f5d74be991e6f2147a3dce8f7c4a);$v32f5f5d74be991e6f2147a3dce8f7c4a = preg_replace('/([\x00-\x1F])/', '', $v32f5f5d74be991e6f2147a3dce8f7c4a);$v371634fb16ef3b36985bf6399b678417 .= "'{$v32f5f5d74be991e6f2147a3dce8f7c4a}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL, ';}$v13c85bffde81f0ccd1e2a8efc84e25e2 = (string) getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'text');if ($v13c85bffde81f0ccd1e2a8efc84e25e2) {$v13c85bffde81f0ccd1e2a8efc84e25e2 = self::filterInputString($v13c85bffde81f0ccd1e2a8efc84e25e2);$v13c85bffde81f0ccd1e2a8efc84e25e2 = preg_replace('/([\x01-\x08]|[\x0B-\x0C]|[\x0E-\x1F])/', '', $v13c85bffde81f0ccd1e2a8efc84e25e2);$v371634fb16ef3b36985bf6399b678417 .= "'{$v13c85bffde81f0ccd1e2a8efc84e25e2}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL, ';}$va3c2d20026816e57d6022b2034f48e88 = (int) $this->prepareRelationValue(getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'rel'));if ($va3c2d20026816e57d6022b2034f48e88) {$v371634fb16ef3b36985bf6399b678417 .= "'{$va3c2d20026816e57d6022b2034f48e88}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL, ';}$vfec328f17e29d6639c673223e83cdac4 = (int) $this->extractTreeValue($v8d777f385d3dfec8815d20f7496026dc);if ($vfec328f17e29d6639c673223e83cdac4) {$v371634fb16ef3b36985bf6399b678417 .= "'{$vfec328f17e29d6639c673223e83cdac4}', ";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL, ';}$v9ec90e82509332a2d6e51de04dbbe788 = getArrayKey($v8d777f385d3dfec8815d20f7496026dc, 'float');if (is_numeric($v9ec90e82509332a2d6e51de04dbbe788)) {$v9ec90e82509332a2d6e51de04dbbe788 = (float) $v9ec90e82509332a2d6e51de04dbbe788;$v371634fb16ef3b36985bf6399b678417 .= "'{$v9ec90e82509332a2d6e51de04dbbe788}'";++$v2817f701d5e1a1181e657251363295fd;}else {$v371634fb16ef3b36985bf6399b678417 .= 'NULL';}if ($v2817f701d5e1a1181e657251363295fd < 2) {continue;}$v1b1cc7f086b3f074da452bc3129981eb .= sprintf('(%d, %d, %s),', $v16b2b26000987faccb260b9d39df1269, $v945100186b119048837b9859c2c46410, $v371634fb16ef3b36985bf6399b678417);}if (endsWith($v1b1cc7f086b3f074da452bc3129981eb, ',')) {$v1b1cc7f086b3f074da452bc3129981eb = rtrim($v1b1cc7f086b3f074da452bc3129981eb, ',') . ';';$this->getConnection()->query($v1b1cc7f086b3f074da452bc3129981eb);}}protected function parsePropData($v8d777f385d3dfec8815d20f7496026dc, $v6a992d5529f459a44fee58c733255e86) {$result = [];$vca66516bb4d6585b92b5fee0264db0d7 = false;foreach ($v8d777f385d3dfec8815d20f7496026dc as $vdf5feafab86601ea0e1e6fe6e20df6c5 => $vf09cc7ee3a9a93273f4b80601cafb00c) {if (isset($vf09cc7ee3a9a93273f4b80601cafb00c[$v6a992d5529f459a44fee58c733255e86])) {$vdf5feafab86601ea0e1e6fe6e20df6c5 = $this->decodeContentType($vdf5feafab86601ea0e1e6fe6e20df6c5);$result[$vdf5feafab86601ea0e1e6fe6e20df6c5] = $vf09cc7ee3a9a93273f4b80601cafb00c[$v6a992d5529f459a44fee58c733255e86];$vca66516bb4d6585b92b5fee0264db0d7 = true;}}return $vca66516bb4d6585b92b5fee0264db0d7 ? $result : false;}protected function decodeContentType($vdf5feafab86601ea0e1e6fe6e20df6c5) {if (mb_substr($vdf5feafab86601ea0e1e6fe6e20df6c5, -4) == '_val') {$vdf5feafab86601ea0e1e6fe6e20df6c5 = mb_substr($vdf5feafab86601ea0e1e6fe6e20df6c5, 0, mb_strlen($vdf5feafab86601ea0e1e6fe6e20df6c5) - 4);}return $vdf5feafab86601ea0e1e6fe6e20df6c5;}protected function applyParams($vf09cc7ee3a9a93273f4b80601cafb00c, $v21ffce5b8a6cc8cc6a41448dd69623c9 = null) {$vb2c97ae425dd751b0e48a3acae79cf4a = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'filter');$v927f8c827f23f513d40e3dc9cd23e52f = getArrayKey($v21ffce5b8a6cc8cc6a41448dd69623c9, 'field-type');if ($vb2c97ae425dd751b0e48a3acae79cf4a !== null) {$result = [];foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v6a992d5529f459a44fee58c733255e86 => $v2063c1608d6e0baf80249c42e2be5804) {foreach ($vb2c97ae425dd751b0e48a3acae79cf4a as $v833750ac635fcc57dc33ecafe365f9a7 => $v24b86e853ae3f6cdeaa0f580056a545c) {if (isset($v2063c1608d6e0baf80249c42e2be5804[$v833750ac635fcc57dc33ecafe365f9a7]) && $v2063c1608d6e0baf80249c42e2be5804[$v833750ac635fcc57dc33ecafe365f9a7] == $v24b86e853ae3f6cdeaa0f580056a545c) {$result[] = $v2063c1608d6e0baf80249c42e2be5804;}}}$vf09cc7ee3a9a93273f4b80601cafb00c = $result;}if ($v927f8c827f23f513d40e3dc9cd23e52f !== null) {foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v2063c1608d6e0baf80249c42e2be5804) {$vf09cc7ee3a9a93273f4b80601cafb00c[$v865c0c0b4ab0e063e5caa3387c1a8741] = getArrayKey($v2063c1608d6e0baf80249c42e2be5804, $v927f8c827f23f513d40e3dc9cd23e52f);}}return $vf09cc7ee3a9a93273f4b80601cafb00c;}protected function filterFloat($v2063c1608d6e0baf80249c42e2be5804) {return round($v2063c1608d6e0baf80249c42e2be5804, 2);}protected function isNeedToSave(array $v7f7cfde5ec586119b48911a2c75851e5) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = $this->value;$v0382b9fd9ef50b6a335f35e0aaaebf99 = $this->normaliseValue($v0382b9fd9ef50b6a335f35e0aaaebf99);$v7f7cfde5ec586119b48911a2c75851e5 = $this->normaliseValue($v7f7cfde5ec586119b48911a2c75851e5);if (umiCount($v0382b9fd9ef50b6a335f35e0aaaebf99) !== umiCount($v7f7cfde5ec586119b48911a2c75851e5)) {return true;}foreach ($v7f7cfde5ec586119b48911a2c75851e5 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if (!isset($v0382b9fd9ef50b6a335f35e0aaaebf99[$v3c6e0b8a9c15224a8228b9a98ca1531d])) {return true;}}return false;}private function normaliseValue(array $vf09cc7ee3a9a93273f4b80601cafb00c) {if (umiCount($vf09cc7ee3a9a93273f4b80601cafb00c) == 0) {return $vf09cc7ee3a9a93273f4b80601cafb00c;}$v538eb62c1deb2956e1a9e6c8a9f40352 = [];foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v2063c1608d6e0baf80249c42e2be5804) {$v3ee365a13fec15614ab09ed4d4c518d1 = [];$v03e8c25674d4987b234ef13048e999db = $this->extractIntValue($v2063c1608d6e0baf80249c42e2be5804);if ($v03e8c25674d4987b234ef13048e999db !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['int'] = $v03e8c25674d4987b234ef13048e999db;}$v4287e57e3904bab0a78130b3ddec44cb = $this->extractStringValue($v2063c1608d6e0baf80249c42e2be5804, 'varchar');if ($v4287e57e3904bab0a78130b3ddec44cb !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['varchar'] = $v4287e57e3904bab0a78130b3ddec44cb;}$v49700f1e1023d74a6169ca775fe850ee = $this->extractStringValue($v2063c1608d6e0baf80249c42e2be5804, 'text');if ($v49700f1e1023d74a6169ca775fe850ee !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['text'] = $v49700f1e1023d74a6169ca775fe850ee;}$v75790a6dc7d13001d191378d36764d92 = $this->extractRelValue($v2063c1608d6e0baf80249c42e2be5804);if ($v75790a6dc7d13001d191378d36764d92 !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['rel'] = $v75790a6dc7d13001d191378d36764d92;}$va9013b54957f0a3046fb5898336f207f = $this->extractTreeValue($v2063c1608d6e0baf80249c42e2be5804);if ($va9013b54957f0a3046fb5898336f207f !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['tree'] = $va9013b54957f0a3046fb5898336f207f;}$v40995fe10fc90ca5d4c0d3dc03185b4e = $this->extractFloatValue($v2063c1608d6e0baf80249c42e2be5804);if ($v40995fe10fc90ca5d4c0d3dc03185b4e !== null) {$v3ee365a13fec15614ab09ed4d4c518d1['float'] = $v40995fe10fc90ca5d4c0d3dc03185b4e;}$v906cde3f9cdec988f2fb2b5f5ae78b40 = '';foreach ($v3ee365a13fec15614ab09ed4d4c518d1 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$v906cde3f9cdec988f2fb2b5f5ae78b40 .= $v3c6e0b8a9c15224a8228b9a98ca1531d;}$v538eb62c1deb2956e1a9e6c8a9f40352[md5($v906cde3f9cdec988f2fb2b5f5ae78b40)] = $v3ee365a13fec15614ab09ed4d4c518d1;}return $v538eb62c1deb2956e1a9e6c8a9f40352;}private function extractTreeValue(array $v2063c1608d6e0baf80249c42e2be5804) {if (!isset($v2063c1608d6e0baf80249c42e2be5804['tree'])) {return null;}switch (true) {case $v2063c1608d6e0baf80249c42e2be5804['tree'] instanceof iUmiHierarchyElement === true: {return (int) $v2063c1608d6e0baf80249c42e2be5804['tree']->getId();}case is_numeric($v2063c1608d6e0baf80249c42e2be5804['tree']): {return (int) $v2063c1608d6e0baf80249c42e2be5804['tree'];}default: {return null;}}}private function extractStringValue(array $v2063c1608d6e0baf80249c42e2be5804, $vb96763b95160cc0943be0de4743a115b) {$vfb01a700655ea7c0ca630afdae59ddc4 = ['varchar', 'text'];if (!in_array($vb96763b95160cc0943be0de4743a115b, $vfb01a700655ea7c0ca630afdae59ddc4)) {return null;}if (!isset($v2063c1608d6e0baf80249c42e2be5804[$vb96763b95160cc0943be0de4743a115b])) {return null;}return (string) $v2063c1608d6e0baf80249c42e2be5804[$vb96763b95160cc0943be0de4743a115b];}private function extractIntValue(array $v2063c1608d6e0baf80249c42e2be5804) {if (!isset($v2063c1608d6e0baf80249c42e2be5804['int'])) {return null;}return (int) $v2063c1608d6e0baf80249c42e2be5804['int'];}private function extractFloatValue(array $v2063c1608d6e0baf80249c42e2be5804) {if (!isset($v2063c1608d6e0baf80249c42e2be5804['float'])) {return null;}return (float) $v2063c1608d6e0baf80249c42e2be5804['float'];}private function extractRelValue(array $v2063c1608d6e0baf80249c42e2be5804) {if (!isset($v2063c1608d6e0baf80249c42e2be5804['rel'])) {return null;}switch (true) {case $v2063c1608d6e0baf80249c42e2be5804['rel'] instanceof iUmiObject === true: {return (int) $v2063c1608d6e0baf80249c42e2be5804['rel']->getId();}case is_numeric($v2063c1608d6e0baf80249c42e2be5804['rel']): {return (int) $v2063c1608d6e0baf80249c42e2be5804['rel'];}case is_string($v2063c1608d6e0baf80249c42e2be5804['rel']): {return (string) $v2063c1608d6e0baf80249c42e2be5804['rel'];}default: {return null;}}}}