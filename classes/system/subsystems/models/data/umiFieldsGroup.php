<?php
 class umiFieldsGroup extends umiEntinty implements iUmiFieldsGroup {private $name;private $title;private $type_id;private $ord;private $is_active = true;private $is_visible = true;private $is_locked = false;private $tip = '';private $autoload_fields = false;private $fields = [];protected $store_type = 'fields_group';public function getName() {return $this->name;}public function getTitle() {return $this->translateLabel($this->title);}public function getTypeId() {return $this->type_id;}public function getOrd() {return $this->ord;}public function getIsActive() {return $this->is_active;}public function getIsVisible() {return $this->is_visible;}public function getIsLocked() {return $this->is_locked;}public function getTip() {return $this->translateLabel($this->tip);}public function setName($vb068931cc450442b63f5b3d276ea4297) {if ($this->getName() != $vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::convertAltName($vb068931cc450442b63f5b3d276ea4297, '_');$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 = $vb068931cc450442b63f5b3d276ea4297 !== '' ? $vb068931cc450442b63f5b3d276ea4297 : '_';$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}}public function setTitle($vd5d3db1765287eef77d7927cc956f50a) {if ($this->getTitle() != $vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $this->translateI18n($vd5d3db1765287eef77d7927cc956f50a, 'fields-group');$vd5d3db1765287eef77d7927cc956f50a = umiObjectProperty::filterInputString($vd5d3db1765287eef77d7927cc956f50a);$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->setIsUpdated();}}public function setTypeId($v5f694956811487225d15e973ca38fbab) {$v5f694956811487225d15e973ca38fbab = (int) $v5f694956811487225d15e973ca38fbab;if ($this->getTypeId() != $v5f694956811487225d15e973ca38fbab) {$this->type_id = $v5f694956811487225d15e973ca38fbab;$this->setIsUpdated();}return true;}public function setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9) {$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;if ($this->getOrd() != $v8bef1cc20ada3bef55fdf132cb2a1cb9) {$this->ord = $v8bef1cc20ada3bef55fdf132cb2a1cb9;$this->setIsUpdated();}}public function setIsActive($v367e854225a0810977297b3bedb2f309) {$v367e854225a0810977297b3bedb2f309 = (bool) $v367e854225a0810977297b3bedb2f309;if ($this->getIsActive() != $v367e854225a0810977297b3bedb2f309) {$this->is_active = $v367e854225a0810977297b3bedb2f309;$this->setIsUpdated();}}public function setIsVisible($v19fad0416b4b101ab72faccf4c323024) {$v19fad0416b4b101ab72faccf4c323024 = (bool) $v19fad0416b4b101ab72faccf4c323024;if ($this->getIsVisible() != $v19fad0416b4b101ab72faccf4c323024) {$this->is_visible = $v19fad0416b4b101ab72faccf4c323024;$this->setIsUpdated();}}public function setIsLocked($v73b8754d45983f35756b157ea439de8c) {$v73b8754d45983f35756b157ea439de8c = (bool) $v73b8754d45983f35756b157ea439de8c;if ($this->getIsLocked() != $v73b8754d45983f35756b157ea439de8c) {$this->is_locked = $v73b8754d45983f35756b157ea439de8c;$this->setIsUpdated();}}public function setTip($v21f671ba2273d4db289238e1bb9a2472) {if ($this->getTip() != $v21f671ba2273d4db289238e1bb9a2472) {$v6a2139364f96787c8ce1bbb0070b898c = $this->translateI18n($v21f671ba2273d4db289238e1bb9a2472, 'fields-group');$v21f671ba2273d4db289238e1bb9a2472 = umiObjectProperty::filterInputString($v6a2139364f96787c8ce1bbb0070b898c);$this->tip = $v21f671ba2273d4db289238e1bb9a2472;$this->setIsUpdated();}}protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if (!is_array($vf1965a857bc285d26fe22023aa5ab50d) || count($vf1965a857bc285d26fe22023aa5ab50d) < 9) {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$v817f7de13f58df29b13a9570082097da = (int) $this->getId();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT id, name, title, type_id, is_active, is_visible, is_locked, tip, ord 
FROM cms3_object_field_groups WHERE id = $v817f7de13f58df29b13a9570082097da LIMIT 0,1
SQL;    $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$vf1965a857bc285d26fe22023aa5ab50d = $result->fetch();}if (!is_array($vf1965a857bc285d26fe22023aa5ab50d) || count($vf1965a857bc285d26fe22023aa5ab50d) < 9) {return false;}list($vb80bb7740288fda1f201890375a60c8f, $vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $v5f694956811487225d15e973ca38fbab, $v367e854225a0810977297b3bedb2f309, $v19fad0416b4b101ab72faccf4c323024, $v73b8754d45983f35756b157ea439de8c, $v6a2139364f96787c8ce1bbb0070b898c, $v8bef1cc20ada3bef55fdf132cb2a1cb9) = $vf1965a857bc285d26fe22023aa5ab50d;$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->title = $vd5d3db1765287eef77d7927cc956f50a;$this->type_id = $v5f694956811487225d15e973ca38fbab;$this->is_active = (bool) $v367e854225a0810977297b3bedb2f309;$this->is_visible = (bool) $v19fad0416b4b101ab72faccf4c323024;$this->is_locked = (bool) $v73b8754d45983f35756b157ea439de8c;$this->tip = (string) $v6a2139364f96787c8ce1bbb0070b898c;$this->ord = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;if ($this->autoload_fields) {return $this->loadFields();}return true;}protected function save() {$vb068931cc450442b63f5b3d276ea4297 = (string) $this->name;$vd5d3db1765287eef77d7927cc956f50a = (string) $this->title;$v5f694956811487225d15e973ca38fbab = (int) $this->type_id;$v367e854225a0810977297b3bedb2f309 = (int) $this->is_active;$v19fad0416b4b101ab72faccf4c323024 = (int) $this->is_visible;$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $this->ord;$v73b8754d45983f35756b157ea439de8c = (int) $this->is_locked;$v6a2139364f96787c8ce1bbb0070b898c = (string) $this->tip;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<QUERY
UPDATE cms3_object_field_groups
SET    NAME = '{$vb068931cc450442b63f5b3d276ea4297}',
       title = '{$vd5d3db1765287eef77d7927cc956f50a}',
       type_id = '{$v5f694956811487225d15e973ca38fbab}',
       is_active = '{$v367e854225a0810977297b3bedb2f309}',
       is_visible = '{$v19fad0416b4b101ab72faccf4c323024}',
       ord = '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}',
       is_locked = '{$v73b8754d45983f35756b157ea439de8c}',
       tip = '{$v6a2139364f96787c8ce1bbb0070b898c}'
WHERE  id = '{$this->id}'
QUERY;   ConnectionPool::getInstance()    ->getConnection()    ->query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function loadFields($vdf347a373b8f92aa0ae3dd920a5ec2f6 = false) {$vd05b6ed7d2345020440df396d6da7f73 = umiFieldsCollection::getInstance();if ($vdf347a373b8f92aa0ae3dd920a5ec2f6 === false) {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT cof.id, cof.name, cof.title, cof.is_locked, cof.is_inheritable, cof.is_visible, cof.field_type_id,
       cof.guide_id, cof.in_search, cof.in_filter, cof.tip, cof.is_required, cof.sortable, cof.is_system,
       cof.restriction_id, cof.is_important
FROM cms3_fields_controller cfc, cms3_object_fields cof
WHERE cfc.group_id = '{$this->id}' AND cof.id = cfc.field_id ORDER BY cfc.ord ASC
SQL;    $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {list($v3aabf39f2d943fa886d86dcbbee4d910) = $vf1965a857bc285d26fe22023aa5ab50d;$v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d);if ($v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;}}}else {foreach ($vdf347a373b8f92aa0ae3dd920a5ec2f6 as $vf1965a857bc285d26fe22023aa5ab50d) {list($v3aabf39f2d943fa886d86dcbbee4d910) = $vf1965a857bc285d26fe22023aa5ab50d;$v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v3aabf39f2d943fa886d86dcbbee4d910, $vf1965a857bc285d26fe22023aa5ab50d);if ($v06e3d36fa30cea095545139854ad1fb9) {$this->fields[$v3aabf39f2d943fa886d86dcbbee4d910] = $v06e3d36fa30cea095545139854ad1fb9;}}}}public function getFields() {return $this->fields;}public function hasFields() {return count($this->fields) > 0;}public function hasFieldWithName($vb068931cc450442b63f5b3d276ea4297) {foreach ($this->getFields() as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $vb068931cc450442b63f5b3d276ea4297) {return true;}}return false;}public function getFieldByName($vb068931cc450442b63f5b3d276ea4297) {foreach ($this->getFields() as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() == $vb068931cc450442b63f5b3d276ea4297) {return $v06e3d36fa30cea095545139854ad1fb9;}}return null;}private function isLoaded($v945100186b119048837b9859c2c46410) {return array_key_exists($v945100186b119048837b9859c2c46410, $this->fields);}public function attachField($v945100186b119048837b9859c2c46410, $v2d6a84643fc95500e6185758306b43f6 = false) {if ($this->isLoaded($v945100186b119048837b9859c2c46410) && !$v2d6a84643fc95500e6185758306b43f6) {return true;}$v945100186b119048837b9859c2c46410 = (int) $v945100186b119048837b9859c2c46410;$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_fields_controller WHERE group_id = '{$this->id}'";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v8bef1cc20ada3bef55fdf132cb2a1cb9 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v8bef1cc20ada3bef55fdf132cb2a1cb9 = array_shift($v54851b009c5c647ca3e77cc517b8c76c);}$v8bef1cc20ada3bef55fdf132cb2a1cb9 += 5;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO cms3_fields_controller (field_id, group_id, ord)
VALUES('{$v945100186b119048837b9859c2c46410}', '{$this->id}', '{$v8bef1cc20ada3bef55fdf132cb2a1cb9}')
SQL;   $v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);$vd05b6ed7d2345020440df396d6da7f73 = umiFieldsCollection::getInstance();$v06e3d36fa30cea095545139854ad1fb9 = $vd05b6ed7d2345020440df396d6da7f73->getField($v945100186b119048837b9859c2c46410);$this->fields[$v945100186b119048837b9859c2c46410] = $v06e3d36fa30cea095545139854ad1fb9;umiTypesHelper::getInstance()->unloadObjectType($this->getTypeId());return true;}public function detachField($vb80bb7740288fda1f201890375a60c8f) {if (!$this->isLoaded($vb80bb7740288fda1f201890375a60c8f)) {return false;}$vb80bb7740288fda1f201890375a60c8f = (int) $vb80bb7740288fda1f201890375a60c8f;$v47db2588331bbe530c80dd001fc60aed = (int) $this->getId();$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()    ->getConnection();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM `cms3_fields_controller` WHERE `field_id` = $vb80bb7740288fda1f201890375a60c8f AND `group_id` = $v47db2588331bbe530c80dd001fc60aed";$v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);unset($this->fields[$vb80bb7740288fda1f201890375a60c8f]);umiTypesHelper::getInstance()->unloadObjectType($this->getTypeId());$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `group_id` FROM `cms3_fields_controller` WHERE `field_id` = $vb80bb7740288fda1f201890375a60c8f LIMIT 0,1";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);return ($result->length() == 0) ? umiFieldsCollection::getInstance()->delField($vb80bb7740288fda1f201890375a60c8f) : true;}public function moveFieldAfter($v945100186b119048837b9859c2c46410, $ve2e125f7ad54e80b659a4b3e87bf8d4a, $v47db2588331bbe530c80dd001fc60aed, $v4bd439a3ff0fb0e318264d9f579f15f9) {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();if ($ve2e125f7ad54e80b659a4b3e87bf8d4a == 0) {$v8437225ef7c926cdd9bc4b9783a3be54 = 0;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT ord FROM cms3_fields_controller
WHERE group_id = '{$v47db2588331bbe530c80dd001fc60aed}' AND field_id = '{$ve2e125f7ad54e80b659a4b3e87bf8d4a}'
SQL;    $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v8437225ef7c926cdd9bc4b9783a3be54 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v8437225ef7c926cdd9bc4b9783a3be54 = array_shift($v54851b009c5c647ca3e77cc517b8c76c);}}if ($v4bd439a3ff0fb0e318264d9f579f15f9) {$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
UPDATE cms3_fields_controller
SET ord = (ord + 1)
WHERE group_id = '{$this->id}' AND ord >= '{$v8437225ef7c926cdd9bc4b9783a3be54}'
SQL;    $v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT MAX(ord) FROM cms3_fields_controller WHERE group_id = '{$v47db2588331bbe530c80dd001fc60aed}'";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v8437225ef7c926cdd9bc4b9783a3be54 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$v8437225ef7c926cdd9bc4b9783a3be54 = array_shift($v54851b009c5c647ca3e77cc517b8c76c);}++$v8437225ef7c926cdd9bc4b9783a3be54;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
UPDATE cms3_fields_controller
SET ord = '{$v8437225ef7c926cdd9bc4b9783a3be54}', group_id = '$v47db2588331bbe530c80dd001fc60aed'
WHERE group_id = '{$this->id}' AND field_id = '{$v945100186b119048837b9859c2c46410}'
SQL;   $v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public static function getAllGroupsByName($vb068931cc450442b63f5b3d276ea4297) {$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();if ($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = $v4717d53ebfdfea8477f780ec66151dcb->escape($vb068931cc450442b63f5b3d276ea4297);}else {return false;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id` FROM `cms3_object_field_groups` WHERE `name` = '{$vb068931cc450442b63f5b3d276ea4297}'";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v1471e4e05a4db95d353cc867fe317314 = [];foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {try {$vdb0f6f37ebeb6ea09489124345af2a45 = new umiFieldsGroup(array_shift($vf1965a857bc285d26fe22023aa5ab50d));}catch (privateException $ve1671797c52e15f763380b45e841ec32) {$ve1671797c52e15f763380b45e841ec32->unregister();continue;}if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {continue;}$v1471e4e05a4db95d353cc867fe317314[] = $vdb0f6f37ebeb6ea09489124345af2a45;}return $v1471e4e05a4db95d353cc867fe317314;}}