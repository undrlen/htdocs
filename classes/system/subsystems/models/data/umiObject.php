<?php
 use UmiCms\Service;class umiObject extends umiEntinty implements iUmiObject {const INSTANCE_ATTRIBUTE_COUNT = 8;protected $store_type = 'object';private $name;private $type_id;private $is_locked;private $owner_id = false;private $guid;private $updateTime;private $ord;private $type_guid;private $properties = [];private $invertedProperties = [];private $prop_groups = [];private $propertiesLoaded;public function __construct($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d = false, $v8edb0ffce97546a0a77fa919df7f1b05 = true, $va8bd97d4992f85b7597e64fca3781ee1 = true) {parent::__construct($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d, $v8edb0ffce97546a0a77fa919df7f1b05, $va8bd97d4992f85b7597e64fca3781ee1);umiObjectProperty::unloadPropData($this->id);}public function getName($vf2e8a978f868dbada56963ee2baf4d4b = false) {$vb068931cc450442b63f5b3d276ea4297 = $this->name;if ($vb068931cc450442b63f5b3d276ea4297 !== null) {$vb068931cc450442b63f5b3d276ea4297 = Service::EmojiTranslator()     ->fromShortNameToUnicode($vb068931cc450442b63f5b3d276ea4297);}return $vf2e8a978f868dbada56963ee2baf4d4b ? $vb068931cc450442b63f5b3d276ea4297 : $this->translateLabel($vb068931cc450442b63f5b3d276ea4297);}public function setName($vb068931cc450442b63f5b3d276ea4297) {if ($vb068931cc450442b63f5b3d276ea4297 !== null) {$vb068931cc450442b63f5b3d276ea4297 = Service::EmojiTranslator()     ->fromUnicodeToShortName($vb068931cc450442b63f5b3d276ea4297);}if ($this->getName() != $vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = preg_replace('/([\x01-\x08]|[\x0B-\x0C]|[\x0E-\x1F])/', '', $vb068931cc450442b63f5b3d276ea4297);$vb068931cc450442b63f5b3d276ea4297 = $this->translateI18n($vb068931cc450442b63f5b3d276ea4297, 'object-');$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->setIsUpdated();}}public function setTypeId($v5f694956811487225d15e973ca38fbab) {if ($this->getTypeId() !== $v5f694956811487225d15e973ca38fbab) {$this->type_id = $v5f694956811487225d15e973ca38fbab;$this->setIsUpdated();}return true;}public function getTypeId() {return $this->type_id;}public function getIsLocked() {return $this->is_locked;}public function setIsLocked($v73b8754d45983f35756b157ea439de8c) {$v73b8754d45983f35756b157ea439de8c = (bool) $v73b8754d45983f35756b157ea439de8c;if ($this->getIsLocked() !== $v73b8754d45983f35756b157ea439de8c) {$this->is_locked = $v73b8754d45983f35756b157ea439de8c;$this->setIsUpdated();}}public function getOwnerId() {return $this->owner_id;}public function setOwnerId($vb0ab4f7791b60b1e8ea01057b77873b0) {if (!Service::ObjectsCollection()->isExists($vb0ab4f7791b60b1e8ea01057b77873b0)) {return false;}if ($this->getOwnerId() !== $vb0ab4f7791b60b1e8ea01057b77873b0) {$this->owner_id = $vb0ab4f7791b60b1e8ea01057b77873b0;$this->setIsUpdated();}return true;}public function getGUID() {return $this->guid;}public function setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$vb80bb7740288fda1f201890375a60c8f = Service::ObjectsCollection()    ->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($vb80bb7740288fda1f201890375a60c8f && $vb80bb7740288fda1f201890375a60c8f != $this->getId()) {throw new coreException("GUID {$v1e0ca5b1252f1f6b1e0ac91be7e7219e} already in use");}if ($this->getGUID() != $v1e0ca5b1252f1f6b1e0ac91be7e7219e) {$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;$this->setIsUpdated();}return $this;}public function getUpdateTime() {return $this->updateTime;}public function setUpdateTime($v5fa40b2485d1096a170d2d7ecd0f7030) {$v9a5e73d67afbd1b69ff848efe5e73442 = (int) $v5fa40b2485d1096a170d2d7ecd0f7030;if ($this->getUpdateTime() !== $v9a5e73d67afbd1b69ff848efe5e73442) {$this->updateTime = $v9a5e73d67afbd1b69ff848efe5e73442;parent::setIsUpdated();}return true;}public function getOrder() {return $this->ord;}public function setOrder($v70a17ffa722a3985b86d30b034ad06d7) {$v70a17ffa722a3985b86d30b034ad06d7 = (int) $v70a17ffa722a3985b86d30b034ad06d7;if ($this->getOrder() !== $v70a17ffa722a3985b86d30b034ad06d7) {$this->ord = $v70a17ffa722a3985b86d30b034ad06d7;$this->setIsUpdated();}return true;}public function setIsUpdated($v8de61324edc43f3acb1b73da3c63e89e = true) {parent::setIsUpdated($v8de61324edc43f3acb1b73da3c63e89e);if ($v8de61324edc43f3acb1b73da3c63e89e) {$this->updateTime = time();}Service::ObjectsCollection()    ->addUpdatedObjectId($this->getId());}public function getTypeGUID() {return $this->type_guid;}public function getXlink() {return 'uobject://' . $this->id;}public function getType() {$v599dcce2998a6b40b1e38e8c6006cb0a = Service::ObjectsTypesCollection()    ->getType($this->type_id);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiObjectType) {throw new coreException(sprintf('Cannot load iUmiObjectType by id "%s"', $this->type_id));}return $v599dcce2998a6b40b1e38e8c6006cb0a;}public function isFilled() {$vd05b6ed7d2345020440df396d6da7f73 = $this->getType()->getAllFields();foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getIsRequired() && $this->getValue($v06e3d36fa30cea095545139854ad1fb9->getName()) === null) {return false;}}return true;}public function loadFields() {$v5f694956811487225d15e973ca38fbab = $this->getTypeId();$vdaa30f42c1742d82454be5f4c9733bac = Service::TypesHelper()    ->getFieldsByObjectTypeIds($v5f694956811487225d15e973ca38fbab);if (isset($vdaa30f42c1742d82454be5f4c9733bac[$v5f694956811487225d15e973ca38fbab])) {$v69fe4aec8073954bf273e3113edd24cf = $vdaa30f42c1742d82454be5f4c9733bac[$v5f694956811487225d15e973ca38fbab];$v367b8c7f383339a18b0f5f319be60956 = $v69fe4aec8073954bf273e3113edd24cf;$v74693d2fc58b46bd06410f278e39aa71 = array_flip($v367b8c7f383339a18b0f5f319be60956);if (count($v69fe4aec8073954bf273e3113edd24cf) > 1) {umiFieldsCollection::getInstance()      ->getFieldList($v69fe4aec8073954bf273e3113edd24cf);}}else {$v367b8c7f383339a18b0f5f319be60956 = $v74693d2fc58b46bd06410f278e39aa71 = [];}$this->setInvertedProperties($v367b8c7f383339a18b0f5f319be60956)    ->setProperties($v74693d2fc58b46bd06410f278e39aa71);return true;}public function getPropByName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = mb_strtolower($vb068931cc450442b63f5b3d276ea4297);if (!$this->isPropertyNameExist($vb068931cc450442b63f5b3d276ea4297)) {return null;}$this->loadPropertiesIfNotLoaded();$v758f9a7df94fc455044f05f11c9ee06e = (int) $this->invertedProperties[$vb068931cc450442b63f5b3d276ea4297];return $this->getPropById($v758f9a7df94fc455044f05f11c9ee06e);}public function getPropById($vb80bb7740288fda1f201890375a60c8f) {if (!$this->isPropertyExists($vb80bb7740288fda1f201890375a60c8f)) {return null;}$this->loadPropertiesIfNotLoaded();if (!$this->properties[$vb80bb7740288fda1f201890375a60c8f] instanceof iUmiObjectProperty) {$this->properties[$vb80bb7740288fda1f201890375a60c8f] = Service::ObjectPropertyFactory()     ->create($this->getId(), $vb80bb7740288fda1f201890375a60c8f);}return $this->properties[$vb80bb7740288fda1f201890375a60c8f];}public function isPropertyExists($vb80bb7740288fda1f201890375a60c8f) {if (!is_string($vb80bb7740288fda1f201890375a60c8f) && !is_int($vb80bb7740288fda1f201890375a60c8f)) {return false;}$this->loadPropertiesIfNotLoaded();return isset($this->properties[$vb80bb7740288fda1f201890375a60c8f]);}public function isPropertyNameExist($vb068931cc450442b63f5b3d276ea4297) {if (!is_string($vb068931cc450442b63f5b3d276ea4297) && !is_int($vb068931cc450442b63f5b3d276ea4297)) {return false;}$this->loadPropertiesIfNotLoaded();return isset($this->invertedProperties[$vb068931cc450442b63f5b3d276ea4297]);}public function isPropGroupExists($vb80bb7740288fda1f201890375a60c8f) {if (umiCount($this->prop_groups) == 0) {$this->loadGroups();}if (!is_string($vb80bb7740288fda1f201890375a60c8f) && !is_int($vb80bb7740288fda1f201890375a60c8f)) {return false;}return isset($this->prop_groups[$vb80bb7740288fda1f201890375a60c8f]);}public function getPropGroupId($vb068931cc450442b63f5b3d276ea4297) {$v339b8e36d914b9618cd8956690c275ff = $this->getType()    ->getFieldsGroupsList();foreach ($v339b8e36d914b9618cd8956690c275ff as $vdb0f6f37ebeb6ea09489124345af2a45) {if ($vdb0f6f37ebeb6ea09489124345af2a45->getName() == $vb068931cc450442b63f5b3d276ea4297) {return $vdb0f6f37ebeb6ea09489124345af2a45->getId();}}return false;}public function getPropGroupByName($vb068931cc450442b63f5b3d276ea4297) {$vb80bb7740288fda1f201890375a60c8f = $this->getPropGroupId($vb068931cc450442b63f5b3d276ea4297);if ($vb80bb7740288fda1f201890375a60c8f) {return $this->getPropGroupById($vb80bb7740288fda1f201890375a60c8f);}return false;}public function getPropGroupById($vb80bb7740288fda1f201890375a60c8f) {if ($this->isPropGroupExists($vb80bb7740288fda1f201890375a60c8f)) {return $this->prop_groups[$vb80bb7740288fda1f201890375a60c8f];}$vdb0f6f37ebeb6ea09489124345af2a45 = $this->getType()    ->getFieldsGroup($vb80bb7740288fda1f201890375a60c8f);if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {return false;}$va8edd3a2f632cdbe847f9f1ce496f61d = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();$ve491e7c03c219d563fe5073ad035bb25 = [];foreach ($va8edd3a2f632cdbe847f9f1ce496f61d as $v06e3d36fa30cea095545139854ad1fb9) {if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {continue;}$ve491e7c03c219d563fe5073ad035bb25[] = $v06e3d36fa30cea095545139854ad1fb9->getId();}return $this->prop_groups[$vb80bb7740288fda1f201890375a60c8f] = $ve491e7c03c219d563fe5073ad035bb25;}public function getPropList($vb6a9bb0ac935756e252ed81244f1a7ff = false) {return $this->getType()->getAllFields($vb6a9bb0ac935756e252ed81244f1a7ff);}public function getValue($vb068931cc450442b63f5b3d276ea4297, $v21ffce5b8a6cc8cc6a41448dd69623c9 = null) {$v1a8db4c996d8ed8289da5f957879ab94 = $this->getPropByName($vb068931cc450442b63f5b3d276ea4297);if ($v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty) {return $v1a8db4c996d8ed8289da5f957879ab94->getValue($v21ffce5b8a6cc8cc6a41448dd69623c9);}return false;}public function getValueById($v945100186b119048837b9859c2c46410, $v21ffce5b8a6cc8cc6a41448dd69623c9 = null) {$v1a8db4c996d8ed8289da5f957879ab94 = $this->getPropById($v945100186b119048837b9859c2c46410);if (!$v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty) {return false;}return $v1a8db4c996d8ed8289da5f957879ab94->getValue($v21ffce5b8a6cc8cc6a41448dd69623c9);}public function setValue($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804) {$v1a8db4c996d8ed8289da5f957879ab94 = $this->getPropByName($vb068931cc450442b63f5b3d276ea4297);if ($v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty) {$v1a8db4c996d8ed8289da5f957879ab94->setValue($v2063c1608d6e0baf80249c42e2be5804);if ($v1a8db4c996d8ed8289da5f957879ab94->getIsUpdated()) {$this->setIsUpdated();}return true;}return false;}public function delete() {Service::ObjectsCollection()    ->delObject($this->getId());}public function __get($vb068931cc450442b63f5b3d276ea4297) {switch ($vb068931cc450442b63f5b3d276ea4297) {case 'id':     return $this->id;case 'name':     return $this->getName();case 'ownerId':     return $this->getOwnerId();case 'typeId':     return $this->getTypeId();case 'GUID':     return $this->getGUID();case 'typeGUID':     return $this->getTypeGUID();case 'xlink':     return $this->getXlink();default:     return $this->getValue($vb068931cc450442b63f5b3d276ea4297);}}public function __isset($vb068931cc450442b63f5b3d276ea4297) {switch ($vb068931cc450442b63f5b3d276ea4297) {case 'id':    case 'name':    case 'ownerId':    case 'typeId':    case 'GUID':    case 'typeGUID':    case 'xlink': {return true;}default : {return ($this->getPropByName($vb068931cc450442b63f5b3d276ea4297) instanceof iUmiObjectProperty);}}}public function __set($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804) {switch ($vb068931cc450442b63f5b3d276ea4297) {case 'id':     throw new coreException('Object id could not be changed');case 'name':     return $this->setName($v2063c1608d6e0baf80249c42e2be5804);case 'ownerId':     return $this->setOwnerId($v2063c1608d6e0baf80249c42e2be5804);default:     return $this->setValue($vb068931cc450442b63f5b3d276ea4297, $v2063c1608d6e0baf80249c42e2be5804);}}public function getModule() {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = Service::ObjectsTypesCollection()    ->getHierarchyTypeIdByObjectTypeId($this->getTypeId());$v89b0b9deff65f8b9cd1f71bc74ce36ba = Service::HierarchyTypesCollection()    ->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {return $v89b0b9deff65f8b9cd1f71bc74ce36ba->getName();}return false;}public function getMethod() {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = Service::ObjectsTypesCollection()    ->getHierarchyTypeIdByObjectTypeId($this->getTypeId());$v89b0b9deff65f8b9cd1f71bc74ce36ba = Service::HierarchyTypesCollection()    ->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {return $v89b0b9deff65f8b9cd1f71bc74ce36ba->getExt();}return false;}public function update() {parent::update();$this->setPropertiesNotLoaded();umiObjectProperty::unloadPropData($this->id);}protected function save() {$v06ce91230184ce59c2eb3ef5a4ad4d3b = true;$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($this->getName($v06ce91230184ce59c2eb3ef5a4ad4d3b));$vb068931cc450442b63f5b3d276ea4297 = $vb068931cc450442b63f5b3d276ea4297 ? "'$vb068931cc450442b63f5b3d276ea4297'" : 'NULL';$v5f694956811487225d15e973ca38fbab = (int) $this->getTypeId();$v73b8754d45983f35756b157ea439de8c = (int) $this->getIsLocked();$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $this->getOwnerId();$v1e0ca5b1252f1f6b1e0ac91be7e7219e = umiObjectProperty::filterInputString($this->getGUID());$v5fa40b2485d1096a170d2d7ecd0f7030 = $this->getUpdateTime() === null ? 'NULL' : $this->getUpdateTime();$v8bef1cc20ada3bef55fdf132cb2a1cb9 = (int) $this->getOrder();$v16b2b26000987faccb260b9d39df1269 = (int) $this->getId();$v4717d53ebfdfea8477f780ec66151dcb = Service::ConnectionPool()    ->getConnection();$v4717d53ebfdfea8477f780ec66151dcb->startTransaction("Saving object #$v16b2b26000987faccb260b9d39df1269");$vac5c74b64b4b8352ef2f181affb5ac2a = <<<QUERY
	UPDATE `cms3_objects`
	SET `name` = $vb068931cc450442b63f5b3d276ea4297, `type_id` = $v5f694956811487225d15e973ca38fbab, `is_locked` = $v73b8754d45983f35756b157ea439de8c, `owner_id` = $vb0ab4f7791b60b1e8ea01057b77873b0, `guid` = '$v1e0ca5b1252f1f6b1e0ac91be7e7219e',
	`updatetime` = $v5fa40b2485d1096a170d2d7ecd0f7030, `ord` = $v8bef1cc20ada3bef55fdf132cb2a1cb9
	WHERE `id` = $v16b2b26000987faccb260b9d39df1269
QUERY;   try {$v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);$v7524586d162135fb1ccdf771d21e7c09 = umiObjectProperty::isTransactionModeEnabled();if ($v7524586d162135fb1ccdf771d21e7c09) {umiObjectProperty::disableTransactionMode();}foreach ($this->getProperties() as $v23a5b8ab834cb5140fa6665622eb6417) {if ($v23a5b8ab834cb5140fa6665622eb6417 instanceof iUmiObjectProperty && $v23a5b8ab834cb5140fa6665622eb6417->getIsUpdated()) {$v23a5b8ab834cb5140fa6665622eb6417->commit();}}if ($v7524586d162135fb1ccdf771d21e7c09) {umiObjectProperty::enableTransactionMode();}}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$v4717d53ebfdfea8477f780ec66151dcb->rollbackTransaction();throw $ve1671797c52e15f763380b45e841ec32;}$v4717d53ebfdfea8477f780ec66151dcb->commitTransaction();return true;}protected function loadInfo($v8d777f385d3dfec8815d20f7496026dc = false) {if (!is_array($v8d777f385d3dfec8815d20f7496026dc) || count($v8d777f385d3dfec8815d20f7496026dc) !== self::INSTANCE_ATTRIBUTE_COUNT) {$v4717d53ebfdfea8477f780ec66151dcb = Service::ConnectionPool()     ->getConnection();$v817f7de13f58df29b13a9570082097da = (int) $this->getId();$vac5c74b64b4b8352ef2f181affb5ac2a = <<<QUERY
	SELECT o.name,
		   o.type_id,
		   o.is_locked,
		   o.owner_id,
		   o.guid AS `guid`,
		   t.guid AS `type_guid`,
		   o.updatetime,
		   o.ord
	FROM   cms3_objects `o`,
		   cms3_object_types `t`
	WHERE  o.id = $v817f7de13f58df29b13a9570082097da
		   AND o.type_id = t.id
	LIMIT 0,1
QUERY;    $result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);$v8d777f385d3dfec8815d20f7496026dc = $result->fetch();}if (!is_array($v8d777f385d3dfec8815d20f7496026dc) || count($v8d777f385d3dfec8815d20f7496026dc) !== self::INSTANCE_ATTRIBUTE_COUNT) {return false;}list($vb068931cc450442b63f5b3d276ea4297, $v5f694956811487225d15e973ca38fbab, $v73b8754d45983f35756b157ea439de8c, $vb0ab4f7791b60b1e8ea01057b77873b0, $v1e0ca5b1252f1f6b1e0ac91be7e7219e, $v6b9cabb4eeb65f66097d5658f2a92258, $v5fa40b2485d1096a170d2d7ecd0f7030, $v8bef1cc20ada3bef55fdf132cb2a1cb9) = $v8d777f385d3dfec8815d20f7496026dc;$this->name = $vb068931cc450442b63f5b3d276ea4297;$this->type_id = (int) $v5f694956811487225d15e973ca38fbab;$this->is_locked = (bool) $v73b8754d45983f35756b157ea439de8c;$this->owner_id = (int) $vb0ab4f7791b60b1e8ea01057b77873b0;$this->guid = $v1e0ca5b1252f1f6b1e0ac91be7e7219e;$this->type_guid = $v6b9cabb4eeb65f66097d5658f2a92258;$this->updateTime = $v5fa40b2485d1096a170d2d7ecd0f7030;$this->ord = (int) $v8bef1cc20ada3bef55fdf132cb2a1cb9;return true;}private function loadGroups() {$v1471e4e05a4db95d353cc867fe317314 = $this->getType()    ->getFieldsGroupsList();foreach ($v1471e4e05a4db95d353cc867fe317314 as $vdb0f6f37ebeb6ea09489124345af2a45) {if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup || !$vdb0f6f37ebeb6ea09489124345af2a45->getIsActive()) {continue;}$vd05b6ed7d2345020440df396d6da7f73 = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();$this->prop_groups[$vdb0f6f37ebeb6ea09489124345af2a45->getId()] = [];foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v06e3d36fa30cea095545139854ad1fb9) {$this->prop_groups[$vdb0f6f37ebeb6ea09489124345af2a45->getId()][] = $v06e3d36fa30cea095545139854ad1fb9->getId();}}}private function getProperties() {$this->loadPropertiesIfNotLoaded();return $this->properties;}private function loadPropertiesIfNotLoaded() {if ($this->isPropertiesLoaded()) {return false;}$this->loadFields();$this->setPropertiesLoaded();return true;}private function isPropertiesLoaded() {return $this->propertiesLoaded;}private function setPropertiesLoaded() {$this->propertiesLoaded = true;return $this;}private function setPropertiesNotLoaded() {$this->propertiesLoaded = false;return $this;}private function setProperties(array $v74693d2fc58b46bd06410f278e39aa71) {$this->properties = $v74693d2fc58b46bd06410f278e39aa71;return $this;}private function setInvertedProperties(array $v367b8c7f383339a18b0f5f319be60956) {$this->invertedProperties = $v367b8c7f383339a18b0f5f319be60956;return $this;}public function checkSelf() {return null;}}