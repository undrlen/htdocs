<?php
 use UmiCms\Service;use UmiCms\System\Request\iFacade;class systemInfo implements iSystemInfo {private $registry;private $connection;private $domainCollection;private $request;public function __construct(   iRegedit $va9205dcfd4a6f7c2cbe8be01566ff84a, IConnection $v4717d53ebfdfea8477f780ec66151dcb, iDomainsCollection $v0d771fa031fb27561ed207afa6cf9983, iFacade $v10573b873d2fa5a365d558a45e328e47  ) {$this->setRegistry($va9205dcfd4a6f7c2cbe8be01566ff84a)    ->setConnection($v4717d53ebfdfea8477f780ec66151dcb)    ->setDomainCollection($v0d771fa031fb27561ed207afa6cf9983)    ->setRequest($v10573b873d2fa5a365d558a45e328e47);}public function getInfo($vef3e30e070f70244fd6578d88a6b77ac = 1) {if (!is_numeric($vef3e30e070f70244fd6578d88a6b77ac)) {throw new coreException(__METHOD__ . ': incorrect option given');}$vc68271a63ddbc431c307beb7d2918275 = [];if (($vef3e30e070f70244fd6578d88a6b77ac & self::SYSTEM) === self::SYSTEM) {$vc68271a63ddbc431c307beb7d2918275['system'] = $this->getSystemInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::PHP) === self::PHP) {$vc68271a63ddbc431c307beb7d2918275['php'] = $this->getPHPParameters();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::DATABASE) === self::DATABASE) {$vc68271a63ddbc431c307beb7d2918275['database'] = $this->getDataBaseInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::NETWORK) === self::NETWORK) {$vc68271a63ddbc431c307beb7d2918275['network'] = $this->getNetworkInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::STAT) === self::STAT) {$vc68271a63ddbc431c307beb7d2918275['stat'] = $this->getStatInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::MODULES) === self::MODULES) {$vc68271a63ddbc431c307beb7d2918275['modules'] = $this->getModulesInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::LICENSE) === self::LICENSE) {$vc68271a63ddbc431c307beb7d2918275['license'] = $this->getLicenseInfo();}if (($vef3e30e070f70244fd6578d88a6b77ac & self::PHP_INFO) === self::PHP_INFO) {$vc68271a63ddbc431c307beb7d2918275['php_info'] = $this->getPhpInfo();}return $vc68271a63ddbc431c307beb7d2918275;}private function getSystemInfo() {$va529f88386a00f5823b8dbae4c903255 = Service::RegistrySettings();return [    'version' => $va529f88386a00f5823b8dbae4c903255->getVersion(),    'revision' => $va529f88386a00f5823b8dbae4c903255->getRevision(),    'license' => $va529f88386a00f5823b8dbae4c903255->getEdition(),   ];}private function getPHPParameters() {return [    'version' => $this->parseVersion(phpversion()),    'os' => php_uname(),    'info' => [     'modules' => get_loaded_extensions(),     'configurations' => ini_get_all()    ]   ];}private function getDataBaseInfo() {return [    'driver' => iConfiguration::MYSQL_DB_DRIVER,    'version' => $this->getMySQLVersion()   ];}private function getNetworkInfo() {return [    'hosts' => $this->getHostList(),    'ip' => $this->getRequest()->serverAddress()   ];}private function getStatInfo() {$va9205dcfd4a6f7c2cbe8be01566ff84a = $this->getRegistry();return [    'last_update_time' => Service::RegistrySettings()->getUpdateTime(),    'trial_days_left' => $va9205dcfd4a6f7c2cbe8be01566ff84a->getDaysLeft(),    'web_server_id' => $this->getRequest()->Server()->get('SERVER_SOFTWARE')   ];}private function getModulesInfo() {$v20cf12be6809c539cfed17c272627718 = $this->getRegistry()    ->getList('//modules');$v1a7b835dcba387a3650c6f7a773579bd = [];foreach ($v20cf12be6809c539cfed17c272627718 as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if (isset($v2063c1608d6e0baf80249c42e2be5804[0])) {$v1a7b835dcba387a3650c6f7a773579bd[] = $v2063c1608d6e0baf80249c42e2be5804[0];}}return $v1a7b835dcba387a3650c6f7a773579bd;}private function getLicenseInfo() {return [    'key' => Service::RegistrySettings()->getLicense()   ];}private function getPhpInfo() {ob_start();phpinfo();$v0e05d74bbc655cc42c026f2353d1eb63 = ob_get_contents();ob_end_clean();return $v0e05d74bbc655cc42c026f2353d1eb63;}private function parseVersion($v2af72f100c356273d46284f6fd1dfc08) {preg_match('/[0-9]+\.[0-9]+\.[0-9]+/', $v2af72f100c356273d46284f6fd1dfc08, $v9c28d32df234037773be184dbdafc274);if (!isset($v9c28d32df234037773be184dbdafc274[0])) {throw new coreException(__METHOD__ . ': can\' grab version');}return $v9c28d32df234037773be184dbdafc274[0];}private function getMySQLVersion() {$vc5fe61b300d8d2f218d22e0ed53e1a8d = $this->getConnection()    ->getServerInfo();return $this->parseVersion($vc5fe61b300d8d2f218d22e0ed53e1a8d);}private function getHostList() {$v9348c895145fa0e884a5de5201664d74 = [];foreach ($this->getDomainCollection()->getList() as $vad5f82e879a9c5d6b5b442eb37e50551) {$v9348c895145fa0e884a5de5201664d74[$vad5f82e879a9c5d6b5b442eb37e50551->getId()]['host'] = $vad5f82e879a9c5d6b5b442eb37e50551->getHost();$v710018de257e97e3a86bfaead570772e = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrorsList();foreach ($v710018de257e97e3a86bfaead570772e as $vfbe322a89bc0ba531c3f0050e3935f28) {$v9348c895145fa0e884a5de5201664d74[$vad5f82e879a9c5d6b5b442eb37e50551->getId()]['mirrors'][] = $vfbe322a89bc0ba531c3f0050e3935f28->getHost();}if ($vad5f82e879a9c5d6b5b442eb37e50551->getIsDefault()) {$v9348c895145fa0e884a5de5201664d74[$vad5f82e879a9c5d6b5b442eb37e50551->getId()]['is_default'] = '1';}}return $v9348c895145fa0e884a5de5201664d74;}private function getRegistry() {return $this->registry;}private function setRegistry(iRegedit $va9205dcfd4a6f7c2cbe8be01566ff84a) {$this->registry = $va9205dcfd4a6f7c2cbe8be01566ff84a;return $this;}private function getConnection() {return $this->connection;}private function setConnection(IConnection $v4717d53ebfdfea8477f780ec66151dcb) {$this->connection = $v4717d53ebfdfea8477f780ec66151dcb;return $this;}private function getDomainCollection() {return $this->domainCollection;}private function setDomainCollection(iDomainsCollection $v0d771fa031fb27561ed207afa6cf9983) {$this->domainCollection = $v0d771fa031fb27561ed207afa6cf9983;return $this;}private function getRequest() {return $this->request;}private function setRequest(iFacade $v10573b873d2fa5a365d558a45e328e47) {$this->request = $v10573b873d2fa5a365d558a45e328e47;return $this;}public static function getInstance($v4a8a08f09d37b73795649038408b5f33 = null) {return Service::SystemInfo();}}