<?php
 use UmiCms\Service;use UmiCms\System\Data\Object\Property\Value;class selectorExecutor {public $length;protected   $selector,   $queryColumns = [],   $queryTables = [],   $queryJoinTables = [],   $queryLimit = [],   $queryFields = [],   $orderFields = [],   $groupFields = [],   $queryOptions = [],   $skipExecutedCheck = false;private $hierarchyTypesCount = 0;private $hierarchyTypeIds = [];private $objectTypeIds = [];private $leftJoins = [];public function __construct(selector $v5b3c32009797feb79096d52e56a56b82) {$this->selector = $v5b3c32009797feb79096d52e56a56b82;$this->analyze();}public function query() {return $this->buildQuery('result');}public function result() {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('result');$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);if (!$this->selector->option('no-length')->value) {$v770c639e20ac2f19c5ae0da373080e25 = $v4717d53ebfdfea8477f780ec66151dcb->queryResult('SELECT FOUND_ROWS()');$v770c639e20ac2f19c5ae0da373080e25->setFetchType(IQueryResult::FETCH_ROW);if ($v770c639e20ac2f19c5ae0da373080e25->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $v770c639e20ac2f19c5ae0da373080e25->fetch();$ve2942a04780e223b215eb8b663cf5353 = array_shift($v54851b009c5c647ca3e77cc517b8c76c);}else {$ve2942a04780e223b215eb8b663cf5353 = 0;}$v770c639e20ac2f19c5ae0da373080e25->freeResult();$this->length = (int) $ve2942a04780e223b215eb8b663cf5353;}if ($this->selector->__get('mode') == 'objects') {return $this->getObjectResult($result);}$v5a2576254d428ddc22a03fac145c8749 = [];$result->setFetchType(IQueryResult::FETCH_ASSOC);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$vb80bb7740288fda1f201890375a60c8f = (int) $vf1965a857bc285d26fe22023aa5ab50d['id'];$vbfa030fe63bacd523dd70a76cfaed98a = isset($vf1965a857bc285d26fe22023aa5ab50d['pid']) ? (int) $vf1965a857bc285d26fe22023aa5ab50d['pid'] : 0;$v5a2576254d428ddc22a03fac145c8749[$vb80bb7740288fda1f201890375a60c8f] = $vbfa030fe63bacd523dd70a76cfaed98a;}if ($this->selector->option('exclude-nested')->value) {$v65e1cc11bb006be768bed727c321f0f1 = $this->excludeNestedPages($v5a2576254d428ddc22a03fac145c8749);$this->length = count($v65e1cc11bb006be768bed727c321f0f1);$vaa9f73eea60a006820d0f8768bc8a3fc = $this->selector->__get('limit');$v7a86c157ee9713c34fbd7a1ee40f0c5a = $this->selector->__get('offset');if ($vaa9f73eea60a006820d0f8768bc8a3fc || $v7a86c157ee9713c34fbd7a1ee40f0c5a) {$v65e1cc11bb006be768bed727c321f0f1 = array_slice($v65e1cc11bb006be768bed727c321f0f1, $v7a86c157ee9713c34fbd7a1ee40f0c5a, $vaa9f73eea60a006820d0f8768bc8a3fc);}}else {$v65e1cc11bb006be768bed727c321f0f1 = array_keys($v5a2576254d428ddc22a03fac145c8749);}$v65e1cc11bb006be768bed727c321f0f1 = array_unique($v65e1cc11bb006be768bed727c321f0f1);return $this->getPageResult($v65e1cc11bb006be768bed727c321f0f1);}public function length() {if ($this->length !== null) {return $this->length;}$this->skipExecutedCheck = true;if (umiCount($this->selector->groupSysProps) || umiCount($this->selector->groupFieldProps)) {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('result');}else {$vac5c74b64b4b8352ef2f181affb5ac2a = $this->buildQuery('count');}$this->skipExecutedCheck = false;$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);if (umiCount($this->selector->groupSysProps) || umiCount($this->selector->groupFieldProps)) {$ve2942a04780e223b215eb8b663cf5353 = $result->length();}else {$ve2942a04780e223b215eb8b663cf5353 = 0;if ($result->length() > 0) {$v54851b009c5c647ca3e77cc517b8c76c = $result->fetch();$ve2942a04780e223b215eb8b663cf5353 = (int) array_shift($v54851b009c5c647ca3e77cc517b8c76c);}}return $this->length = $ve2942a04780e223b215eb8b663cf5353;}public static function getContentTableName(selector $v5b3c32009797feb79096d52e56a56b82, $v945100186b119048837b9859c2c46410) {$v1afd32818d1c9525f82aff4c09efd254 = ($v945100186b119048837b9859c2c46410 !== null) ? self::getFieldColumn($v945100186b119048837b9859c2c46410) : null;return Service::ObjectPropertyValueTableSchema()    ->getTableByDataType($v1afd32818d1c9525f82aff4c09efd254);}public function getSkipExecutedCheckState() {return $this->skipExecutedCheck;}protected function analyze() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;switch ($v5b3c32009797feb79096d52e56a56b82->mode) {case 'objects':     $this->requireTable('o', 'cms3_objects');$this->requireTable('t', 'cms3_object_types');break;case 'pages':     $this->requireTable('h', 'cms3_hierarchy');break;}$this->analyzeFields();$this->analyzeLimit();}protected function requireTable($v724874d1be77f450a09b305fc1534afb, $v80071f37861c360a27b7327e132c911a) {$this->queryTables[$v724874d1be77f450a09b305fc1534afb] = $v80071f37861c360a27b7327e132c911a;}protected function requireSysProp($v46b9e6004c49d9cc040029c197cab278) {$v90e46a37654bd99f32b7dce981c0d9a0 = [];$v90e46a37654bd99f32b7dce981c0d9a0['name'] = ['o.name', 'table' => ['o', 'cms3_objects']];$v90e46a37654bd99f32b7dce981c0d9a0['guid'] = ['o.guid', 'table' => ['o', 'cms3_objects']];$v90e46a37654bd99f32b7dce981c0d9a0['owner'] = ['o.owner_id', 'table' => ['o', 'cms3_objects']];$v90e46a37654bd99f32b7dce981c0d9a0['domain'] = ['h.domain_id'];$v90e46a37654bd99f32b7dce981c0d9a0['lang'] = ['h.lang_id'];$v90e46a37654bd99f32b7dce981c0d9a0['obj_id'] = ['h.obj_id'];$v90e46a37654bd99f32b7dce981c0d9a0['obj_type_id'] = ['o.type_id', 'table' => ['o', 'cms3_objects']];$v90e46a37654bd99f32b7dce981c0d9a0['is_deleted'] = ['h.is_deleted'];$v90e46a37654bd99f32b7dce981c0d9a0['is_default'] = ['h.is_default'];$v90e46a37654bd99f32b7dce981c0d9a0['is_visible'] = ['h.is_visible'];$v90e46a37654bd99f32b7dce981c0d9a0['is_active'] = ['h.is_active'];$v90e46a37654bd99f32b7dce981c0d9a0['domain'] = ['h.domain_id'];$v90e46a37654bd99f32b7dce981c0d9a0['rand'] = ['RAND()'];$v90e46a37654bd99f32b7dce981c0d9a0['template_id'] = ['h.tpl_id'];$v90e46a37654bd99f32b7dce981c0d9a0['alt_name'] = ['h.alt_name'];if ($this->selector->mode == 'pages') {$v90e46a37654bd99f32b7dce981c0d9a0['updatetime'] = ['h.updatetime'];$v90e46a37654bd99f32b7dce981c0d9a0['ord'] = ['h.ord', 'table' => ['h', 'cms3_hierarchy']];$v90e46a37654bd99f32b7dce981c0d9a0['id'] = ['h.id'];}else {$v90e46a37654bd99f32b7dce981c0d9a0['updatetime'] = ['o.updatetime'];$v90e46a37654bd99f32b7dce981c0d9a0['ord'] = ['o.ord', 'table' => ['o', 'cms3_objects']];$v90e46a37654bd99f32b7dce981c0d9a0['id'] = ['o.id', 'table' => ['o', 'cms3_objects']];}if (isset($v90e46a37654bd99f32b7dce981c0d9a0[$v46b9e6004c49d9cc040029c197cab278])) {$vcaf9b6b99962bf5c2264824231d7a40c = $v90e46a37654bd99f32b7dce981c0d9a0[$v46b9e6004c49d9cc040029c197cab278];if (isset($vcaf9b6b99962bf5c2264824231d7a40c['table'])) {$this->requireTable($vcaf9b6b99962bf5c2264824231d7a40c['table'][0], $vcaf9b6b99962bf5c2264824231d7a40c['table'][1]);}return $vcaf9b6b99962bf5c2264824231d7a40c[0];}throw new selectorException("Not supported property \"{$v46b9e6004c49d9cc040029c197cab278}\"");}protected function analyzeFields() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;$v4d15c1a5147ac6e7c61f1f05cc0339bc = $v5b3c32009797feb79096d52e56a56b82->whereFieldProps;$vd05b6ed7d2345020440df396d6da7f73 = [];foreach ($v4d15c1a5147ac6e7c61f1f05cc0339bc as $vfb71454c9524dee848efc7c91a8a5e39) {if (!$vfb71454c9524dee848efc7c91a8a5e39 instanceof selectorWhereFieldProp) {continue;}foreach ($vfb71454c9524dee848efc7c91a8a5e39->getFieldIdList() as $v945100186b119048837b9859c2c46410) {$vd05b6ed7d2345020440df396d6da7f73[] = $v945100186b119048837b9859c2c46410;}}$vd05b6ed7d2345020440df396d6da7f73 = array_unique($vd05b6ed7d2345020440df396d6da7f73);foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v945100186b119048837b9859c2c46410) {$v80071f37861c360a27b7327e132c911a = self::getContentTableName($v5b3c32009797feb79096d52e56a56b82, $v945100186b119048837b9859c2c46410);$this->requireTable('oc_' . $v945100186b119048837b9859c2c46410, $v80071f37861c360a27b7327e132c911a);$this->queryFields[] = $v945100186b119048837b9859c2c46410;}$ve4f9578e963194d1dea2604c69fba233 = $this->selector->orderFieldProps;$v9b213cd2a03125a1f3a71b7e91bf917f = [];foreach ($ve4f9578e963194d1dea2604c69fba233 as $v15593b5794641961eaad66561b2ae6b5) {if (!$v15593b5794641961eaad66561b2ae6b5 instanceof selectorOrderFieldProp) {continue;}foreach ($v15593b5794641961eaad66561b2ae6b5->getFieldIdList() as $v945100186b119048837b9859c2c46410) {$v9b213cd2a03125a1f3a71b7e91bf917f[] = $v945100186b119048837b9859c2c46410;}}if (umiCount($v9b213cd2a03125a1f3a71b7e91bf917f) > 0) {$this->orderFields = $v9b213cd2a03125a1f3a71b7e91bf917f;}$v2ca176eabd841948619da27f5e0b73d0 = $this->selector->groupFieldProps;$v4bc546b2d8c994d9600d8bd980f28922 = [];foreach ($v2ca176eabd841948619da27f5e0b73d0 as $v36e600030e9e1d74446ac27890cca0ce) {if (!$v36e600030e9e1d74446ac27890cca0ce instanceof selectorGroupFieldProp) {continue;}foreach ($v36e600030e9e1d74446ac27890cca0ce->getFieldIdList() as $v945100186b119048837b9859c2c46410) {$v4bc546b2d8c994d9600d8bd980f28922[] = $v945100186b119048837b9859c2c46410;}}if (umiCount($v4bc546b2d8c994d9600d8bd980f28922) > 0) {$this->groupFields = $v4bc546b2d8c994d9600d8bd980f28922;}}protected function analyzeLimit() {$v5b3c32009797feb79096d52e56a56b82 = $this->selector;if ($v5b3c32009797feb79096d52e56a56b82->option('exclude-nested')->value) {return;}if ($v5b3c32009797feb79096d52e56a56b82->limit || $v5b3c32009797feb79096d52e56a56b82->offset) {$this->queryLimit = [(int) $v5b3c32009797feb79096d52e56a56b82->offset, (int) $v5b3c32009797feb79096d52e56a56b82->limit];}}protected function buildQuery($v15d61712450a686a7f365adf4fef581f) {if ($this->selector->option('root')->value) {return $this->buildRootQuery($v15d61712450a686a7f365adf4fef581f);}$vc6c12f4db6ba0426c8e023cb1ca31038 = $va85bfb9c6bcd889ceb433a1c9cd4b218 = '';if ($v15d61712450a686a7f365adf4fef581f != 'count') {$vc6c12f4db6ba0426c8e023cb1ca31038 = $this->buildLimit();$va85bfb9c6bcd889ceb433a1c9cd4b218 = $this->buildOrder();}$ve22c565b90e9a278849f2d61d78e8388 = $this->buildGroup();$vccc9e74cf27019ed02701010da900d6d = $this->buildWhere();$v0b63a75de116aadef5f4aed3dc3b7d87 = $this->buildLeftJoins();$v75a8be0fca0bc0497c40180b6d02d580 = $this->buildTables();$v39daa41bf389071ad9cd7a7a0ad2ff2c = $this->buildOptions($v15d61712450a686a7f365adf4fef581f);if ($v15d61712450a686a7f365adf4fef581f == 'result') {if ($this->selector->mode == 'objects') {$this->queryColumns = [      'o.id as id',      'o.name as name',      'o.type_id as type_id',      'o.is_locked as is_locked',      'o.owner_id as owner_id',      'o.guid as guid',      't.guid as type_guid',      'o.updatetime as updatetime',      'o.ord as ord'     ];}else {$this->queryColumns = ['h.id as id', 'h.rel as pid'];}}else {$vee87bc8747ad849f76f9f6c9f6a6f6ed = in_array('DISTINCT', $this->queryOptions);if ($this->selector->mode == 'objects') {$this->queryColumns = $vee87bc8747ad849f76f9f6c9f6a6f6ed ? ['COUNT(DISTINCT o.id)'] : ['COUNT(o.id)'];}else {$this->queryColumns = $vee87bc8747ad849f76f9f6c9f6a6f6ed ? ['COUNT(DISTINCT h.id)'] : ['COUNT(h.id)'];}}$v5a6f85b0e2c34b7c96af65b0f54b4dea = $this->buildColumns();return <<<SQL
SELECT {$v39daa41bf389071ad9cd7a7a0ad2ff2c} {$v5a6f85b0e2c34b7c96af65b0f54b4dea}
	FROM {$v75a8be0fca0bc0497c40180b6d02d580}
	{$v0b63a75de116aadef5f4aed3dc3b7d87}
	{$vccc9e74cf27019ed02701010da900d6d}
	{$ve22c565b90e9a278849f2d61d78e8388}
	{$va85bfb9c6bcd889ceb433a1c9cd4b218}
	{$vc6c12f4db6ba0426c8e023cb1ca31038}
SQL;  }protected function buildOptions($v15d61712450a686a7f365adf4fef581f) {$v56b07ca9227f50ef928ccc932038180f = $this->queryOptions;$v56b07ca9227f50ef928ccc932038180f = array_unique($v56b07ca9227f50ef928ccc932038180f);if (MAX_SELECTION_TABLE_JOINS > 0 && MAX_SELECTION_TABLE_JOINS < umiCount($this->queryJoinTables)) {$v56b07ca9227f50ef928ccc932038180f[] = 'STRAIGHT_JOIN';}if ($v15d61712450a686a7f365adf4fef581f == 'result' && !$this->selector->option('no-length')->value) {$v56b07ca9227f50ef928ccc932038180f[] = 'SQL_CALC_FOUND_ROWS';}return implode(' ', $v56b07ca9227f50ef928ccc932038180f);}protected function buildLeftJoins() {$va12b4ea43cb390c701ca21b24717887a = [];$vbdf7216b52ab1c35e07a5ba2def35348 = [];$vd05b6ed7d2345020440df396d6da7f73 = [];$v0cc53116375bee4529f23b0f2f407df5 = array_merge(    $this->selector->orderFieldProps,    $this->selector->whereFieldProps,    $this->selector->groupFieldProps   );foreach ($v0cc53116375bee4529f23b0f2f407df5 as $v8040c3c227f813496fd957249478b6e3) {if (!is_callable([$v8040c3c227f813496fd957249478b6e3, 'getFieldIdList'])) {continue;}$vd05b6ed7d2345020440df396d6da7f73 = array_merge($vd05b6ed7d2345020440df396d6da7f73, $v8040c3c227f813496fd957249478b6e3->getFieldIdList());}$vd05b6ed7d2345020440df396d6da7f73 = array_unique($vd05b6ed7d2345020440df396d6da7f73);foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v945100186b119048837b9859c2c46410) {if (in_array($v945100186b119048837b9859c2c46410, $vbdf7216b52ab1c35e07a5ba2def35348)) {continue;}$this->requireTable('o', 'cms3_objects');$v80071f37861c360a27b7327e132c911a = self::getContentTableName($this->selector, $v945100186b119048837b9859c2c46410);$v731b886d80d2ea138da54d30f43b2005 = <<<SQL
LEFT JOIN {$v80071f37861c360a27b7327e132c911a} oc_{$v945100186b119048837b9859c2c46410}_lj ON oc_{$v945100186b119048837b9859c2c46410}_lj.obj_id=o.id AND oc_{$v945100186b119048837b9859c2c46410}_lj.field_id = '{$v945100186b119048837b9859c2c46410}'
SQL;    $va12b4ea43cb390c701ca21b24717887a[] = $v731b886d80d2ea138da54d30f43b2005;$vbdf7216b52ab1c35e07a5ba2def35348[] = $v945100186b119048837b9859c2c46410;$this->queryJoinTables[] = $v80071f37861c360a27b7327e132c911a;}foreach ($this->getLeftJoins() as $v80071f37861c360a27b7327e132c911a => $v3f9178c25b78ed8bed19091bcb62e266) {$v731b886d80d2ea138da54d30f43b2005 = <<<SQL
LEFT JOIN $v80071f37861c360a27b7327e132c911a ON $v3f9178c25b78ed8bed19091bcb62e266
SQL;    $va12b4ea43cb390c701ca21b24717887a[] = $v731b886d80d2ea138da54d30f43b2005;$this->queryJoinTables[] = $v80071f37861c360a27b7327e132c911a;}return empty($va12b4ea43cb390c701ca21b24717887a) ? '' : implode(' ', $va12b4ea43cb390c701ca21b24717887a);}protected function buildColumns() {return implode(', ', $this->queryColumns);}protected function buildTables() {$v9ab2ec7ea4a2041306f7bdf150fcd453 = [];$v00a9a809ad34d904aba9c5b4875643e2 = false;foreach ($this->queryTables as $v724874d1be77f450a09b305fc1534afb => $vb068931cc450442b63f5b3d276ea4297) {if ($vb068931cc450442b63f5b3d276ea4297 == 'cms3_objects' && $v00a9a809ad34d904aba9c5b4875643e2 === false) {$v00a9a809ad34d904aba9c5b4875643e2 = $v724874d1be77f450a09b305fc1534afb;continue;}if ($this->isContentTable($vb068931cc450442b63f5b3d276ea4297) && ($v724874d1be77f450a09b305fc1534afb != 'o_asteriks')) {continue;}$v9ab2ec7ea4a2041306f7bdf150fcd453[] = $vb068931cc450442b63f5b3d276ea4297 . ' ' . $v724874d1be77f450a09b305fc1534afb;}if ($v00a9a809ad34d904aba9c5b4875643e2 !== false) {$v9ab2ec7ea4a2041306f7bdf150fcd453[] = $this->queryTables[$v00a9a809ad34d904aba9c5b4875643e2] . ' ' . $v00a9a809ad34d904aba9c5b4875643e2;}return implode(', ', $v9ab2ec7ea4a2041306f7bdf150fcd453);}private function getPageResult(array $vbf95cbea2fbc6aab956a058a7afb3e45) {if (empty($vbf95cbea2fbc6aab956a058a7afb3e45)) {return [];}umiLinksHelper::getInstance()    ->loadLinkPartForPages($vbf95cbea2fbc6aab956a058a7afb3e45);$v26d59e24afcb9c11f03ffe8392b68734 = $this->getPageRowList($vbf95cbea2fbc6aab956a058a7afb3e45);$vf199b1baa285e954ccf1cddbc6f77a00 = (array) $this->selector->option('return')->value;$vaecdadec28ac4a6fcf20144900a320de = count($vf199b1baa285e954ccf1cddbc6f77a00);$v90361ac1bd15f5f11e68905455c842cf = $vaecdadec28ac4a6fcf20144900a320de == 1 && getFirstValue($vf199b1baa285e954ccf1cddbc6f77a00) == 'id';$v6f4e3065b4fc940b6818c706115e29d1 = [];if ($v90361ac1bd15f5f11e68905455c842cf) {foreach ($v26d59e24afcb9c11f03ffe8392b68734 as $vf1965a857bc285d26fe22023aa5ab50d) {$vb80bb7740288fda1f201890375a60c8f = getFirstValue($vf1965a857bc285d26fe22023aa5ab50d);$v6f4e3065b4fc940b6818c706115e29d1[$vb80bb7740288fda1f201890375a60c8f] = [      'id' => $vb80bb7740288fda1f201890375a60c8f     ];}$v6f4e3065b4fc940b6818c706115e29d1 = array_values($v6f4e3065b4fc940b6818c706115e29d1);return def_module::sortObjects($vbf95cbea2fbc6aab956a058a7afb3e45, $v6f4e3065b4fc940b6818c706115e29d1);}$vf8aea31a0fd948447674cb859137e6e7 = umiHierarchy::getInstance();$v91c8246e48b278ccf9e985d258de9cc9 = [];$v9602dd5efeb5e02a7e5f213e91c017a7 = [];foreach ($v26d59e24afcb9c11f03ffe8392b68734 as $vf1965a857bc285d26fe22023aa5ab50d) {$vb80bb7740288fda1f201890375a60c8f = getFirstValue($vf1965a857bc285d26fe22023aa5ab50d);$v71860c77c6745379b0d44304d66b6a13 = $vf8aea31a0fd948447674cb859137e6e7->getElement($vb80bb7740288fda1f201890375a60c8f, true, true, array_slice($vf1965a857bc285d26fe22023aa5ab50d, 1));if ($v71860c77c6745379b0d44304d66b6a13 instanceof iUmiHierarchyElement) {$v91c8246e48b278ccf9e985d258de9cc9[] = $v71860c77c6745379b0d44304d66b6a13;$v9602dd5efeb5e02a7e5f213e91c017a7[] = $v71860c77c6745379b0d44304d66b6a13->getObjectId();}}$v5c9c5f5e4b3be9548b0bd9be8a645f14 = $vaecdadec28ac4a6fcf20144900a320de > 0;if (!empty($v9602dd5efeb5e02a7e5f213e91c017a7) && ($v5c9c5f5e4b3be9548b0bd9be8a645f14 || $this->selector->option('load-all-props')->value)) {umiObjectProperty::loadPropsData($v9602dd5efeb5e02a7e5f213e91c017a7);}if (!$v5c9c5f5e4b3be9548b0bd9be8a645f14) {$v91c8246e48b278ccf9e985d258de9cc9 = array_values($v91c8246e48b278ccf9e985d258de9cc9);return def_module::sortObjects($vbf95cbea2fbc6aab956a058a7afb3e45, $v91c8246e48b278ccf9e985d258de9cc9);}foreach ($v91c8246e48b278ccf9e985d258de9cc9 as $v71860c77c6745379b0d44304d66b6a13) {$v69fe4aec8073954bf273e3113edd24cf = [];foreach ($vf199b1baa285e954ccf1cddbc6f77a00 as $v972bf3f05d14ffbdb817bef60638ff00) {$v69fe4aec8073954bf273e3113edd24cf[$v972bf3f05d14ffbdb817bef60638ff00] = $this->getPageValue($v972bf3f05d14ffbdb817bef60638ff00, $v71860c77c6745379b0d44304d66b6a13);}if (!isset($v69fe4aec8073954bf273e3113edd24cf['id'])) {$v69fe4aec8073954bf273e3113edd24cf['id'] = $v71860c77c6745379b0d44304d66b6a13->getId();}$v6f4e3065b4fc940b6818c706115e29d1[$v71860c77c6745379b0d44304d66b6a13->getId()] = $v69fe4aec8073954bf273e3113edd24cf;}$v6f4e3065b4fc940b6818c706115e29d1 = array_values($v6f4e3065b4fc940b6818c706115e29d1);return def_module::sortObjects($vbf95cbea2fbc6aab956a058a7afb3e45, $v6f4e3065b4fc940b6818c706115e29d1);}private function getPageRowList(array $vbf95cbea2fbc6aab956a058a7afb3e45) {$v04bcd7bb74fe34df4ea2ae038eeb082d = implode(',', $vbf95cbea2fbc6aab956a058a7afb3e45);$vaa9f73eea60a006820d0f8768bc8a3fc = count($vbf95cbea2fbc6aab956a058a7afb3e45);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT
	h.id,
	h.rel,
	h.type_id,
	h.lang_id,
	h.domain_id,
	h.tpl_id,
	h.obj_id,
	h.ord,
	h.alt_name,
	h.is_active,
	h.is_visible,
	h.is_deleted,
	h.updatetime,
	h.is_default,
	o.name,
	o.type_id,
	o.is_locked,
	o.owner_id,
	o.guid,
	t.guid,
	o.updatetime,
	o.ord
FROM cms3_hierarchy h, cms3_objects o, cms3_object_types t
WHERE 
	h.id IN ($v04bcd7bb74fe34df4ea2ae038eeb082d)
	AND o.id = h.obj_id
	AND o.type_id = t.id
LIMIT 0, $vaa9f73eea60a006820d0f8768bc8a3fc
SQL;   $v26d59e24afcb9c11f03ffe8392b68734 = ConnectionPool::getInstance()    ->getConnection()    ->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$v26d59e24afcb9c11f03ffe8392b68734->setFetchType(IQueryResult::FETCH_ROW);return $v26d59e24afcb9c11f03ffe8392b68734;}private function getObjectResult(IQueryResult $result) {$result->setFetchType(IQueryResult::FETCH_ROW);$v5a2576254d428ddc22a03fac145c8749 = [];$v143ce450506b6edea68d98ba0662fb4e = [];foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$vb80bb7740288fda1f201890375a60c8f = getFirstValue($vf1965a857bc285d26fe22023aa5ab50d);$v5a2576254d428ddc22a03fac145c8749[] = $vb80bb7740288fda1f201890375a60c8f;$v143ce450506b6edea68d98ba0662fb4e[$vb80bb7740288fda1f201890375a60c8f] = $vf1965a857bc285d26fe22023aa5ab50d;}$v5a2576254d428ddc22a03fac145c8749 = array_unique($v5a2576254d428ddc22a03fac145c8749);$vf199b1baa285e954ccf1cddbc6f77a00 = (array) $this->selector->option('return')->value;$vaecdadec28ac4a6fcf20144900a320de = count($vf199b1baa285e954ccf1cddbc6f77a00);$v90361ac1bd15f5f11e68905455c842cf = $vaecdadec28ac4a6fcf20144900a320de == 1 && getFirstValue($vf199b1baa285e954ccf1cddbc6f77a00) == 'id';$v5c9c5f5e4b3be9548b0bd9be8a645f14 = $vaecdadec28ac4a6fcf20144900a320de > 0 && !$v90361ac1bd15f5f11e68905455c842cf;if (!empty($v5a2576254d428ddc22a03fac145c8749) && ($v5c9c5f5e4b3be9548b0bd9be8a645f14 || $this->selector->option('load-all-props')->value)) {umiObjectProperty::loadPropsData($v5a2576254d428ddc22a03fac145c8749);}$result = [];$vfa5a883455df69e98c0f154ad0e5d47b = umiObjectsCollection::getInstance();foreach ($v5a2576254d428ddc22a03fac145c8749 as $vb80bb7740288fda1f201890375a60c8f) {$vf1965a857bc285d26fe22023aa5ab50d = $v143ce450506b6edea68d98ba0662fb4e[$vb80bb7740288fda1f201890375a60c8f];switch (true) {case $v90361ac1bd15f5f11e68905455c842cf : {$result[] = [       'id' => $vb80bb7740288fda1f201890375a60c8f      ];break;}case $v5c9c5f5e4b3be9548b0bd9be8a645f14 : {$va8cfde6331bd59eb2ac96f8911c4b666 = $vfa5a883455df69e98c0f154ad0e5d47b->getObject($vb80bb7740288fda1f201890375a60c8f, array_slice($vf1965a857bc285d26fe22023aa5ab50d, 1));if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {break;}$v69fe4aec8073954bf273e3113edd24cf = [];foreach ($vf199b1baa285e954ccf1cddbc6f77a00 as $v972bf3f05d14ffbdb817bef60638ff00) {$v69fe4aec8073954bf273e3113edd24cf[$v972bf3f05d14ffbdb817bef60638ff00] = $this->getObjectValue($v972bf3f05d14ffbdb817bef60638ff00, $va8cfde6331bd59eb2ac96f8911c4b666);}if (!isset($v69fe4aec8073954bf273e3113edd24cf['id'])) {$v69fe4aec8073954bf273e3113edd24cf['id'] = $vb80bb7740288fda1f201890375a60c8f;}$result[] = $v69fe4aec8073954bf273e3113edd24cf;break;}default : {$va8cfde6331bd59eb2ac96f8911c4b666 = $vfa5a883455df69e98c0f154ad0e5d47b->getObject($vb80bb7740288fda1f201890375a60c8f, array_slice($vf1965a857bc285d26fe22023aa5ab50d, 1));if ($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {$result[] = $va8cfde6331bd59eb2ac96f8911c4b666;}}}}return def_module::sortObjects($v5a2576254d428ddc22a03fac145c8749, $result);}private function isContentTable($vaab9e1de16f38176f86d7a92ba337a8d) {$v0d31622bb61ba62769efad1577dd5307 = Service::ObjectPropertyValueTableSchema()    ->getTableList();foreach ($v0d31622bb61ba62769efad1577dd5307 as $v2288347f9a56c335a4d9a5f558fd8ff2) {if (contains($vaab9e1de16f38176f86d7a92ba337a8d, $v2288347f9a56c335a4d9a5f558fd8ff2)) {return true;}}return false;}protected function buildLimit() {if (umiCount($this->queryLimit)) {return " LIMIT {$this->queryLimit[0]}, {$this->queryLimit[1]}";}return '';}protected function buildWhere() {$vac5c74b64b4b8352ef2f181affb5ac2a = '';$vb5b399ec1fcfe753f58dbafa197efdc1 = [];foreach ($this->selector->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if ($v599dcce2998a6b40b1e38e8c6006cb0a->objectTypeIds !== null) {foreach ($v599dcce2998a6b40b1e38e8c6006cb0a->objectTypeIds as $v5f694956811487225d15e973ca38fbab) {$this->objectTypeIds[] = $v5f694956811487225d15e973ca38fbab;}}if ($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyTypeIds !== null) {foreach ($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyTypeIds as $v5f694956811487225d15e973ca38fbab) {$this->hierarchyTypeIds[] = $v5f694956811487225d15e973ca38fbab;}}}$this->hierarchyTypesCount = umiCount($this->hierarchyTypeIds);if (umiCount($this->objectTypeIds)) {$v85cd96ae4e27f5b0cd3b199e4c39879a = array_unique($this->objectTypeIds);$this->requireTable('o', 'cms3_objects');$this->requireTable('t', 'cms3_object_types');if (!$this->selector->option('ignore-children-types')->value) {$va3af0f9ca075e7f0da41533bd46136bb = umiObjectTypesCollection::getInstance()      ->getChildIdListByParentIdList($v85cd96ae4e27f5b0cd3b199e4c39879a);$v85cd96ae4e27f5b0cd3b199e4c39879a = array_merge($v85cd96ae4e27f5b0cd3b199e4c39879a, $va3af0f9ca075e7f0da41533bd46136bb);}$this->objectTypeIds = array_unique($v85cd96ae4e27f5b0cd3b199e4c39879a);$vb5b399ec1fcfe753f58dbafa197efdc1[] = 'o.type_id IN (' . implode(', ', $this->objectTypeIds) . ')';$vb5b399ec1fcfe753f58dbafa197efdc1[] = 't.id = o.type_id';}if (umiCount($this->hierarchyTypeIds) && $this->selector->mode == 'pages') {$this->hierarchyTypeIds = array_unique($this->hierarchyTypeIds);$vb5b399ec1fcfe753f58dbafa197efdc1[] = 'h.type_id IN (' . implode(', ', $this->hierarchyTypeIds) . ')';}if (umiCount($this->hierarchyTypeIds) && $this->selector->mode == 'objects') {$this->hierarchyTypeIds = array_unique($this->hierarchyTypeIds);$vb5b399ec1fcfe753f58dbafa197efdc1[] = 't.hierarchy_type_id IN (' . implode(', ', $this->hierarchyTypeIds) . ')';$vb5b399ec1fcfe753f58dbafa197efdc1[] = 't.id = o.type_id';}if ($this->selector->mode == 'objects' && !in_array('t.id = o.type_id', $vb5b399ec1fcfe753f58dbafa197efdc1)) {$vb5b399ec1fcfe753f58dbafa197efdc1[] = 't.id = o.type_id';}if (umiCount($this->queryFields) || umiCount($this->orderFields) || umiCount($this->groupFields)) {$this->requireTable('o', 'cms3_objects');}$v59e71cf632cfb0b5a93f3ecf820a05ad = umiFieldsCollection::getInstance();$vae1d6a6518a73b480c52bcf30553f9f8 = $this->selector->option('or-mode');$v72a5c3737c7dc5c19edd586e78636de4 = [];$v1d065a6970097a2fbab9673683ea1573 = [];$v2047b716ee590730e0462e0349a7e6b9 = '';$v787f309185a67fadd89e0049db75c51f = isset($vae1d6a6518a73b480c52bcf30553f9f8->value['fields']) ? $vae1d6a6518a73b480c52bcf30553f9f8->value['fields'] : [];foreach ($this->queryFields as $v945100186b119048837b9859c2c46410) {if (in_array($v59e71cf632cfb0b5a93f3ecf820a05ad->getField($v945100186b119048837b9859c2c46410)->getName(), $v787f309185a67fadd89e0049db75c51f)) {$v1d065a6970097a2fbab9673683ea1573[] = $this->buildWhereValue($v945100186b119048837b9859c2c46410);}else {$v72a5c3737c7dc5c19edd586e78636de4[] = $this->buildWhereValue($v945100186b119048837b9859c2c46410);}}$v620d6d4d09a18d4c5fdc7fa1abae6149 = $this->selector->whereSysProps;foreach ($v620d6d4d09a18d4c5fdc7fa1abae6149 as $ve7b2acf954344b64ff7a1bdef7490812) {$v46b9e6004c49d9cc040029c197cab278 = $ve7b2acf954344b64ff7a1bdef7490812->name;if (in_array($v46b9e6004c49d9cc040029c197cab278, $v787f309185a67fadd89e0049db75c51f)) {$v1d065a6970097a2fbab9673683ea1573[$v46b9e6004c49d9cc040029c197cab278] = $this->buildSysProp($ve7b2acf954344b64ff7a1bdef7490812);}}if (count($v72a5c3737c7dc5c19edd586e78636de4) || count($v1d065a6970097a2fbab9673683ea1573)) {if (isset($vae1d6a6518a73b480c52bcf30553f9f8->value['all'])) {$v72a5c3737c7dc5c19edd586e78636de4 = array_merge($v72a5c3737c7dc5c19edd586e78636de4, $v1d065a6970097a2fbab9673683ea1573);$v2047b716ee590730e0462e0349a7e6b9 = implode(' OR ', $v72a5c3737c7dc5c19edd586e78636de4);}else {if (count($v72a5c3737c7dc5c19edd586e78636de4) > 0) {$v2047b716ee590730e0462e0349a7e6b9 .= implode(' AND ', $v72a5c3737c7dc5c19edd586e78636de4);if (count($v1d065a6970097a2fbab9673683ea1573)) {$v2047b716ee590730e0462e0349a7e6b9 .= ' AND ';}}$v2047b716ee590730e0462e0349a7e6b9 .= $this->getOrModeCondition($v1d065a6970097a2fbab9673683ea1573);}$vb5b399ec1fcfe753f58dbafa197efdc1[] = '(' . $v2047b716ee590730e0462e0349a7e6b9 . ')';}$v8449d31fd3dcf905d928b92015d3dbf5 = [];foreach ($v620d6d4d09a18d4c5fdc7fa1abae6149 as $ve7b2acf954344b64ff7a1bdef7490812) {$v3f9178c25b78ed8bed19091bcb62e266 = $this->buildSysProp($ve7b2acf954344b64ff7a1bdef7490812);$v46b9e6004c49d9cc040029c197cab278 = $ve7b2acf954344b64ff7a1bdef7490812->name;$v8449d31fd3dcf905d928b92015d3dbf5[$v46b9e6004c49d9cc040029c197cab278] = isset($v8449d31fd3dcf905d928b92015d3dbf5[$v46b9e6004c49d9cc040029c197cab278]) ? $v8449d31fd3dcf905d928b92015d3dbf5[$v46b9e6004c49d9cc040029c197cab278] : [];$v7d20f0252b0a6462a3ef085f40b1ab2e = (isset($vae1d6a6518a73b480c52bcf30553f9f8->value['field']) && in_array($v46b9e6004c49d9cc040029c197cab278, $vae1d6a6518a73b480c52bcf30553f9f8->value['field']));switch (true) {case isset($v1d065a6970097a2fbab9673683ea1573[$v46b9e6004c49d9cc040029c197cab278]): {break;}case $v7d20f0252b0a6462a3ef085f40b1ab2e && !$v3f9178c25b78ed8bed19091bcb62e266: {$v8449d31fd3dcf905d928b92015d3dbf5[$v46b9e6004c49d9cc040029c197cab278] = [];break;}case $v7d20f0252b0a6462a3ef085f40b1ab2e: {$v8449d31fd3dcf905d928b92015d3dbf5[$v46b9e6004c49d9cc040029c197cab278][] = $v3f9178c25b78ed8bed19091bcb62e266;break;}case !$v7d20f0252b0a6462a3ef085f40b1ab2e && !$v3f9178c25b78ed8bed19091bcb62e266: {unset($vb5b399ec1fcfe753f58dbafa197efdc1[$v46b9e6004c49d9cc040029c197cab278]);break;}case !$v7d20f0252b0a6462a3ef085f40b1ab2e: {$vb5b399ec1fcfe753f58dbafa197efdc1[$v46b9e6004c49d9cc040029c197cab278] = $v3f9178c25b78ed8bed19091bcb62e266;break;}}}if ($this->selector->mode == 'pages') {$vc59a4dbfd0b091548a2f1d692a2a7c01 = $this->buildPermissions();if ($vc59a4dbfd0b091548a2f1d692a2a7c01) {$vb5b399ec1fcfe753f58dbafa197efdc1[] = $vc59a4dbfd0b091548a2f1d692a2a7c01;}$v5b20cfc8862f370a9201f62df14c09c2 = $this->buildHierarchy($vb5b399ec1fcfe753f58dbafa197efdc1);if ($v5b20cfc8862f370a9201f62df14c09c2) {$vb5b399ec1fcfe753f58dbafa197efdc1[] = $v5b20cfc8862f370a9201f62df14c09c2;}if (isset($this->queryTables['o'])) {$vb5b399ec1fcfe753f58dbafa197efdc1[] = 'h.obj_id = o.id';}}$vac5c74b64b4b8352ef2f181affb5ac2a .= implode(' AND ', $vb5b399ec1fcfe753f58dbafa197efdc1);if ($vac5c74b64b4b8352ef2f181affb5ac2a) {$vac5c74b64b4b8352ef2f181affb5ac2a = 'WHERE ' . $vac5c74b64b4b8352ef2f181affb5ac2a;}if (umiCount($v8449d31fd3dcf905d928b92015d3dbf5) > 0) {foreach ($v8449d31fd3dcf905d928b92015d3dbf5 as $vfb4d164c5132545e2aea870614a0d48f) {if (umiCount($vfb4d164c5132545e2aea870614a0d48f) > 1) {$vac5c74b64b4b8352ef2f181affb5ac2a .= ' AND (' . implode(' OR ', $vfb4d164c5132545e2aea870614a0d48f) . ')';}}}return $vac5c74b64b4b8352ef2f181affb5ac2a;}private function getOrModeCondition(array $v46f1e697acefc3e02f491d3f5051d043) {$v2cd749da3703b31c0e9a91bc105d3090 = count($v46f1e697acefc3e02f491d3f5051d043);if ($v2cd749da3703b31c0e9a91bc105d3090 === 0) {return '';}if ($v46f1e697acefc3e02f491d3f5051d043 === 1) {return getFirstValue($v46f1e697acefc3e02f491d3f5051d043);}$v1f16872429041547189178e4655b78c4 = 0;foreach ($v46f1e697acefc3e02f491d3f5051d043 as $v3f9178c25b78ed8bed19091bcb62e266) {if (contains($v3f9178c25b78ed8bed19091bcb62e266, 'NULL')) {$v1f16872429041547189178e4655b78c4++;}}$v787f309185a67fadd89e0049db75c51f = (array) $this->selector->option('or-mode')->value['fields'];$vcffd0b6e4799285438220f65fa516160 = count($this->queryFields) !== count($v787f309185a67fadd89e0049db75c51f);$v266743422b7d83ac36e19fcb0ca16f9e = ' AND ';if ($v1f16872429041547189178e4655b78c4 !==  $v2cd749da3703b31c0e9a91bc105d3090 || !$vcffd0b6e4799285438220f65fa516160) {$v266743422b7d83ac36e19fcb0ca16f9e = ' OR ';}return '(' . implode($v266743422b7d83ac36e19fcb0ca16f9e, $v46f1e697acefc3e02f491d3f5051d043) . ')';}protected function buildWhereValue($v945100186b119048837b9859c2c46410) {$v173936e059d215ede2e8b723a6165878 = $this->selector->whereFieldProps;$v43b5c9175984c071f30b873fdce0a000 = [];foreach ($v173936e059d215ede2e8b723a6165878 as $v567904efe9e64d9faf3e41ef402cb568) {if (!$v567904efe9e64d9faf3e41ef402cb568 instanceof selectorWhereFieldProp) {continue;}if (in_array($v945100186b119048837b9859c2c46410, $v567904efe9e64d9faf3e41ef402cb568->getFieldIdList())) {$v43b5c9175984c071f30b873fdce0a000[] = $v567904efe9e64d9faf3e41ef402cb568;}}$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98 = [];foreach ($v43b5c9175984c071f30b873fdce0a000 as $v567904efe9e64d9faf3e41ef402cb568) {switch ($v1afd32818d1c9525f82aff4c09efd254) {case false: {if (umiCount($v567904efe9e64d9faf3e41ef402cb568->value) == 1) {$v14f802e1fba977727845e8872c1743a7 = array_keys($v567904efe9e64d9faf3e41ef402cb568->value);$v1afd32818d1c9525f82aff4c09efd254 = array_pop($v14f802e1fba977727845e8872c1743a7) . '_val';break;}continue 2;}case 'img_file' :     case 'multiple_image' : {if (is_array($v567904efe9e64d9faf3e41ef402cb568->value) && count($v567904efe9e64d9faf3e41ef402cb568->value) == 1) {$v14f802e1fba977727845e8872c1743a7 = array_keys($v567904efe9e64d9faf3e41ef402cb568->value);$v1afd32818d1c9525f82aff4c09efd254 = array_pop($v14f802e1fba977727845e8872c1743a7);break;}$v1afd32818d1c9525f82aff4c09efd254 = 'src';break;continue 2;}}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);if ($v06e3d36fa30cea095545139854ad1fb9->getDataType() === 'file' || ($v06e3d36fa30cea095545139854ad1fb9->getDataType() === 'img_file' && $v1afd32818d1c9525f82aff4c09efd254 === 'src')) {$v567904efe9e64d9faf3e41ef402cb568->value = $this->prepareFileValue($v567904efe9e64d9faf3e41ef402cb568->value, $v567904efe9e64d9faf3e41ef402cb568->mode);}$v3f9178c25b78ed8bed19091bcb62e266 = $this->parseValue($v567904efe9e64d9faf3e41ef402cb568->mode, $v567904efe9e64d9faf3e41ef402cb568->value, "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}", $v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98[] = ($v567904efe9e64d9faf3e41ef402cb568->mode == 'notequals')     ? "(oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}{$v3f9178c25b78ed8bed19091bcb62e266})"     : "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}{$v3f9178c25b78ed8bed19091bcb62e266}";}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);$v9129be9157de7546ad9a50df5f46dda3 = $this->selector->option('or-mode');if (isset($v9129be9157de7546ad9a50df5f46dda3->value['all']) ||    (isset($v9129be9157de7546ad9a50df5f46dda3->value['field']) && in_array($v06e3d36fa30cea095545139854ad1fb9->getName(), $v9129be9157de7546ad9a50df5f46dda3->value['field']))) {$veaae0796859eed71de2b22d27b57296b = ' OR ';$this->queryOptions[] = 'DISTINCT';}else {$veaae0796859eed71de2b22d27b57296b = ' AND ';}$vac5c74b64b4b8352ef2f181affb5ac2a = implode($veaae0796859eed71de2b22d27b57296b, array_unique($vb71a97a0f96cb8b238309d23a188ae98));return $vac5c74b64b4b8352ef2f181affb5ac2a ? (umiCount($vb71a97a0f96cb8b238309d23a188ae98) > 1 ? '(' . $vac5c74b64b4b8352ef2f181affb5ac2a . ')' : $vac5c74b64b4b8352ef2f181affb5ac2a) : '';}protected function prepareFileValue($v2063c1608d6e0baf80249c42e2be5804, $v15d61712450a686a7f365adf4fef581f) {if (!in_array($v15d61712450a686a7f365adf4fef581f, ['equals', 'notequals'])) {return $v2063c1608d6e0baf80249c42e2be5804;}$vf5cc9c66a4048129e3de2d80777685dc = [];switch (true) {case (is_array($v2063c1608d6e0baf80249c42e2be5804) && count($v2063c1608d6e0baf80249c42e2be5804) === 1 && isset($v2063c1608d6e0baf80249c42e2be5804['src'])) : {$vf5cc9c66a4048129e3de2d80777685dc[] = $v2063c1608d6e0baf80249c42e2be5804['src'];break;}case is_array($v2063c1608d6e0baf80249c42e2be5804) : {$vf5cc9c66a4048129e3de2d80777685dc = $v2063c1608d6e0baf80249c42e2be5804;break;}case is_string($v2063c1608d6e0baf80249c42e2be5804) : {$vf5cc9c66a4048129e3de2d80777685dc[] = $v2063c1608d6e0baf80249c42e2be5804;break;}}$vf0f5e976c2b2d0e3d85e32e3da670f42 = [];foreach ($vf5cc9c66a4048129e3de2d80777685dc as $vd6fe1d0be6347b8ef2427fa629c04485) {$v8c7dd922ad47494fc02c388e12c00eac = Service::FileFactory()->createSecure($vd6fe1d0be6347b8ef2427fa629c04485);$v701f5694ede3230b3aa5e85d71896aaa = [     $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(),     '.' . $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(true),    ];$vf0f5e976c2b2d0e3d85e32e3da670f42 += $v701f5694ede3230b3aa5e85d71896aaa;}return $vf0f5e976c2b2d0e3d85e32e3da670f42;}protected function parseValue($v15d61712450a686a7f365adf4fef581f, $v2063c1608d6e0baf80249c42e2be5804, $v1afd32818d1c9525f82aff4c09efd254 = false, $v945100186b119048837b9859c2c46410 = false) {switch ($v15d61712450a686a7f365adf4fef581f) {case 'equals':     switch (true) {case (is_array($v2063c1608d6e0baf80249c42e2be5804) || is_object($v2063c1608d6e0baf80249c42e2be5804)): {$v2063c1608d6e0baf80249c42e2be5804 = $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);if (umiCount($v2063c1608d6e0baf80249c42e2be5804)) {return ' IN(' . implode(', ', $v2063c1608d6e0baf80249c42e2be5804) . ')';}return ' = 0 = 1';}case ($v2063c1608d6e0baf80249c42e2be5804 == 0 && $v945100186b119048837b9859c2c46410): {$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);if ($v06e3d36fa30cea095545139854ad1fb9->getDataType() == 'boolean') {return ' IS NULL';}return ' = ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);}default: {return ' = ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);}}break;case 'notequals':     if (is_array($v2063c1608d6e0baf80249c42e2be5804) || is_object($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);if (umiCount($v2063c1608d6e0baf80249c42e2be5804)) {return ' NOT IN(' . implode(', ', $v2063c1608d6e0baf80249c42e2be5804) . ')' . ($v1afd32818d1c9525f82aff4c09efd254 ? " OR {$v1afd32818d1c9525f82aff4c09efd254} IS NULL" : '');}return ' = 0 = 1';}return ' != ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804) . ($v1afd32818d1c9525f82aff4c09efd254 ? " OR {$v1afd32818d1c9525f82aff4c09efd254} IS NULL" : '');break;case 'like':     if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {$v46f1e697acefc3e02f491d3f5051d043 = [];foreach ($v2063c1608d6e0baf80249c42e2be5804 as $v447b7147e84be512208dcc0995d67ebc) {$v46f1e697acefc3e02f491d3f5051d043[] = $v1afd32818d1c9525f82aff4c09efd254 . ' ' . $this->parseValue($v15d61712450a686a7f365adf4fef581f, $v447b7147e84be512208dcc0995d67ebc, $v1afd32818d1c9525f82aff4c09efd254, $v945100186b119048837b9859c2c46410);}if (count($v46f1e697acefc3e02f491d3f5051d043) > 0) {return ltrim(implode(' AND ', $v46f1e697acefc3e02f491d3f5051d043), $v1afd32818d1c9525f82aff4c09efd254);}return ' = 0  AND ' . $v1afd32818d1c9525f82aff4c09efd254 . ' = 1';}return ' LIKE ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'ilike':     return $this->parseValue('like', $v2063c1608d6e0baf80249c42e2be5804, $v1afd32818d1c9525f82aff4c09efd254, $v945100186b119048837b9859c2c46410);case 'more':     if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");}return ' > ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'eqmore':     if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");}return ' >= ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'less':     if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");}return ' < ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'eqless':     if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {throw new selectorException("Method \"{$v15d61712450a686a7f365adf4fef581f}\" can't accept array");}return ' <= ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);case 'between':     return ' BETWEEN ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804[0]) . ' AND ' . $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804[1]);case 'isnotnull':     $v2063c1608d6e0baf80249c42e2be5804 = ($v2063c1608d6e0baf80249c42e2be5804 === null) ? true : $v2063c1608d6e0baf80249c42e2be5804;return !$v2063c1608d6e0baf80249c42e2be5804 ? ' IS NULL' : ' IS NOT NULL';case 'isnull':     $v2063c1608d6e0baf80249c42e2be5804 = ($v2063c1608d6e0baf80249c42e2be5804 === null) ? true : $v2063c1608d6e0baf80249c42e2be5804;return $v2063c1608d6e0baf80249c42e2be5804 ? ' IS NULL' : ' IS NOT NULL';default:     throw new selectorException("Unsupported field mode \"{$v15d61712450a686a7f365adf4fef581f}\"");}}protected function buildSysProp(selectorWhereSysProp $v23a5b8ab834cb5140fa6665622eb6417) {if ($v23a5b8ab834cb5140fa6665622eb6417->name == 'domain' || $v23a5b8ab834cb5140fa6665622eb6417->name == 'lang') {if ($v23a5b8ab834cb5140fa6665622eb6417->__get('value') === false) {return false;}}if ($v23a5b8ab834cb5140fa6665622eb6417->name == 'domain') {$vea7a5ff9e872aa9554d2d55b11036c30 = $this->selector->__get('hierarchy');if (umiCount($vea7a5ff9e872aa9554d2d55b11036c30) && $vea7a5ff9e872aa9554d2d55b11036c30[0]->elementId) {return false;}}if ($v23a5b8ab834cb5140fa6665622eb6417->name == '*') {$this->requireTable('o', 'cms3_objects');$v724874d1be77f450a09b305fc1534afb = self::getContentTableName($this->selector, null);$v9ab2ec7ea4a2041306f7bdf150fcd453 = ['o_asteriks'];if ($v724874d1be77f450a09b305fc1534afb != 'cms3_object_content') {$v9ab2ec7ea4a2041306f7bdf150fcd453[] = 'o_asteriks_branched';}$vf09cc7ee3a9a93273f4b80601cafb00c = $v23a5b8ab834cb5140fa6665622eb6417->__get('value');if (!is_array($vf09cc7ee3a9a93273f4b80601cafb00c)) {$vf09cc7ee3a9a93273f4b80601cafb00c = [$vf09cc7ee3a9a93273f4b80601cafb00c];}$this->queryOptions[] = 'DISTINCT';$vaeca0054bba89f3a0fd055e49ecbc960 = [];$vb5b399ec1fcfe753f58dbafa197efdc1 = [];foreach ($v9ab2ec7ea4a2041306f7bdf150fcd453 as $v80071f37861c360a27b7327e132c911a) {$vc271423d74092340a39090715ad53cad = "{$v80071f37861c360a27b7327e132c911a}_varchar";$v4cdb3f1ea7284f2258d56f0a5d814b7d = "{$v80071f37861c360a27b7327e132c911a}_text";$vaeca0054bba89f3a0fd055e49ecbc960["cms3_object_content {$vc271423d74092340a39090715ad53cad}"] =      "{$vc271423d74092340a39090715ad53cad}.obj_id=o.id AND {$vc271423d74092340a39090715ad53cad}.varchar_val IS NOT NULL";$vaeca0054bba89f3a0fd055e49ecbc960["cms3_object_content {$v4cdb3f1ea7284f2258d56f0a5d814b7d}"] =      "{$v4cdb3f1ea7284f2258d56f0a5d814b7d}.obj_id=o.id AND {$v4cdb3f1ea7284f2258d56f0a5d814b7d}.text_val IS NOT NULL";foreach ($vf09cc7ee3a9a93273f4b80601cafb00c as $v2063c1608d6e0baf80249c42e2be5804) {$v704c580ebcb03db9ee84b85d4cef9244 = $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804);$v3b0653167575809a787a1b740f1c89c0 = $this->escapeValue('%' . $v2063c1608d6e0baf80249c42e2be5804 . '%');$vb5b399ec1fcfe753f58dbafa197efdc1[] = "{$vc271423d74092340a39090715ad53cad}.varchar_val LIKE $v3b0653167575809a787a1b740f1c89c0";$vb5b399ec1fcfe753f58dbafa197efdc1[] = "{$v4cdb3f1ea7284f2258d56f0a5d814b7d}.text_val LIKE $v3b0653167575809a787a1b740f1c89c0";$vb5b399ec1fcfe753f58dbafa197efdc1[] = "o.name LIKE $v3b0653167575809a787a1b740f1c89c0";if (is_numeric($v2063c1608d6e0baf80249c42e2be5804)) {$vf23b3f79fe1cc8e7750d150d30330d74 = "{$v80071f37861c360a27b7327e132c911a}_float";$vcca2614d0ef6adbb198a13178f721a56 = "{$v80071f37861c360a27b7327e132c911a}_int";$vaeca0054bba89f3a0fd055e49ecbc960["cms3_object_content {$vf23b3f79fe1cc8e7750d150d30330d74}"] =        "{$vf23b3f79fe1cc8e7750d150d30330d74}.obj_id=o.id AND {$vf23b3f79fe1cc8e7750d150d30330d74}.float_val IS NOT NULL";$vaeca0054bba89f3a0fd055e49ecbc960["cms3_object_content {$vcca2614d0ef6adbb198a13178f721a56}"] =        "{$vcca2614d0ef6adbb198a13178f721a56}.obj_id=o.id AND {$vcca2614d0ef6adbb198a13178f721a56}.int_val IS NOT NULL";$vb5b399ec1fcfe753f58dbafa197efdc1[] = "{$vf23b3f79fe1cc8e7750d150d30330d74}.float_val = $v704c580ebcb03db9ee84b85d4cef9244";$vb5b399ec1fcfe753f58dbafa197efdc1[] = "{$vcca2614d0ef6adbb198a13178f721a56}.int_val = $v704c580ebcb03db9ee84b85d4cef9244";}}}$this->setLeftJoins($vaeca0054bba89f3a0fd055e49ecbc960);return '(' . implode(' OR ', $vb5b399ec1fcfe753f58dbafa197efdc1) . ')';}$ve750674c53b57441a8c5fc5160c17521 = !$this->selector->option('ignore-translate')->value;if ($v23a5b8ab834cb5140fa6665622eb6417->name == 'name' && $ve750674c53b57441a8c5fc5160c17521) {$v23a5b8ab834cb5140fa6665622eb6417 = $this->append18nMarksToPropValue($v23a5b8ab834cb5140fa6665622eb6417);}$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($v23a5b8ab834cb5140fa6665622eb6417->name);$vac5c74b64b4b8352ef2f181affb5ac2a = "{$vb068931cc450442b63f5b3d276ea4297}" . $this->parseValue($v23a5b8ab834cb5140fa6665622eb6417->__get('mode'), $v23a5b8ab834cb5140fa6665622eb6417->__get('value'), $vb068931cc450442b63f5b3d276ea4297);return ($v23a5b8ab834cb5140fa6665622eb6417->__get('mode') == 'notequals') ? '(' . $vac5c74b64b4b8352ef2f181affb5ac2a . ')' : $vac5c74b64b4b8352ef2f181affb5ac2a;}protected function append18nMarksToPropValue(selectorWhereProp $v1a8db4c996d8ed8289da5f957879ab94) {if (!in_array($v1a8db4c996d8ed8289da5f957879ab94->__get('mode'), ['equals', 'notequals'])) {return $v1a8db4c996d8ed8289da5f957879ab94;}$v8b4d1617f55e9404b749d88dc02ee6a4 = (array) $v1a8db4c996d8ed8289da5f957879ab94->__get('value');$v1d493d6fdff6eb0d3f6910a2bd59b7d1 = [];foreach ($v8b4d1617f55e9404b749d88dc02ee6a4 as $v2063c1608d6e0baf80249c42e2be5804) {if (!is_string($v2063c1608d6e0baf80249c42e2be5804) || $v2063c1608d6e0baf80249c42e2be5804 === '') {continue;}$vea82410c7a9991816b5eeeebe195e20a = getI18n($v2063c1608d6e0baf80249c42e2be5804);if (!is_string($v2063c1608d6e0baf80249c42e2be5804) || $v2063c1608d6e0baf80249c42e2be5804 === '') {continue;}$v1d493d6fdff6eb0d3f6910a2bd59b7d1[] = $vea82410c7a9991816b5eeeebe195e20a;}return $v1a8db4c996d8ed8289da5f957879ab94->__set('value', array_merge($v8b4d1617f55e9404b749d88dc02ee6a4, $v1d493d6fdff6eb0d3f6910a2bd59b7d1));}protected function buildOrder() {$vb71a97a0f96cb8b238309d23a188ae98 = [];foreach ($this->selector->orderFieldProps as $v70a17ffa722a3985b86d30b034ad06d7) {if (!$v70a17ffa722a3985b86d30b034ad06d7 instanceof selectorOrderFieldProp) {continue;}foreach ($v70a17ffa722a3985b86d30b034ad06d7->getFieldIdList() as $v945100186b119048837b9859c2c46410) {$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98[] = "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254} " . ($v70a17ffa722a3985b86d30b034ad06d7->asc ? 'ASC' : 'DESC');}}foreach ($this->selector->orderSysProps as $v70a17ffa722a3985b86d30b034ad06d7) {$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($v70a17ffa722a3985b86d30b034ad06d7->name);$vb71a97a0f96cb8b238309d23a188ae98[] = $vb068931cc450442b63f5b3d276ea4297 . ' ' . ($v70a17ffa722a3985b86d30b034ad06d7->asc ? 'ASC' : 'DESC');}$vac5c74b64b4b8352ef2f181affb5ac2a = implode(', ', $vb71a97a0f96cb8b238309d23a188ae98);return $vac5c74b64b4b8352ef2f181affb5ac2a ? 'ORDER BY ' . $vac5c74b64b4b8352ef2f181affb5ac2a : '';}protected function buildGroup() {$vb71a97a0f96cb8b238309d23a188ae98 = [];foreach ($this->selector->groupFieldProps as $vdb0f6f37ebeb6ea09489124345af2a45) {if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof selectorGroupFieldProp) {continue;}foreach ($vdb0f6f37ebeb6ea09489124345af2a45->getFieldIdList() as $v945100186b119048837b9859c2c46410) {$v1afd32818d1c9525f82aff4c09efd254 = self::getFieldColumn($v945100186b119048837b9859c2c46410);$vb71a97a0f96cb8b238309d23a188ae98[] = "oc_{$v945100186b119048837b9859c2c46410}_lj.{$v1afd32818d1c9525f82aff4c09efd254}";}}foreach ($this->selector->groupSysProps as $vdb0f6f37ebeb6ea09489124345af2a45) {$vb068931cc450442b63f5b3d276ea4297 = $this->requireSysProp($vdb0f6f37ebeb6ea09489124345af2a45->name);$vb71a97a0f96cb8b238309d23a188ae98[] = $vb068931cc450442b63f5b3d276ea4297;}$vac5c74b64b4b8352ef2f181affb5ac2a = implode(', ', $vb71a97a0f96cb8b238309d23a188ae98);return $vac5c74b64b4b8352ef2f181affb5ac2a ? 'GROUP BY ' . $vac5c74b64b4b8352ef2f181affb5ac2a : '';}protected function buildPermissions() {$this->queryOptions[] = 'DISTINCT';if ($this->selector->option('no-permissions')->value) {return '';}$permissions = $this->selector->permissions;$vb132392a317588e56460e77a8fd74229 = $permissions->owners;if ($permissions && umiCount($vb132392a317588e56460e77a8fd74229)) {$this->requireTable('p', 'cms3_permissions');$v1876714ec08549d69462e2d7617c83c8 = Service::SystemUsersPermissions();$v92ad7554e2e0d208f33729db6d54b59b = $v1876714ec08549d69462e2d7617c83c8->getGuestUserId();if (!in_array($v92ad7554e2e0d208f33729db6d54b59b, $vb132392a317588e56460e77a8fd74229)) {$vb132392a317588e56460e77a8fd74229[] = $v92ad7554e2e0d208f33729db6d54b59b;}$vb132392a317588e56460e77a8fd74229 = implode(', ', $vb132392a317588e56460e77a8fd74229);return "(p.rel_id = h.id AND p.level & {$permissions->level} AND p.owner_id IN({$vb132392a317588e56460e77a8fd74229}))";}return '';}protected function buildHierarchy($vb71a97a0f96cb8b238309d23a188ae98) {$vb81ca7c0ccaa77e7aa91936ab0070695 = $this->selector->hierarchy;if (umiCount($vb81ca7c0ccaa77e7aa91936ab0070695) == 0) {return '';}$v22dbfdaedec7f4873088ebd773f60ff5 = <<<SQL
SELECT
h.id as id,
hr.level as level,
h.rel as rel,
h.ord as ord,
h.is_active as active
FROM
cms3_hierarchy h,
cms3_hierarchy_relations hr
where /**/
SQL;   $vac5c74b64b4b8352ef2f181affb5ac2a = 'h.id = hr.child_id AND ';$v032f3ae7c8ab69e3b2d44917fa7b737a = [];foreach ($vb81ca7c0ccaa77e7aa91936ab0070695 as $v3f9178c25b78ed8bed19091bcb62e266) {if ($v3f9178c25b78ed8bed19091bcb62e266->elementId > 0) {$vdc45f409298a34f384ba3a7ee75a751c = "(hr.level <= {$v3f9178c25b78ed8bed19091bcb62e266->level} AND hr.rel_id";}else {$vdc45f409298a34f384ba3a7ee75a751c = "(hr.level < {$v3f9178c25b78ed8bed19091bcb62e266->level} AND hr.rel_id";}$vdc45f409298a34f384ba3a7ee75a751c .= ($v3f9178c25b78ed8bed19091bcb62e266->elementId > 0) ? " = '{$v3f9178c25b78ed8bed19091bcb62e266->elementId}'" : ' IS NULL';$vdc45f409298a34f384ba3a7ee75a751c .= ')';$v032f3ae7c8ab69e3b2d44917fa7b737a[] = $vdc45f409298a34f384ba3a7ee75a751c;}if (umiCount($v032f3ae7c8ab69e3b2d44917fa7b737a) > 1) {$vac5c74b64b4b8352ef2f181affb5ac2a .= '(';}$vac5c74b64b4b8352ef2f181affb5ac2a .= implode(' OR ', $v032f3ae7c8ab69e3b2d44917fa7b737a);if (umiCount($v032f3ae7c8ab69e3b2d44917fa7b737a) > 1) {$vac5c74b64b4b8352ef2f181affb5ac2a .= ')';}$v22dbfdaedec7f4873088ebd773f60ff5 .= $vac5c74b64b4b8352ef2f181affb5ac2a;$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($v22dbfdaedec7f4873088ebd773f60ff5);$result->setFetchType(IQueryResult::FETCH_ASSOC);$vdf347a373b8f92aa0ae3dd920a5ec2f6 = [];foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$vdf347a373b8f92aa0ae3dd920a5ec2f6[] = $vf1965a857bc285d26fe22023aa5ab50d;}$vdf347a373b8f92aa0ae3dd920a5ec2f6 = umiHierarchy::getInstance()->sortByHierarchy($vdf347a373b8f92aa0ae3dd920a5ec2f6);$vd9a70345efa6f7a7cd0b598a95cf8e11 = [];$v2c9d13c12331af82552de3b482d57d1d = [];$ve37e40b2f88b92d779491d316692401c = null;$v63bcc954536c52db05aa97d1eb68dc6c = null;switch (true) {case !isset($vb71a97a0f96cb8b238309d23a188ae98['is_active']) : {break;}case (is_numeric(mb_strpos($vb71a97a0f96cb8b238309d23a188ae98['is_active'], '1')) &&     is_numeric(mb_strpos($vb71a97a0f96cb8b238309d23a188ae98['is_active'], '0'))) : {break;}case (is_numeric(mb_strpos($vb71a97a0f96cb8b238309d23a188ae98['is_active'], '1'))) : {$v63bcc954536c52db05aa97d1eb68dc6c = true;break;}case (is_numeric(mb_strpos($vb71a97a0f96cb8b238309d23a188ae98['is_active'], '0'))) : {$v63bcc954536c52db05aa97d1eb68dc6c = false;break;}}foreach ($vdf347a373b8f92aa0ae3dd920a5ec2f6 as $vf1965a857bc285d26fe22023aa5ab50d) {$vb80bb7740288fda1f201890375a60c8f = $vf1965a857bc285d26fe22023aa5ab50d['id'];$vd0e45878043844ffc41aac437e86b602 = $vf1965a857bc285d26fe22023aa5ab50d['rel'];$vc9e9a848920877e76685b2e4e76de38d = $vf1965a857bc285d26fe22023aa5ab50d['level'];$vc76a5e84e4bdee527e274ea30c680d79 = $vf1965a857bc285d26fe22023aa5ab50d['active'];$v6e76364fc0655fc33171c81b86009847 = true;switch (true) {case ($v63bcc954536c52db05aa97d1eb68dc6c === true && $vc76a5e84e4bdee527e274ea30c680d79 == 0) : {$v6e76364fc0655fc33171c81b86009847 = false;break;}case ($v63bcc954536c52db05aa97d1eb68dc6c === false && $vc76a5e84e4bdee527e274ea30c680d79 == 1) : {$v6e76364fc0655fc33171c81b86009847 = false;break;}}if ($ve37e40b2f88b92d779491d316692401c === null || $vc9e9a848920877e76685b2e4e76de38d < $ve37e40b2f88b92d779491d316692401c) {$ve37e40b2f88b92d779491d316692401c = $vc9e9a848920877e76685b2e4e76de38d;}if (!isset($vd9a70345efa6f7a7cd0b598a95cf8e11[$vc9e9a848920877e76685b2e4e76de38d])) {$vd9a70345efa6f7a7cd0b598a95cf8e11[$vc9e9a848920877e76685b2e4e76de38d] = [];}if ((isset($vd9a70345efa6f7a7cd0b598a95cf8e11[$vc9e9a848920877e76685b2e4e76de38d - 1][$vd0e45878043844ffc41aac437e86b602]) || $ve37e40b2f88b92d779491d316692401c == $vc9e9a848920877e76685b2e4e76de38d) && $v6e76364fc0655fc33171c81b86009847) {$vd9a70345efa6f7a7cd0b598a95cf8e11[$vc9e9a848920877e76685b2e4e76de38d][$vb80bb7740288fda1f201890375a60c8f] = $vd0e45878043844ffc41aac437e86b602;$v2c9d13c12331af82552de3b482d57d1d[] = $vb80bb7740288fda1f201890375a60c8f;}}return (umiCount($v2c9d13c12331af82552de3b482d57d1d) > 0) ? 'h.id in (' . implode(', ', $v2c9d13c12331af82552de3b482d57d1d) . ')' : '1 = 2';}protected static function getFieldColumn($v945100186b119048837b9859c2c46410) {static $v0fea6a13c52b4d4725368f24b045ca84 = [];if (is_array($v945100186b119048837b9859c2c46410) && umiCount($v945100186b119048837b9859c2c46410) > 0) {$v945100186b119048837b9859c2c46410 = array_shift($v945100186b119048837b9859c2c46410);}if (isset($v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410])) {return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410];}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);switch ($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case 'string':    case 'password':    case 'color':    case 'tags':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'varchar_val';case 'int':    case 'boolean':    case 'date':    case 'link_to_object_type':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'int_val';case 'counter':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'cnt';case 'price':    case 'float':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'float_val';case 'img_file':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'img_file';case 'text':    case 'wysiwyg':    case 'file':    case 'swf_file':    case 'video_file':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'text_val';case 'relation':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'rel_val';case 'symlink':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'tree_val';case 'multiple_image':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'multiple_image';case 'domain_id':    case 'domain_id_list':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'domain_id';case 'offer_id':    case 'offer_id_list':     return $v0fea6a13c52b4d4725368f24b045ca84[$v945100186b119048837b9859c2c46410] = 'offer_id';case 'optioned':     return false;default:     throw new selectorException("Unsupported field type \"{$v06e3d36fa30cea095545139854ad1fb9->getDataType()}\"");}}protected function escapeValue($v2063c1608d6e0baf80249c42e2be5804) {if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {foreach ($v2063c1608d6e0baf80249c42e2be5804 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {$v2063c1608d6e0baf80249c42e2be5804[$v865c0c0b4ab0e063e5caa3387c1a8741] = $this->escapeValue($v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $v2063c1608d6e0baf80249c42e2be5804;}if ($v2063c1608d6e0baf80249c42e2be5804 instanceof selector) {return $this->escapeValue($v2063c1608d6e0baf80249c42e2be5804->result());}if ($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiObject || $v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiHierarchyElement) {return $v2063c1608d6e0baf80249c42e2be5804->id;}$v4717d53ebfdfea8477f780ec66151dcb = ConnectionPool::getInstance()->getConnection();return "'" . $v4717d53ebfdfea8477f780ec66151dcb->escape($v2063c1608d6e0baf80249c42e2be5804) . "'";}protected function buildRootQuery($v15d61712450a686a7f365adf4fef581f) {$vc6c12f4db6ba0426c8e023cb1ca31038 = $this->buildLimit();$va85bfb9c6bcd889ceb433a1c9cd4b218 = $this->buildOrder();$vccc9e74cf27019ed02701010da900d6d = $this->buildWhere();$v75a8be0fca0bc0497c40180b6d02d580 = $this->buildTables();$v39daa41bf389071ad9cd7a7a0ad2ff2c = $this->buildOptions($v15d61712450a686a7f365adf4fef581f);$vd14a8022b085f9ef19d479cbdd581127 = [];foreach ($this->selector->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if ($v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType) {$vd14a8022b085f9ef19d479cbdd581127[] = $v599dcce2998a6b40b1e38e8c6006cb0a->hierarchyType->getId();}}$ve067058f1b6dfcee3ff9b6e52cbada57 = implode(', ', $vd14a8022b085f9ef19d479cbdd581127);$v5a6f85b0e2c34b7c96af65b0f54b4dea = ($v15d61712450a686a7f365adf4fef581f == 'result') ? 'DISTINCT h.id' : 'COUNT(DISTINCT h.id)';$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT $v5a6f85b0e2c34b7c96af65b0f54b4dea
	FROM cms3_hierarchy hp, {$v75a8be0fca0bc0497c40180b6d02d580}
	{$vccc9e74cf27019ed02701010da900d6d}
	AND (h.rel = 0 OR (h.rel = hp.id AND hp.type_id NOT IN ({$ve067058f1b6dfcee3ff9b6e52cbada57})))
		{$va85bfb9c6bcd889ceb433a1c9cd4b218}
		{$vc6c12f4db6ba0426c8e023cb1ca31038}
SQL;   return $vac5c74b64b4b8352ef2f181affb5ac2a;}protected function excludeNestedPages(array $v5a2576254d428ddc22a03fac145c8749) {$v326f338554374193a7a745b14d96459d = [];foreach ($v5a2576254d428ddc22a03fac145c8749 as $vb80bb7740288fda1f201890375a60c8f => $vbfa030fe63bacd523dd70a76cfaed98a) {if (!isset($v5a2576254d428ddc22a03fac145c8749[$vbfa030fe63bacd523dd70a76cfaed98a])) {$v326f338554374193a7a745b14d96459d[] = $vb80bb7740288fda1f201890375a60c8f;}}return $v326f338554374193a7a745b14d96459d;}private function setLeftJoins(array $vaeca0054bba89f3a0fd055e49ecbc960) {$this->leftJoins = array_merge($this->leftJoins, $vaeca0054bba89f3a0fd055e49ecbc960);}private function getLeftJoins() {return $this->leftJoins;}private function getObjectValue($v9190e95d1c478aceb70ac5c82692a74c, iUmiObject $va8cfde6331bd59eb2ac96f8911c4b666) {switch ($v9190e95d1c478aceb70ac5c82692a74c) {case 'id': {return $va8cfde6331bd59eb2ac96f8911c4b666->getId();}case 'guid': {return $va8cfde6331bd59eb2ac96f8911c4b666->getGUID();}case 'name': {return $va8cfde6331bd59eb2ac96f8911c4b666->getName();}case 'is_locked': {return $va8cfde6331bd59eb2ac96f8911c4b666->getIsLocked();}case 'type_id': {return $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId();}case 'owner_id': {return $va8cfde6331bd59eb2ac96f8911c4b666->getOwnerId();}case 'ord': {return $va8cfde6331bd59eb2ac96f8911c4b666->getOrder();}case 'update_time': {return $va8cfde6331bd59eb2ac96f8911c4b666->getUpdateTime();}default : {$v2063c1608d6e0baf80249c42e2be5804 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue($v9190e95d1c478aceb70ac5c82692a74c);return $v2063c1608d6e0baf80249c42e2be5804 ?: false;}}}private function getPageValue($v9190e95d1c478aceb70ac5c82692a74c, iUmiHierarchyElement $v71860c77c6745379b0d44304d66b6a13) {switch ($v9190e95d1c478aceb70ac5c82692a74c) {case 'id': {return $v71860c77c6745379b0d44304d66b6a13->getId();}case 'parent_id': {return $v71860c77c6745379b0d44304d66b6a13->getParentId();}case 'type_id': {return $v71860c77c6745379b0d44304d66b6a13->getTypeId();}case 'lang_id': {return $v71860c77c6745379b0d44304d66b6a13->getLangId();}case 'domain_id': {return $v71860c77c6745379b0d44304d66b6a13->getDomainId();}case 'obj_id': {return $v71860c77c6745379b0d44304d66b6a13->getObjectId();}case 'ord': {return $v71860c77c6745379b0d44304d66b6a13->getOrd();}case 'tpl_id': {return $v71860c77c6745379b0d44304d66b6a13->getTplId();}case 'alt_name': {return $v71860c77c6745379b0d44304d66b6a13->getAltName();}case 'is_active': {return $v71860c77c6745379b0d44304d66b6a13->getIsActive();}case 'is_deleted': {return $v71860c77c6745379b0d44304d66b6a13->getIsDeleted();}case 'is_visible': {return $v71860c77c6745379b0d44304d66b6a13->getIsVisible();}case 'update_time': {return $v71860c77c6745379b0d44304d66b6a13->getUpdateTime();}case 'is_default': {return $v71860c77c6745379b0d44304d66b6a13->getIsDefault();}case 'name': {return $v71860c77c6745379b0d44304d66b6a13->getName();}case 'obj_type_id': {return $v71860c77c6745379b0d44304d66b6a13->getObjectTypeId();}default : {$v2063c1608d6e0baf80249c42e2be5804 = $v71860c77c6745379b0d44304d66b6a13->getValue($v9190e95d1c478aceb70ac5c82692a74c);return $v2063c1608d6e0baf80249c42e2be5804 ?: false;}}}}