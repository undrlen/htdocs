<?php
 namespace UmiCms\Classes\System\Utils\I18n;class I18nFilesLoader implements iI18nFilesLoader {private $langConstants = [];private $moduleList = [];private $langPrefix;private $templatePath;public function __construct(array $v20cf12be6809c539cfed17c272627718, $v535d02e594853266d2db02ff178dd7f7) {$this->moduleList = $v20cf12be6809c539cfed17c272627718;$this->langPrefix = $v535d02e594853266d2db02ff178dd7f7;}public function loadLangConstants() {return $this->loadDefaultLangConstants()    ->loadModuleListLangConstants()    ->loadTemplateLangConstants()    ->getLoadedConstants();}public function setTemplatePath($vd6fe1d0be6347b8ef2427fa629c04485) {if (!is_string($vd6fe1d0be6347b8ef2427fa629c04485) || !file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {throw new \ErrorException('Incorrect template path given');}$this->templatePath = $vd6fe1d0be6347b8ef2427fa629c04485;return $this;}public function getLoadedConstants() {return $this->langConstants;}private function loadModuleListLangConstants() {foreach ($this->getModuleList() as $vb068931cc450442b63f5b3d276ea4297) {$this->loadModuleLangConstants($vb068931cc450442b63f5b3d276ea4297);}return $this;}private function loadModuleLangConstants($vb068931cc450442b63f5b3d276ea4297) {return $this->loadModuleDefaultLangConstants($vb068931cc450442b63f5b3d276ea4297)    ->loadModuleLangConstantsWithPrefix($vb068931cc450442b63f5b3d276ea4297)    ->loadModuleExtensionLangConstants($vb068931cc450442b63f5b3d276ea4297);}private function loadModuleDefaultLangConstants($vb068931cc450442b63f5b3d276ea4297) {$vd6fe1d0be6347b8ef2427fa629c04485 = $this->buildCommonFilePath(SYS_MODULES_PATH . $vb068931cc450442b63f5b3d276ea4297);$this->loadLangConstantsFromFile($vd6fe1d0be6347b8ef2427fa629c04485, $vb068931cc450442b63f5b3d276ea4297);return $this;}private function loadModuleLangConstantsWithPrefix($vb068931cc450442b63f5b3d276ea4297) {$vd6fe1d0be6347b8ef2427fa629c04485 = $this->buildLocalisedFilePath(SYS_MODULES_PATH . $vb068931cc450442b63f5b3d276ea4297);$this->loadLangConstantsFromFile($vd6fe1d0be6347b8ef2427fa629c04485, $vb068931cc450442b63f5b3d276ea4297);return $this;}private function loadModuleExtensionLangConstants($vb068931cc450442b63f5b3d276ea4297) {$v240bf022e685b0ee30ad9fe9e1fb5d5b = SYS_MODULES_PATH . $vb068931cc450442b63f5b3d276ea4297 . '/ext/lang.*.' . $this->getLanguagePrefix() . '.php';$vf595d4c971339549e44e99ace240cf42 = glob($v240bf022e685b0ee30ad9fe9e1fb5d5b);if (!is_array($vf595d4c971339549e44e99ace240cf42)) {return $this;}foreach ($vf595d4c971339549e44e99ace240cf42 as $vd6fe1d0be6347b8ef2427fa629c04485) {$this->loadLangConstantsFromFile($vd6fe1d0be6347b8ef2427fa629c04485, $vb068931cc450442b63f5b3d276ea4297);}return $this;}private function loadLangConstantsFromFile($vd6fe1d0be6347b8ef2427fa629c04485, $vb068931cc450442b63f5b3d276ea4297 = '') {if (!file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {return;}$C_LANG = [];$LANG_EXPORT = [];require $vd6fe1d0be6347b8ef2427fa629c04485;if (isset($LANG_EXPORT) && is_array($LANG_EXPORT)) {foreach ($LANG_EXPORT as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$this->langConstants[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}}if ($vb068931cc450442b63f5b3d276ea4297 === '') {return;}if (isset($C_LANG) && is_array($C_LANG)) {foreach ($C_LANG as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {$this->langConstants[$vb068931cc450442b63f5b3d276ea4297][$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}}}private function loadDefaultLangConstants() {$vd6fe1d0be6347b8ef2427fa629c04485 = $this->buildLocalisedFilePath(SYS_MODULES_PATH);if (!file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {$vd6fe1d0be6347b8ef2427fa629c04485 = $this->buildCommonFilePath(SYS_MODULES_PATH);}$this->loadLangConstantsFromFile($vd6fe1d0be6347b8ef2427fa629c04485);return $this;}private function loadTemplateLangConstants() {$vd6fe1d0be6347b8ef2427fa629c04485 = $this->getTemplatePath();if ($vd6fe1d0be6347b8ef2427fa629c04485 === null) {return $this;}$v834dfbe99711567b7b865ca1acc7fc3d = rtrim($vd6fe1d0be6347b8ef2427fa629c04485, '/') . '/classes/modules';$vfb6bb92fb9b8db93620b4a899296ad55 = [    $v834dfbe99711567b7b865ca1acc7fc3d   ];$v20cf12be6809c539cfed17c272627718 = $this->getModuleList();foreach ($v20cf12be6809c539cfed17c272627718 as $vb068931cc450442b63f5b3d276ea4297) {$vfb6bb92fb9b8db93620b4a899296ad55[$vb068931cc450442b63f5b3d276ea4297] = $v834dfbe99711567b7b865ca1acc7fc3d . '/' . $vb068931cc450442b63f5b3d276ea4297;}foreach ($vfb6bb92fb9b8db93620b4a899296ad55 as $vb068931cc450442b63f5b3d276ea4297 => $v06f0066e65410a0a1c9f39991a3f3b01) {if (!file_exists($v06f0066e65410a0a1c9f39991a3f3b01)) {continue;}$v47826cacc65c665212b821e6ff80b9b0 = $this->buildLocalisedFilePath($v06f0066e65410a0a1c9f39991a3f3b01);if (!file_exists($v47826cacc65c665212b821e6ff80b9b0)) {$v47826cacc65c665212b821e6ff80b9b0 = $this->buildCommonFilePath($v06f0066e65410a0a1c9f39991a3f3b01);}$vb068931cc450442b63f5b3d276ea4297 = in_array($vb068931cc450442b63f5b3d276ea4297, $v20cf12be6809c539cfed17c272627718) ? $vb068931cc450442b63f5b3d276ea4297 : '';$this->loadLangConstantsFromFile($v47826cacc65c665212b821e6ff80b9b0, $vb068931cc450442b63f5b3d276ea4297);}return $this;}private function buildCommonFilePath($v06f0066e65410a0a1c9f39991a3f3b01) {return rtrim($v06f0066e65410a0a1c9f39991a3f3b01, '/') . '/lang.php';}private function buildLocalisedFilePath($v06f0066e65410a0a1c9f39991a3f3b01) {return rtrim($v06f0066e65410a0a1c9f39991a3f3b01, '/') . sprintf('/lang.%s.php', $this->getLanguagePrefix());}private function getLanguagePrefix() {return $this->langPrefix;}private function getModuleList() {return $this->moduleList;}private function getTemplatePath() {return $this->templatePath;}}